(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{194:function(e,t){},199:function(e,t,a){e.exports=a(403)},205:function(e,t,a){},206:function(e,t,a){},327:function(e,t,a){},328:function(e,t,a){},337:function(e,t,a){},383:function(e,t,a){},384:function(e,t,a){},385:function(e,t,a){},386:function(e,t,a){},387:function(e,t,a){},388:function(e,t,a){},389:function(e,t,a){},390:function(e,t,a){},391:function(e,t,a){},392:function(e,t,a){},393:function(e,t,a){},394:function(e,t,a){},395:function(e,t,a){},396:function(e,t,a){},397:function(e,t,a){},398:function(e,t,a){},399:function(e,t,a){},403:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),i=a(9),l=a.n(i),r=(a(204),a(205),a(15)),c=a(14),s=a(17),d=a(16),u=a(18),p=a(3),m=a(195),g=a.n(m),f=a(413),b=a(405),h=a(410),v=a(407),y=a(411),C=a(41),O=(a(206),function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(s.a)(this,Object(d.a)(t).call(this,e))).onSubmit=a.onSubmit.bind(Object(p.a)(Object(p.a)(a))),a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"onSubmit",value:function(e){e&&e.preventDefault();var t=this.props,a=t.form,n=t.onCloseModal;a.validateFields(function(e,t){if(!e){var a=t.pageName;n(a)}})}},{key:"render",value:function(){var e=this.props,t=e.visible,a=e.form,n=e.onCloseModal,i=a.getFieldDecorator;return o.a.createElement(h.a,{visible:t,footer:null,width:450,closable:!0,centered:!0,onOk:this.onSubmit,onCancel:n,title:"\u9875\u9762\u540d\u79f0",maskClosable:!0},o.a.createElement(v.a,{onSubmit:this.onSubmit,style:{padding:"20px 40px"}},o.a.createElement(v.a.Item,null,i("pageName",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u9875\u9762\u540d\u79f0!"},{pattern:/^[a-zA-Z]+$/,message:"\u540d\u79f0\u53ea\u80fd\u5305\u542b\u5b57\u6bcd\uff01"}]})(o.a.createElement(y.a,{placeholder:"\u53ea\u80fd\u5305\u542b\u5b57\u6bcd"}))),o.a.createElement(v.a.Item,{style:{marginTop:"15px",textAlign:"center"}},o.a.createElement(C.a,{type:"primary",htmlType:"submit"},"\u786e\u5b9a"))))}}]),t}(n.Component)),E=v.a.create()(O),x=a(25),j=a(33),S=a(27),k=a(414),I=a(191),w=a(116),A=a.n(w),D="modal",T="api",F="https://pagetools.herokuapp.com";A.a.interceptors.response.use(function(e){return e},function(e){return Promise.reject(e)});var P={AppService:function(){function e(){Object(r.a)(this,e)}return Object(c.a)(e,[{key:"generatePage",value:function(e){return A()({method:"POST",url:"".concat(F,"/generatePage"),data:e})}},{key:"fetchApi",value:function(e,t,a,n){return A()({method:"post",url:"".concat(F,"/fetchApi"),data:{host:e,method:t,api:a,params:n,appUrl:localStorage.getItem("appUrl"),access_token:localStorage.getItem("access_token"),MerchantId:localStorage.getItem("MerchantId")}})}}]),e}()};var L,M,N,V=a(65),U=a(10),B=a(85),q=a(415),R=a(404),z=a(76),H=a(408),K=a(148),J=a(416),G=a(111),W=(a(327),function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(s.a)(this,Object(d.a)(t).call(this,e))).onDelete=a.onDelete.bind(Object(p.a)(Object(p.a)(a))),a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"onDelete",value:function(){(0,this.props.onUpdateLayoutConfig)({deleteFlag:!0})}},{key:"render",value:function(){return o.a.createElement("div",{className:"fulu-cell-box line-box"},o.a.createElement(R.a,null),o.a.createElement(U.a,{type:"close",className:"delete-line",onClick:this.onDelete}))}}]),t}(n.PureComponent)),Y=a(406),_=a(409),Q=a(412),$={labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}},Z=a(77),X=(a(196),a(110),function(e,t,a){var i=t.operationArr,l=void 0===i?[]:i,r=t.columns.slice();return Object.keys(e).forEach(function(t){var a=e[t];if(t.indexOf("-")>0){var n=t.split("-"),o=Object(Z.a)(n,2),i=o[0],l=o[1],c=r.find(function(e){return e.index===+l});c&&(c[i]=a,"width"!==i||a||delete c.width,"fixed"===i&&(c[i]="1"===a),delete e[t])}}),"1"===e.hasOperation?function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2?arguments[2]:void 0,i=null;return e.length>0&&"\u64cd\u4f5c"===e[e.length-1].title?i=e[e.length-1]:(i={title:"\u64cd\u4f5c",dataIndex:"operation"},e.push(i)),i.render=function(e,i){return Array.isArray(t)?o.a.createElement(n.Fragment,null,t.map(function(t,n){var i=t.opText,l=t.opType,r=t.modalName,c=t.api,s=void 0===c?"":c,d={};return"edit"!==l&&"view"!==l||(d.onClick=function(t){a.onShowModal(t,r,s,e)}),o.a.createElement("a",Object.assign({href:"javascript:;",key:"op-".concat(n)},d),i)})):null},e}(r,l,a):(r.length>0&&"1"===r[0].sortIndex&&(r[0].render=function(e,t){return o.a.createElement("span",null,t+1)}),r)}),ee=function(e,t,a){var n={columns:X(e,t,a)};return Object.keys(e).forEach(function(t){var a=e[t];"pagination"===t?"1"===a?n.pagination={pageSize:e.pageSize,pageSizeOptions:e.pageSizeOptions.split(",")}:n[t]="1"===a:"rowSelection"===t?"1"===a?(n.rowSelection={type:e.type},"radio"===e.type&&(n.rowSelection.columnTitle=e.columnTitle)):n[t]=null:n[t]=a}),n},te=function(e,t,a){var n=a?[]:{};return Object.keys(e).forEach(function(o){var i=o;if(a){if(o.indexOf("-")>0){var l=o.split("-"),r=Object(Z.a)(l,2),c=r[0],s=r[1];if(ne(i=c,t)){var d,u=oe(function(e){return e.index===s},n);if(u)u[i]=e[o];else n.push((d={},Object(j.a)(d,i,e[o]),Object(j.a)(d,"index",s),d))}}}else ne(i,t)&&(n[i]=e[o])}),n},ae=function(e,t,a){var n={};return t.forEach(function(t){var o="".concat(t,"-").concat(a);Object.hasOwnProperty.call(e,o)&&(n[t]=e[o],delete e[o])}),n},ne=function(e,t){return!!oe(e,t)},oe=function(e,t){var a="function"===typeof e;return t.find(function(t){return a?e(t):t.key===e})},ie=function(e,t){var a=t.formType,n=t.queryApi,o=t.addApi,i=t.editApi;return"query"===a?n:"add"===e?o:i},le=(a(328),_.a.Panel),re=B.a.Option,ce={labelCol:{xs:{span:24},sm:{span:10}},wrapperCol:{xs:{span:24},sm:{span:14}}},se=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(s.a)(this,Object(d.a)(t).call(this,e))).state={configs:e.configs},a.setColumnMaxIndex(e),a.onSubmit=a.onSubmit.bind(Object(p.a)(Object(p.a)(a))),a.onAddColumn=a.onAddColumn.bind(Object(p.a)(Object(p.a)(a))),a.onDeleteColumn=a.onDeleteColumn.bind(Object(p.a)(Object(p.a)(a))),a.onAddOperation=a.onAddOperation.bind(Object(p.a)(Object(p.a)(a))),a.onDeleteOperation=a.onDeleteOperation.bind(Object(p.a)(Object(p.a)(a))),a.renderOperationBtn=a.renderOperationBtn.bind(Object(p.a)(Object(p.a)(a))),a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e){e.visible!==this.props.visible&&e.visible&&(this.setState({configs:e.configs}),this.setColumnMaxIndex(e),this.setOperationMaxIndex(e))}},{key:"setColumnMaxIndex",value:function(e){var t=e.configs.columns,a=void 0===t?[]:t;this.columnMaxIndex=a.length||0}},{key:"setOperationMaxIndex",value:function(e){var t=e.configs.operationArr,a=void 0===t?[]:t;this.operationMaxIndex=a.length||0}},{key:"addColumnMaxIndex",value:function(){this.columnMaxIndex+=1}},{key:"addOperationMaxIndex",value:function(){this.operationMaxIndex+=1}},{key:"onAddOperation",value:function(){var e=this.state.configs.operationArr,t=(void 0===e?[]:e).slice(),a=this.operationMaxIndex;t.push({opText:"\u64cd\u4f5c",index:a}),this.setState({configs:this.getNewConfigs("operationArr",t)}),this.addOperationMaxIndex()}},{key:"onAddColumn",value:function(){var e=this.state.configs.columns.slice(),t=this.columnMaxIndex;e.push({title:"column".concat(t),dataIndex:"dataIndex".concat(t),index:t}),this.setState({configs:this.getNewConfigs("columns",e)}),this.addColumnMaxIndex()}},{key:"onDeleteOperation",value:function(e){var t=this.state.configs,a=t.operationArr.reduce(function(t,a){return a.index!==e&&t.push(Object.assign({},a)),t},[]);Object.assign({},t).operationArr=a,this.setState({configs:this.getNewConfigs("operationArr",a)})}},{key:"onDeleteColumn",value:function(e){var t=this.state.configs,a=t.columns.reduce(function(t,a){return a.index!==e&&t.push(Object.assign({},a)),t},[]);Object.assign({},t).columns=a,this.setState({configs:this.getNewConfigs("columns",a)})}},{key:"getNewConfigs",value:function(e,t){var a=this.state.configs,n=Object.assign({},a);return n[e]=t,n}},{key:"onSubmit",value:function(e){var t=this;e.preventDefault();var a=this.props,n=a.context,o=a.form,i=a.onUpdateLayoutConfig;o.validateFields(function(e,a){if(!e){var o=t.state.configs,l=[];if("1"===a.hasOperation)for(var r=o.operationArr,c=void 0===r?[]:r,s=["opText","opType","modalName","modalData","api"],d=0;d<c.length;d++){var u=c[d].index;l.push(Object.assign(c[d],ae(a,s,u)))}var p=ee(a,o,n);p.operationArr=l,delete p.pageSize,delete p.pageSizeOptions,delete p.type,delete p.columnTitle,i(p)}})}},{key:"renderPanelHeader",value:function(e){var t=this,a=e.title,n=e.index;return o.a.createElement("div",{className:"panel-header"},o.a.createElement("span",{className:"title"},a),o.a.createElement(U.a,{type:"close",className:"btn-delete",onClick:function(){t.onDeleteColumn(n)}}))}},{key:"renderOperationHeader",value:function(e){var t=this,a=e.opText,n=e.index;return o.a.createElement("div",{className:"panel-header"},o.a.createElement("span",{className:"title"},a),o.a.createElement(U.a,{type:"close",className:"btn-delete",onClick:function(){t.onDeleteOperation(n)}}))}},{key:"renderCollapse",value:function(){var e=this,t=this.props.form,a=this.state.configs.columns,n=void 0===a?[]:a,i=t.getFieldDecorator;return o.a.createElement(_.a,null,n.map(function(t,a){var l=t.title,r=t.index,c=t.dataIndex,s=t.width,d=t.sortIndex,u=t.align,p=void 0===u?"left":u,m=t.fixed,g=void 0!==m&&m;return"\u64cd\u4f5c"===l&&a===n.length-1?null:o.a.createElement(le,{header:e.renderPanelHeader(t),key:"".concat(l,"-").concat(r)},o.a.createElement(v.a.Item,Object.assign({label:"title"},$),i("title-".concat(r),{rules:[{required:!0,message:"\u8bf7\u8f93\u5165title!"}],initialValue:l})(o.a.createElement(y.a,null))),o.a.createElement(v.a.Item,Object.assign({label:"dataIndex"},$),i("dataIndex-".concat(r),{rules:[{required:!0,message:"dataIndex!"}],initialValue:c})(o.a.createElement(y.a,null))),o.a.createElement(v.a.Item,Object.assign({label:"width"},$),i("width-".concat(r),{initialValue:s||""},{rules:[{pattern:/^\d+(%)?$/,message:"\u8bf7\u8f93\u5165\u6570\u5b57\u6216\u8005\u767e\u5206\u6bd4!"}]})(o.a.createElement(y.a,null))),0===a?o.a.createElement(v.a.Item,Object.assign({label:"\u5e8f\u53f7\u5217"},$),i("sortIndex-".concat(r),{initialValue:d})(o.a.createElement(B.a,{placeholder:"\u662f\u5426\u663e\u793a\u5e8f\u53f7"},o.a.createElement(re,{value:"0"},"false"),o.a.createElement(re,{value:"1"},"true")))):null,o.a.createElement(v.a.Item,Object.assign({label:"align"},$),i("align-".concat(r),{initialValue:p})(o.a.createElement(B.a,null,o.a.createElement(re,{value:"left"},"left"),o.a.createElement(re,{value:"right"},"right"),o.a.createElement(re,{value:"center"},"center")))),o.a.createElement(v.a.Item,Object.assign({label:"fixed"},$),i("fixed-".concat(r),{initialValue:g?"1":"0"})(o.a.createElement(B.a,null,o.a.createElement(re,{value:"0"},"false"),o.a.createElement(re,{value:"1"},"true")))))}))}},{key:"renderOperationBtn",value:function(e){var t=this.props,a=t.form,n=t.layerConfig,i=a.getFieldDecorator,l=e.index,r=e.opText,c=e.opType,s=e.modalName,d=e.modalData,u=e.api,p=a.getFieldValue("opType-".concat(l));return o.a.createElement(le,{header:this.renderOperationHeader(e),key:"op-".concat(l)},o.a.createElement(v.a.Item,Object.assign({label:"\u6587\u5b57"},$),i("opText-".concat(l),{initialValue:r})(o.a.createElement(y.a,null))),o.a.createElement(v.a.Item,Object.assign({label:"\u7c7b\u578b"},$),i("opType-".concat(l),{initialValue:c})(o.a.createElement(B.a,null,o.a.createElement(re,{value:"edit"},"\u7f16\u8f91(\u5f39\u7a97)"),o.a.createElement(re,{value:"view"},"\u67e5\u770b(\u5f39\u7a97)"),o.a.createElement(re,{value:"delete"},"\u5220\u9664"),o.a.createElement(re,{value:"skip"},"\u8df3\u8f6c")))),"edit"===p||"view"===p?it(n,a,s,l):null,"edit"===p||"view"===p?o.a.createElement(v.a.Item,Object.assign({label:"\u6570\u636e\u6765\u6e90"},$),i("modalData-".concat(l),{initialValue:d})(o.a.createElement(B.a,null,o.a.createElement(re,{value:"table"},"\u8868\u683c"),o.a.createElement(re,{value:"api"},"\u63a5\u53e3\u8c03\u7528")))):null,"api"===a.getFieldValue("modalData-".concat(l))?lt(n,a,{initialValue:u,key:l}):null)}},{key:"renderTableProps",value:function(){var e=this.props.form,t=this.state.configs,a=e.getFieldDecorator,i=t.operationArr,l=void 0===i?[]:i,r=t.pagination,c=t.rowSelection,s=t.hasOperation,d=void 0===s?"0":s,u=(t.mockData,t.rowKey),p=r||{},m=p.pageSize,g=void 0===m?10:m,f=p.pageSizeOptions,b=void 0===f?"10,20,30":f,h=c||{},O=h.type,E=void 0===O?"checkbox":O,x=h.columnTitle,j=void 0===x?"\u9009\u62e9":x,S=Object.keys(r||{}).length>0?"1":"0",k=Object.keys(c||{}).length>0?"1":"0";return o.a.createElement(n.Fragment,null,o.a.createElement(v.a.Item,Object.assign({label:"\u64cd\u4f5c\u5217"},$),a("hasOperation",{initialValue:d})(o.a.createElement(B.a,null,o.a.createElement(re,{value:"0"},"\u65e0"),o.a.createElement(re,{value:"1"},"\u6709")))),"1"===e.getFieldValue("hasOperation")?[o.a.createElement(_.a,{key:"op-collapse"},l.map(this.renderOperationBtn)),o.a.createElement(n.Fragment,{key:"op-collapse-btns"},"1"===e.getFieldValue("hasOperation")?o.a.createElement("div",{className:"btn-add-box"},o.a.createElement(C.a,{type:"dashed",size:"large",onClick:this.onAddOperation},"\u6dfb\u52a0\u64cd\u4f5c\u9879")):null)]:null,o.a.createElement(v.a.Item,Object.assign({label:"pagination"},$),a("pagination",{initialValue:S})(o.a.createElement(B.a,null,o.a.createElement(re,{value:"0"},"false"),o.a.createElement(re,{value:"1"},"true")))),o.a.createElement(v.a.Item,Object.assign({label:"rowKey"},$),a("rowKey",{initialValue:u})(o.a.createElement(y.a,null))),"1"===e.getFieldValue("pagination")?o.a.createElement(Q.a,{title:"pagination\u914d\u7f6e"},o.a.createElement(v.a.Item,Object.assign({label:"pageSize"},$),a("pageSize",{initialValue:g})(o.a.createElement(y.a,null))),o.a.createElement(v.a.Item,Object.assign({label:"pageSizeOptions"},ce),a("pageSizeOptions",{initialValue:Array.isArray(b)?b.join(","):b})(o.a.createElement(B.a,null,o.a.createElement(re,{value:"10,20,30"},"10,20,30"),o.a.createElement(re,{value:"10,20,30,40"},"10,20,30,40"),o.a.createElement(re,{value:"20,30,40"},"20,30,40"))))):null,o.a.createElement(v.a.Item,Object.assign({label:"rowSelection"},$),a("rowSelection",{initialValue:k})(o.a.createElement(B.a,null,o.a.createElement(re,{value:"0"},"false"),o.a.createElement(re,{value:"1"},"true")))),"1"===e.getFieldValue("rowSelection")?o.a.createElement(Q.a,{title:"rowSelection\u914d\u7f6e"},o.a.createElement(v.a.Item,Object.assign({label:"type"},$),a("type",{initialValue:E})(o.a.createElement(B.a,null,o.a.createElement(re,{value:"checkbox"},"checkbox"),o.a.createElement(re,{value:"radio"},"radio")))),"radio"===e.getFieldValue("type")?o.a.createElement(v.a.Item,Object.assign({label:"columnTitle"},$),a("columnTitle",{initialValue:j})(o.a.createElement(y.a,null))):null):null)}},{key:"render",value:function(){var e=this.props,t=e.visible,a=e.onClose,n=e.onDeleteContainer,i=e.form.getFieldDecorator,l=this.state.configs.dataSrouce;return o.a.createElement(q.a,{title:"\u8868\u683c\u7f16\u8f91",maskClosable:!1,width:420,onClose:a,visible:t},o.a.createElement(v.a,{onSubmit:this.onSubmit},o.a.createElement(R.a,null,"\u8868\u5934"),this.renderCollapse(),o.a.createElement("div",{className:"btn-add-box"},o.a.createElement(C.a,{type:"dashed",size:"large",onClick:this.onAddColumn},"\u6dfb\u52a0\u8868\u5934\u5217")),o.a.createElement(R.a,null,"\u8868\u683c\u5c5e\u6027"),this.renderTableProps(),o.a.createElement(R.a,null,"\u6570\u636e\u6e90"),o.a.createElement(v.a.Item,Object.assign({label:"dataSrouce"},$),i("modelKey",{initialValue:l})(o.a.createElement(y.a,{placeholder:"model key"}))),o.a.createElement(v.a.Item,{style:{marginTop:"20px",textAlign:"center"}},o.a.createElement(C.a,{type:"primary",htmlType:"submit",style:{marginRight:"10px"}},"\u786e\u5b9a"),o.a.createElement(C.a,{onClick:n},"\u5220\u9664\u5bb9\u5668"))))}}]),t}(n.PureComponent),de=v.a.create()(se),ue=(a(337),function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(s.a)(this,Object(d.a)(t).call(this,e))).state={visible:!1},a.onClose=a.onClose.bind(Object(p.a)(Object(p.a)(a))),a.onShowEditTable=a.onShowEditTable.bind(Object(p.a)(Object(p.a)(a))),a.onUpdateConfigs=a.onUpdateConfigs.bind(Object(p.a)(Object(p.a)(a))),a.onDeleteContainer=a.onDeleteContainer.bind(Object(p.a)(Object(p.a)(a))),a.onPageIndexChange=a.onPageIndexChange.bind(Object(p.a)(Object(p.a)(a))),a.onShowSizeChange=a.onShowSizeChange.bind(Object(p.a)(Object(p.a)(a))),a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"onShowEditTable",value:function(){this.setState({visible:!0})}},{key:"onClose",value:function(e){e.stopPropagation(),this.setState({visible:!1})}},{key:"onUpdateConfigs",value:function(e){var t=this.props,a=t.layoutIndex;(0,t.onUpdateLayoutConfig)({layoutIndex:a,configs:e}),this.setState({visible:!1})}},{key:"onDeleteContainer",value:function(){var e=this.props,t=e.layoutIndex;(0,e.onUpdateLayoutConfig)({layoutIndex:t,deleteFlag:!0})}},{key:"getMockDataSource",value:function(e,t){for(var a=[],n=function(t){var n={};e.forEach(function(e){Object.keys(e).forEach(function(a){n[e.dataIndex]="".concat(e.dataIndex,"-").concat(t)})}),a.push(n)},o=0;o<t;o++)n(o);return a}},{key:"getModelKey",value:function(){var e=this.props.configs;return(void 0===e?{}:e).modelKey}},{key:"onPageIndexChange",value:function(e,t){this.props.onPageIndexChange(e,t,this.getModelKey())}},{key:"onShowSizeChange",value:function(e,t){this.props.onShowSizeChange(e,t,this.getModelKey())}},{key:"render",value:function(){var e=this.state.visible,t=this.props,a=t.configs,n=void 0===a?{}:a,i=t.apiData,l=void 0===i?{}:i,r=t.currentPage,c=t.pageSize,s=t.context,d=t.layerConfig,u=t.preview,p=void 0!==u&&u,m=n.pagination,g=void 0!==m&&m,f=n.rowSelection,b=void 0===f?null:f,h=n.columns,v=void 0===h?[]:h,y=n.modelKey,C=n.mockData,O=n.rowKey,E=v.slice(),x=/^\d+$/.test(C)?+C:0,j=y&&Object.hasOwnProperty.call(l,y),S=j?l[y]:this.getMockDataSource(v,x);return g&&(g.showQuickJumper=!0,g.showSizeChanger=!0,g.current=r,g.pageSize=c,g.total=j?l["".concat(y,"Total")]:x,g.onChange=this.onPageIndexChange,g.onShowSizeChange=this.onShowSizeChange),o.a.createElement("div",{className:"table-container container ".concat(p?"preview-box":"")},o.a.createElement(Y.a,{columns:E,bordered:!0,dataSource:S,pagination:g,rowSelection:b,rowKey:O}),o.a.createElement(de,{visible:e,layerConfig:d,configs:n,context:s,onClose:this.onClose,onDeleteContainer:this.onDeleteContainer,onUpdateLayoutConfig:this.onUpdateConfigs}),p?null:o.a.createElement(U.a,{type:"form",className:"icon-operation",onClick:this.onShowEditTable}))}}]),t}(n.PureComponent)),pe=function(e){function t(){return Object(r.a)(this,t),Object(s.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.dropConfig,a=void 0===t?{}:t,n=Object(S.a)(e,["dropConfig"]),i=a.cellStyles,l=a.textAlign,r=void 0===l?"center":l,c="Button"===a.type?Object.assign({},i,{textAlign:r}):i;return o.a.createElement("div",{style:c},rt(a,n))}}]),t}(n.PureComponent),me=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:";";return e?e.split(t).reduce(function(e,t){var a=t.split(":"),n=Object(Z.a)(a,2),o=n[0],i=n[1];return o&&i&&(e[o]=i.replace(/['"\s]/g,"")),e},{}):{}},ge=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:";";return"[object Object]"===Object.prototype.toString.call(e)?Object.keys(e).reduce(function(t,a){return t.push("".concat(a,":").concat(e[a])),t},[]).join(t):Array.isArray(e)?e.join(t):e},fe=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=0;if(t===n.length)o=24;else{for(var i=0,l=0,r=0;r<a.length;r++)if(a[r].colIndex>=e){if(0===(l%=24))i=0;else for(var c=0;c<n.length;c++)(l-=n[c])<=0&&(i=c+1,c=n.length);r=a.length}else l+=a[r].colSpan;var s,d=0;for(t<=n.length-i&&(d=i),s=d+t-1;d<=s;d++)o+=n[d]}return o},be=B.a.Option,he=_.a.Panel,ve=["import","export","edit","view","mult"],ye=["add","edit","view"],Ce=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(s.a)(this,Object(d.a)(t).call(this,e))).state={deleteComponent:!1},a.onDeleteComponent=a.onDeleteComponent.bind(Object(p.a)(Object(p.a)(a))),a.handleSubmit=a.handleSubmit.bind(Object(p.a)(Object(p.a)(a))),a.onAddListItem=a.onAddListItem.bind(Object(p.a)(Object(p.a)(a))),a.onDeleteListItem=a.onDeleteListItem.bind(Object(p.a)(Object(p.a)(a))),a.renderBtnPanelHeader=a.renderBtnPanelHeader.bind(Object(p.a)(Object(p.a)(a))),a.onDeleteButton=a.onDeleteButton.bind(Object(p.a)(Object(p.a)(a))),a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"getItemSetType",value:function(){return[]}},{key:"componentWillReceiveProps",value:function(e){var t=e.dropConfig,a=t.type,n=t.configs,o=void 0===n?{}:n;if(~this.getItemSetType().indexOf(a)&&!this["init".concat(a)]&&e.visible){var i=a.toLowerCase(),l="".concat(i,"Arr"),r=o[l]||[];this.setState(Object(j.a)({},l,r)),this["".concat(i,"Index")]=r.length,this["init".concat(a)]=!0}}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),e.stopPropagation();var a=this.state,n=a.deleteComponent,o=a.buttonArr,i=this.props,l=i.form,r=i.onUpdateConfigs,c=i.dropConfig,s=i.colSpanArr,d=i.formItemArr,u=i.inForm,p=void 0===u||u,m=this.getItemSetType();l.validateFields(function(e,a){if(!e){var i=Object.assign({},c,a);n&&(i.deleteFlag=!0),i.cellStyles=me(a.cellStyles);var l=i.type;if(~m.indexOf(l)&&"Button"!==l){var u=l.toLowerCase(),g="".concat(u,"Arr"),f=t.state[g].slice();f.forEach(function(e){var t=e.index,n="".concat(u,"Label-").concat(t),o="".concat(u,"Value-").concat(t);e.label=a[n],e.value=a[o],delete i[n],delete i[o]}),i[g]=f}else if("DatePicker"===l||"RangePicker"===l){var b=a.format;i.showTime="1"===a.showTime,"DatePicker"===l&&(i.initialValue=a.initialValue&&a.initialValue.format(b))}else if("Button"===l){var h=o.slice();h.forEach(function(e){var t=e.btnIndex,n="btnText-".concat(t),o="antdType-".concat(t),l="htmlType-".concat(t),r="api-".concat(t),c="expandFlag-".concat(t),s="modalName-".concat(t);e.btnText=a[n],e.antdType=a[o],e.htmlType=a[l],e.expandFlag=a[c],e.api=a[r],e.modalName=a[s];var d="expandCount-".concat(t);"1"===a[c]&&(e.expandCount=a[d]),delete i[s],delete i[d],delete i[c],delete i[r],delete i[l],delete i[n],delete i[o]}),i.buttonArr=h}if(p){var v=a.originSpan,y=void 0===v?1:v;i.originSpan=y,i.colSpan=fe(i.colIndex,y,d,s)}delete i.configs,t.onCloseEdit(),r(i)}})}},{key:"onCloseEdit",value:function(){var e=this;this.initBtn=!1,this.getItemSetType().forEach(function(t){e["init".concat(t)]=!1}),this.setState({deleteComponent:!1})}},{key:"onDeleteComponent",value:function(){this.setState({deleteComponent:!0})}},{key:"onDeleteButton",value:function(e){var t=this.state.buttonArr,a=(void 0===t?[]:t).reduce(function(t,a){return a.btnIndex!==e&&t.push(a),t},[]);this.setState({buttonArr:a})}},{key:"onDeleteListItem",value:function(e,t){var a="".concat(t,"Arr"),n=this.state[a].reduce(function(t,a){return a.index!==e&&t.push(a),t},[]);this.setState(Object(j.a)({},a,n))}},{key:"onAddListItem",value:function(e){var t="".concat(e,"Arr"),a=this.state[t].slice();a.push({label:"",value:"",index:this["".concat(e,"Index")]}),this.setState(Object(j.a)({},t,a)),this["".concat(e,"Index")]+=1}},{key:"renderDefaultValueItem",value:function(){var e=this.props,t=e.dropConfig,a=e.form,n=t.type,i=t.initialValue,l=a.getFieldDecorator;if(~this.getItemSetType().indexOf(n)){var r=n.toLowerCase(),c="".concat(r,"Arr"),s=this.state[c]||[];return o.a.createElement(v.a.Item,Object.assign({},$,{label:"initialValue"}),l("initialValue",{initialValue:i})(o.a.createElement(B.a,{allowClear:!0},s.map(function(e){var t=e.index,n=a.getFieldValue("".concat(r,"Value-").concat(t)),i=a.getFieldValue("".concat(r,"Label-").concat(t));return o.a.createElement(be,{value:n,key:"op-".concat(t)},"".concat(n,"/").concat(i))}))))}return"DatePicker"===n?o.a.createElement(v.a.Item,Object.assign({},$,{label:"initialValue"}),l("initialValue",{initialValue:i})(o.a.createElement(H.a,{style:{width:"100%"}}))):"Input"===n?o.a.createElement(v.a.Item,Object.assign({},$,{label:"initialValue"}),l("initialValue",{initialValue:i})(o.a.createElement(y.a,null))):"Text"===n?o.a.createElement(v.a.Item,Object.assign({},$,{label:"text"}),l("text",{initialValue:t.text})(o.a.createElement(y.a,null))):null}},{key:"renderBtnPanelHeader",value:function(e){var t=this,a=e.btnText,n=e.btnIndex;return o.a.createElement("div",{className:"panel-header"},o.a.createElement("span",{className:"title"},a),o.a.createElement(U.a,{type:"close",className:"btn-delete",onClick:function(){t.onDeleteButton(n)}}))}},{key:"renderTabs",value:function(){return this.renderItemSettingCard({title:"tab\u8bbe\u7f6e",dataKey:"tabs"})}},{key:"renderBreadcrumb",value:function(){return this.renderItemSettingCard({title:"breadcrumb\u8bbe\u7f6e",dataKey:"breadcrumb",labPlaceholder:"\u540d\u79f0",valPlaceholder:"\u8def\u5f84"})}},{key:"renderSelect",value:function(){return this.renderItemSettingCard({title:"select\u8bbe\u7f6e",dataKey:"select"})}},{key:"renderRadio",value:function(){return this.renderItemSettingCard({title:"radio\u8bbe\u7f6e",dataKey:"radio"})}},{key:"renderCheckbox",value:function(){return this.renderItemSettingCard({title:"checkbox\u8bbe\u7f6e",dataKey:"checkbox"})}},{key:"renderItemSettingCard",value:function(e){var t=this,a=e.title,i=e.dataKey,l=e.labPlaceholder,r=void 0===l?"label":l,c=e.valPlaceholder,s=void 0===c?"label":c,d=this.props.form,u="".concat(i,"Arr"),p=this.state[u]||[];return o.a.createElement(Q.a,{title:a,extra:o.a.createElement(U.a,{type:"plus-circle",onClick:function(){t.onAddListItem(i)}})},p.map(function(e){var a=e.label,l=e.value,c=e.index;return o.a.createElement(n.Fragment,{key:"".concat(i,"-").concat(c)},o.a.createElement(v.a.Item,{key:"".concat(i,"-label-").concat(c),style:{width:"45%",display:"inline-block"}},d.getFieldDecorator("".concat(i,"Label-").concat(c),{initialValue:a,rules:[{required:!0,message:r}]})(o.a.createElement(y.a,{placeholder:r}))),o.a.createElement(v.a.Item,{key:"".concat(i,"-value-").concat(c),style:{width:"45%",display:"inline-block",marginLeft:"10px"}},d.getFieldDecorator("".concat(i,"Value-").concat(c),{initialValue:l})(o.a.createElement(y.a,{placeholder:s}))),o.a.createElement(U.a,{type:"close-circle",style:{marginLeft:"6px",lineHeight:"39px"},onClick:function(){t.onDeleteListItem(c,i)}}))}))}},{key:"renderBtnExpand",value:function(e){var t=this.props.form,a=this.state.expandFlag,i=void 0===a?"0":a,l=e.index,r=e.expandCount;return o.a.createElement(n.Fragment,null,o.a.createElement(v.a.Item,Object.assign({key:"expandFlag-".concat(l),label:"\u6298\u53e0"},$),t.getFieldDecorator("expandFlag-".concat(l),{initialValue:i})(o.a.createElement(B.a,null,o.a.createElement(be,{value:"0"},"\u5426"),o.a.createElement(be,{value:"1"},"\u662f")))),"1"===t.getFieldValue("expandFlag-".concat(l))?o.a.createElement(v.a.Item,Object.assign({key:"expandCount-".concat(l),label:"\u6298\u53e0\u53ef\u89c1\u6570"},$),t.getFieldDecorator("expandCount-".concat(l),{initialValue:r})(o.a.createElement(y.a,{placeholder:"expandCount"}))):null)}},{key:"renderApiItem",value:function(e){var t=e.btnIndex,a=e.api,n=e.logicType,o=this.props,i=o.layerConfig,l=void 0===i?{}:i,r=o.form;return ve.indexOf(n)>=0?it(l,r,a,t):null}},{key:"renderModalItem",value:function(e){var t=e.btnIndex,a=e.modalName,n=e.logicType,o=this.props,i=o.layerConfig,l=void 0===i?{}:i,r=o.form;return ye.indexOf(n)>=0?it(l,r,a,t):null}},{key:"renderBtnCard",value:function(){var e=this,t=this.props.form,a=this.state.buttonArr,n=void 0===a?[]:a;return o.a.createElement(Q.a,{title:"\u6309\u94ae\u533a\u57df"},o.a.createElement(_.a,null,n.map(function(a){var n=a.btnIndex,i=a.btnText,l=a.antdType,r=void 0===l?"":l,c=a.htmlType,s=void 0===c?"button":c,d=a.logicType,u=a.textDisabled;return o.a.createElement(he,{header:e.renderBtnPanelHeader(a),key:"btn-".concat(n)},o.a.createElement(v.a.Item,Object.assign({key:"btnText-".concat(n),label:"\u6309\u94ae\u6587\u5b57"},$),t.getFieldDecorator("btnText-".concat(n),{initialValue:i,rules:[{required:!0,message:"\u6309\u94ae\u6587\u5b57"}]})(o.a.createElement(y.a,{placeholder:"\u6309\u94ae\u6587\u5b57",disabled:u}))),o.a.createElement(v.a.Item,Object.assign({key:"antdType-".concat(n),label:"type"},$),t.getFieldDecorator("antdType-".concat(n),{initialValue:r})(o.a.createElement(B.a,{placeholder:"\u6309\u94ae\u7c7b\u578b",disabled:"submit"===s||"reset"===s},o.a.createElement(be,{value:"primary"},"primary"),o.a.createElement(be,{value:"dashed"},"dashed"),o.a.createElement(be,{value:"danger"},"danger"),o.a.createElement(be,{value:""},"none")))),o.a.createElement(v.a.Item,Object.assign({key:"htmlType-".concat(n),label:"htmlType"},$),t.getFieldDecorator("htmlType-".concat(n),{initialValue:s,rules:[{required:!0,message:"htmlType"}]})(o.a.createElement(B.a,{disabled:"submit"===s||"reset"===s},o.a.createElement(be,{value:"submit"},"submit"),o.a.createElement(be,{value:"reset"},"reset"),o.a.createElement(be,{value:"button"},"button")))),e.renderApiItem(a),e.renderModalItem(a),"expand"===d?e.renderBtnExpand(a):null)})))}}]),t}(n.Component),Oe=(a(383),B.a.Option),Ee=y.a.TextArea,xe=function(e){function t(){return Object(r.a)(this,t),Object(s.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(c.a)(t,[{key:"getItemSetType",value:function(){return["Tabs","Breadcrumb","Button","Radio"]}},{key:"renderContent",value:function(){var e=this.props,t=e.form,a=e.dropConfig,i=a.placeholder,l=a.type,r=t.getFieldDecorator;return this.state.deleteComponent?null:"Button"===l?this.renderBtnCard():"Breadcrumb"===l?this.renderBreadcrumb():"Tabs"===l?this.renderTabs():"Radio"===l?this.renderRadio():o.a.createElement(n.Fragment,null,this.renderDefaultValueItem(),"Text"!==l&&"Breadcrumb"!==l?o.a.createElement(v.a.Item,Object.assign({},$,{label:"placeholder"}),r("placeholder",{initialValue:i})(o.a.createElement(y.a,null))):null)}},{key:"render",value:function(){var e=this,t=this.props,a=t.visible,n=t.onClose,i=t.form,l=t.dropConfig,r=ge(l.cellStyles),c=l.type,s=l.radioType,d=l.textAlign,u=void 0===d?"center":d;return o.a.createElement(q.a,{visible:a,maskClosable:!1,title:"\u7f16\u8f91\u7ec4\u4ef6",onClose:function(){e.onCloseEdit(),n()},width:420},o.a.createElement(v.a,{onSubmit:this.handleSubmit},o.a.createElement(v.a.Item,Object.assign({label:"style\u8bbe\u7f6e"},$),i.getFieldDecorator("cellStyles",{initialValue:r})(o.a.createElement(Ee,{placeholder:"\u591a\u4e2a\u6837\u5f0f\u5c5e\u6027\u8bf7\u7528\u5206\u53f7\u5206\u9694"}))),"Button"===c?o.a.createElement(v.a.Item,Object.assign({label:"\u5bf9\u9f50\u65b9\u5f0f"},$),i.getFieldDecorator("textAlign",{initialValue:u})(o.a.createElement(B.a,null,o.a.createElement(Oe,{key:"left",value:"left"},"\u5de6"),o.a.createElement(Oe,{key:"center",value:"center"},"\u4e2d"),o.a.createElement(Oe,{key:"right",value:"right"},"\u53f3")))):null,"Radio"===c?o.a.createElement(v.a.Item,Object.assign({label:"\u7c7b\u578b"},$),i.getFieldDecorator("radioType",{initialValue:s})(o.a.createElement(B.a,null,o.a.createElement(Oe,{key:"default",value:"default"},"\u9ed8\u8ba4"),o.a.createElement(Oe,{key:"tab",value:"tab"},"tab")))):null,this.renderContent(),o.a.createElement("div",{className:"btn-box"},o.a.createElement(C.a,{onClick:this.onDeleteComponent},"\u5220\u9664\u7ec4\u4ef6")),o.a.createElement("div",{className:"btn-bottom-box"},o.a.createElement(C.a,{type:"primary",htmlType:"submit"},"\u4fdd\u5b58"))))}}]),t}(Ce),je=v.a.create()(xe),Se=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=t.state,o=n.dropComponent,i=n.dropConfig,l=e.type,r=Object(S.a)(e,["type"]),c={textAlign:"left",configs:{}};if(o){if("Button"!==l||"Button"!==i.type)return;(c=Object.assign({},i)).configs.buttonArr.push(Object(x.a)({btnIndex:t.btnIndex},r)),t.btnIndex+=1}else"Button"===l?(c.configs.buttonArr=[Object(x.a)({btnIndex:t.btnIndex},r)],t.btnIndex+=1):c={configs:Object(x.a)({},r)},c.type=l;return a&&"Button"!==c.type&&(c.originSpan=t.props.originSpan,c.cellStyles=t.props.cellStyles,c.colIndex=t.props.colIndex,c.colSpan=t.props.colSpan,c.configs.label=l,c.configs.name="name-".concat(t.props.colIndex)),c},ke=["FormContainer","TableContainer","EmptyContainer","BoxContainer","HeaderContainer","LineContainer"],Ie=function(){return!!localStorage.getItem("access_token")&&!!localStorage.getItem("webapi")},we=function(e){return ke.indexOf(e)>-1},Ae=(a(384),"drop-container"),De=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(s.a)(this,Object(d.a)(t).call(this,e))).state={dropConfig:e.preview?e.dropConfig:{},showEdit:!1,dropComponent:!1},a.onDrop=a.onDrop.bind(Object(p.a)(Object(p.a)(a))),a.onDragenter=a.onDragenter.bind(Object(p.a)(Object(p.a)(a))),a.onToggleEdit=a.onToggleEdit.bind(Object(p.a)(Object(p.a)(a))),a.onUpdateConfigs=a.onUpdateConfigs.bind(Object(p.a)(Object(p.a)(a))),a.btnIndex=1,a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.DropDom&&!this.props.preview&&(this.DropDom.addEventListener("drop",this.onDrop,!1),this.DropDom.addEventListener("dragleave",this.onDragLeave,!1),this.DropDom.addEventListener("dragenter",this.onDragenter,!1))}},{key:"componentWillUnmount",value:function(){this.DropDom&&!this.props.preview&&(this.DropDom.removeEventListener("drop",this.onDrop),this.DropDom.removeEventListener("dragleave",this.onDragLeave),this.DropDom.removeEventListener("dragenter",this.onDragenter))}},{key:"onToggleEdit",value:function(){this.setState({showEdit:!this.state.showEdit})}},{key:"onUpdateConfigs",value:function(e){var t=e.deleteFlag,a=void 0!==t&&t,n=Object(S.a)(e,["deleteFlag"]),o=this.props,i=o.onUpdateLayoutConfig,l=o.dropIndex,r={dropConfig:{dropIndex:l}};a?(r.dropComponent=!1,r.dropConfig.cellStyles=n.cellStyles):r.dropConfig=Object.assign({},this.state.dropConfig,Object.hasOwnProperty.call(n,"configs")?{configs:n.configs}:n),this.setState(Object(x.a)({},r)),i(Object(x.a)({},r.dropConfig,{deleteFlag:a,dropIndex:l})),we(this.state.dropConfig.type)||this.onToggleEdit()}},{key:"onDrop",value:function(e){var t=this;if(e.preventDefault(),e.stopPropagation(),e.target.className===Ae){this.resetBg();var a=JSON.parse(e.dataTransfer.getData("text/plain")),n=this.props,o=n.onUpdateLayoutConfig,i=n.dropIndex,l=Se(a,this),r=l.type,c=Object(S.a)(l,["type"]);c&&this.setState({dropConfig:Object(x.a)({type:r,dropIndex:i},c),dropComponent:!0},function(){o(t.state.dropConfig)})}}},{key:"resetBg",value:function(){var e=document.querySelectorAll(".drop-container");e&&e.forEach(function(e){e.style.background=""})}},{key:"onDragenter",value:function(e){e.target.className===Ae&&(e.target.style.background="#dde7f1")}},{key:"onDragLeave",value:function(e){e.target.className===Ae&&(e.target.style.background="")}},{key:"render",value:function(){var e=this,t=this.state,a=t.dropComponent,i=t.dropConfig,l=t.showEdit,r=this.props,c=r.dropIndex,s=r.layerConfig,d=r.preview,u=d?this.props.dropConfig:Object.assign({dropIndex:c},i);return o.a.createElement("div",{className:"drop-container",ref:function(t){e.DropDom=t}},a||d?o.a.createElement(n.Fragment,null,o.a.createElement(pe,Object.assign({},this.props,{onUpdateLayoutConfig:this.onUpdateConfigs,dropConfig:u})),we(i.type)||d?null:o.a.createElement(U.a,{type:"bars",className:"icon-operation",onClick:this.onToggleEdit})):d?null:o.a.createElement(U.a,{type:"drag"}),o.a.createElement(je,{visible:l,dropConfig:i,layerConfig:s,inForm:!1,onClose:this.onToggleEdit,onUpdateConfigs:this.onUpdateConfigs}))}}]),t}(n.PureComponent),Te=(a(385),y.a.TextArea),Fe=B.a.Option,Pe=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(s.a)(this,Object(d.a)(t).call(this,e))).handleSubmit=a.handleSubmit.bind(Object(p.a)(Object(p.a)(a))),a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"handleSubmit",value:function(e){e.preventDefault();var t=this.props,a=t.form,n=t.onClose;a.validateFields(function(e,t){if(!e){var a=t.boxStyles,o=Object(S.a)(t,["boxStyles"]),i=Object(x.a)({boxStyles:me(a)},o);n(i)}})}},{key:"render",value:function(){var e=this.props,t=e.visible,a=e.form,n=e.onClose,i=e.configs,l=void 0===i?{}:i,r=e.onDeleteContainer,c=e.type,s=l.boxStyles,d=void 0===s?{}:s,u=l.layoutColumn,p=void 0===u?3:u,m=l.positionFixed,g=void 0===m?"0":m,f=ge(d),b=a.getFieldDecorator;return o.a.createElement(q.a,{visible:t,maskClosable:!1,width:420,title:"\u7f16\u8f91\u5217",onClose:function(){n(0)}},o.a.createElement(v.a,{onSubmit:this.handleSubmit,style:{padding:"0 20px"}},o.a.createElement(v.a.Item,Object.assign({label:"style\u8bbe\u7f6e"},$),a.getFieldDecorator("boxStyles",{initialValue:f})(o.a.createElement(Te,{placeholder:"\u591a\u4e2a\u6837\u5f0f\u5c5e\u6027\u8bf7\u7528\u5206\u53f7\u5206\u9694"}))),"HeaderContainer"===c?o.a.createElement(v.a.Item,Object.assign({label:"\u4f4d\u7f6e\u56fa\u5b9a"},$),b("positionFixed",{initialValue:g})(o.a.createElement(B.a,null,o.a.createElement(Fe,{value:"1"},"\u662f"),o.a.createElement(Fe,{value:"0"},"\u5426")))):null,o.a.createElement(v.a.Item,Object.assign({label:"\u5bb9\u5668\u5217"},$),b("layoutColumn",{initialValue:p,rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u5217\u6570!"}]})(o.a.createElement(B.a,null,o.a.createElement(Fe,{value:"1"},"1"),o.a.createElement(Fe,{value:"2"},"2"),o.a.createElement(Fe,{value:"3"},"3"),o.a.createElement(Fe,{value:"4"},"4"),o.a.createElement(Fe,{value:"5"},"5"),o.a.createElement(Fe,{value:"6"},"6"),o.a.createElement(Fe,{value:"7"},"7"),o.a.createElement(Fe,{value:"8"},"8")))),o.a.createElement("div",{className:"btn-box"},o.a.createElement(C.a,{type:"primary",htmlType:"submit",style:{marginRight:"10px"}},"\u786e\u5b9a"),o.a.createElement(C.a,{onClick:r},"\u5220\u9664\u5bb9\u5668"))))}}]),t}(n.Component),Le=v.a.create()(Pe),Me=(a(386),function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(s.a)(this,Object(d.a)(t).call(this,e))).state={visible:!1,configs:{cellsArr:[{dropIndex:0}],layoutColumn:1}},a.onAddRowCell=a.onAddRowCell.bind(Object(p.a)(Object(p.a)(a))),a.onToggleEdit=a.onToggleEdit.bind(Object(p.a)(Object(p.a)(a))),a.onDeleteContainer=a.onDeleteContainer.bind(Object(p.a)(Object(p.a)(a))),a.onUpdateConfigs=a.onUpdateConfigs.bind(Object(p.a)(Object(p.a)(a))),a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"onToggleEdit",value:function(){this.setState({visible:!this.state.visible})}},{key:"onDeleteContainer",value:function(){var e=this.props;(0,e.onUpdateLayoutConfig)({layoutIndex:e.layoutIndex,deleteFlag:!0}),this.onToggleEdit()}},{key:"onUpdateConfigs",value:function(e){var t=e.deleteFlag,a=void 0!==t&&t,n=Object(S.a)(e,["deleteFlag"]),o=this.state.configs,i=this.props,l=i.onUpdateLayoutConfig,r=i.layoutIndex,c=i.layoutColumn,s=Object.assign(Object(x.a)({},o),c),d=s.cellsArr.reduce(function(e,t){return a?n.dropIndex!==t.dropIndex?e.push(Object.assign({},t)):e.push({dropIndex:n.dropIndex}):n.dropIndex===t.dropIndex?e.push(Object.assign({},t,n)):e.push(Object.assign({},t)),e},[]);s.cellsArr=d,this.setState({configs:s},function(){l({layoutIndex:r,configs:s})})}},{key:"onAddRowCell",value:function(){var e=this.props,t=e.onUpdateLayoutConfig,a=e.layoutIndex,n=this.state.configs,o=n.cellsArr,i={layoutColumn:n.layoutColumn,cellsArr:o.concat([{dropIndex:o.length}])},l={configs:i};this.setState(Object(x.a)({},l),function(){t({layoutIndex:a,configs:i})})}},{key:"rendeCell",value:function(e){if(!e)return null;for(var t=this.props,a=t.preview,n=t.context,i=void 0===n?this:n,l=t.apiData,r=t.execFetchApi,c=t.onShowLoginModal,s=[],d="".concat(100/e,"%"),u=(a?this.props:this.state).configs.cellsArr,p=u.length,m=this.props.layerConfig,g={preview:a},f=0;f<p;f++)g.dropConfig=u[f],s.push(o.a.createElement("div",{className:"cell border-box",key:"cell-".concat(e,"-").concat(f),style:{width:d}},o.a.createElement(De,Object.assign({dropIndex:f,apiData:l,execFetchApi:r,layerConfig:m},g,{onShowLoginModal:c,context:i,onUpdateLayoutConfig:this.onUpdateConfigs}))));return s}},{key:"render",value:function(){var e=this,t=this.state.visible,a=this.props,n=a.onUpdateLayoutConfig,i=a.layoutIndex,l=a.configs,r=void 0===l?{}:l,c=a.preview,s=r.layoutColumn,d=void 0===s?1:s,u=r.boxStyles;return o.a.createElement("div",{className:"fulu-cell-box ".concat(c?"preview-mode":"edit-mode"),style:u},o.a.createElement("div",{className:"clear-box"},this.rendeCell(+d)),o.a.createElement(Le,{visible:t,configs:r,onClose:function(t){if(t){for(var a={layoutIndex:i},o=t.layoutColumn,l=e.state.configs.cellsArr.slice(0,o),r=0;r<o;r++)l.length<=r&&l.push({dropIndex:r});var c={cellsArr:l,layoutColumn:o,boxStyles:t.boxStyles};a.configs=c,e.setState({configs:c}),n(a)}e.onToggleEdit()},onDeleteContainer:this.onDeleteContainer}),c?null:o.a.createElement(U.a,{type:"form",className:"icon-operation",onClick:this.onToggleEdit}),c?null:o.a.createElement("div",{className:"btn-add-box"},o.a.createElement(C.a,{onClick:this.onAddRowCell},"\u65b0\u589e\u5355\u5143\u683c")))}}]),t}(n.PureComponent)),Ne=(a(387),function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(s.a)(this,Object(d.a)(t).call(this,e))).state={visible:!1,configs:e.preview?e.configs:{cellsArr:[{dropIndex:0}],layoutColumn:1}},a.onToggleEdit=a.onToggleEdit.bind(Object(p.a)(Object(p.a)(a))),a.onDeleteContainer=a.onDeleteContainer.bind(Object(p.a)(Object(p.a)(a))),a.onUpdateConfigs=a.onUpdateConfigs.bind(Object(p.a)(Object(p.a)(a))),a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"onToggleEdit",value:function(){this.setState({visible:!this.state.visible})}},{key:"onDeleteContainer",value:function(){var e=this.props;(0,e.onUpdateLayoutConfig)({layoutIndex:e.layoutIndex,deleteFlag:!0}),this.onToggleEdit()}},{key:"onUpdateConfigs",value:function(e){var t=e.deleteFlag,a=void 0!==t&&t,n=Object(S.a)(e,["deleteFlag"]),o=this.state.configs,i=this.props,l=i.onUpdateLayoutConfig,r=i.layoutIndex,c=i.layoutColumn,s=Object.assign({},o,c),d=s.cellsArr.reduce(function(e,t){return a?n.dropIndex!==t.dropIndex?e.push(Object.assign({},t)):e.push({dropIndex:n.dropIndex}):n.dropIndex===t.dropIndex?e.push(Object.assign({},t,n)):e.push(Object.assign({},t)),e},[]);s.cellsArr=d,this.setState({configs:s},function(){l({layoutIndex:r,configs:s})})}},{key:"rendeCell",value:function(e){if(!e)return null;for(var t=[],a="".concat(100/e,"%"),n=this.state.configs,i=this.props.preview,l=n.cellsArr,r=void 0===l?[]:l,c=r.length,s=0;s<c;s++)t.push(o.a.createElement("div",{className:"cell border-box",key:"cell-".concat(e,"-").concat(s),style:{width:a}},o.a.createElement(De,{dropIndex:s,preview:i,dropConfig:r[s],onUpdateLayoutConfig:this.onUpdateConfigs})));return t}},{key:"render",value:function(){var e=this,t=this.state.visible,a=this.props,n=a.onUpdateLayoutConfig,i=a.layoutIndex,l=a.configs,r=void 0===l?{}:l,c=a.preview,s=void 0!==c&&c,d=a.type,u=r.layoutColumn,p=void 0===u?1:u,m=r.boxStyles,g="1"===r.positionFixed?"position-fixed":"",f=s?"preview-box":"";return o.a.createElement("div",{className:"header-box fulu-cell-box ".concat(g,"  ").concat(f),style:m},this.rendeCell(+p),o.a.createElement(Le,{visible:t,configs:r,type:d,onClose:function(t){if(t){for(var a={layoutIndex:i},o=t.layoutColumn,l=e.state.configs.cellsArr.slice(0,o),r=0;r<o;r++)l.length<=r&&l.push({dropIndex:r});var c=Object(x.a)({},t,{cellsArr:l});a.configs=c,e.setState({configs:c}),n(a)}e.onToggleEdit()},onDeleteContainer:this.onDeleteContainer}),s?null:o.a.createElement(U.a,{type:"form",className:"icon-operation",onClick:this.onToggleEdit}))}}]),t}(n.PureComponent)),Ve=z.a.Group,Ue=B.a.Option,Be=H.a.RangePicker,qe=K.a.TabPane,Re=y.a.TextArea,ze=function(e,t){var a=e.placeholder,n=void 0===a?"":a,i=e.type,l=null;switch(void 0===i?"Input":i){case"Text":l=Qe(e);break;case"Breadcrumb":l=_e(e);break;case"Select":l=et(e);break;case"RangePicker":l=at(e);break;case"DatePicker":l=tt(e);break;case"Radio":l=$e(e);break;case"Checkbox":l=Xe(e);break;case"Tabs":l=Ze(e);break;case"Button":l=nt(e,t);break;case"FormContainer":l=Ke(e,t);break;case"LineContainer":l=We(e,t);break;case"TableContainer":l=Ge(e,t);break;case"BoxContainer":l=Ye(e,t);break;case"HeaderContainer":l=Je(e,t);break;case"TextArea":l=He(e);break;case"Input":l=o.a.createElement(y.a,{placeholder:n})}return l},He=function(e){e.colIndex,e.dropIndex,e.originSpan,e.cellStyles,e.hasLinkage;var t=Object(S.a)(e,["colIndex","dropIndex","originSpan","cellStyles","hasLinkage"]);return o.a.createElement(Re,t)},Ke=function(e,t){return o.a.createElement(Et,Object.assign({},e,t))},Je=function(e){return o.a.createElement(Ne,e)},Ge=function(e,t){return o.a.createElement(ue,Object.assign({},e,t))},We=function(e){return o.a.createElement(W,e)},Ye=function(e,t){return o.a.createElement(Me,Object.assign({},e,t))},_e=function(e){var t=e.configs,a=t.breadcrumbArr,n=void 0===a?[]:a,i=t.style;return o.a.createElement(J.a,{style:i},n.map(function(e,t){var a=e.label,n=e.value;return o.a.createElement(J.a.Item,{key:"breadcrumb-".concat(t)},n?o.a.createElement("a",{href:n},a):o.a.createElement("span",null,a))}))},Qe=function(e){var t=e.configs,a=t.text,n=t.style;return o.a.createElement("span",{style:n},a)},$e=function(e){var t=e.configs,a=t.style,n=void 0===a?{}:a,i=t.radioArr,l=void 0===i?[]:i,r="tab"===t.radioType?G.a.Button:G.a;return o.a.createElement(G.a.Group,{style:Object(x.a)({},n)},Array.isArray(l)?l.map(function(e){var t=e.key,a=e.label,n=e.value;return o.a.createElement(r,{key:t||n,value:n},a)}):null)},Ze=function(e){var t=e.configs,a=t.style,n=void 0===a?{}:a,i=t.tabsArr,l=void 0===i?[]:i;return o.a.createElement(K.a,{style:n},Array.isArray(l)?l.map(function(e){var t=e.key,a=e.label,n=e.value;return o.a.createElement(qe,{key:t||n,tab:a})}):null)},Xe=function(e){var t=e.configs,a=t.style,n=void 0===a?{}:a,i=t.checkboxArr,l=void 0===i?[]:i;return l.length>0?o.a.createElement(Ve,{options:l,style:Object(x.a)({width:"100%"},n)}):null},et=function(e){var t=e.configs,a=t.style,n=void 0===a?{}:a,i=(t.options,t.selectArr,Object(S.a)(t,["style","options","selectArr"])),l=Object.hasOwnProperty.call(t,"options")?t.options:t.selectArr;return o.a.createElement(B.a,Object.assign({style:Object(x.a)({width:"100%"},n)},i),Array.isArray(l)?l.map(function(e){var t=e.key,a=e.label,n=e.value;return o.a.createElement(Ue,{key:t||n,value:n},a)}):null)},tt=function(e){var t=e.configs,a=t.showTime,n=t.format;return o.a.createElement(H.a,{style:{width:"100%"},showTime:a,format:n})},at=function(e){var t=e.configs,a=t.showTime,n=t.format;return o.a.createElement(Be,{showTime:a,format:n,style:{width:"100%"}})},nt=function(e,t){var a=e.configs,n=t.context,i=a.buttonArr,l=void 0===i?[]:i,r=n||{},c=r.expand,s=r.onCollapse;return o.a.createElement("span",{className:"btn-group"},l.map(function(e){e.logicType;var t=e.btnText,a=e.expandFlag,i=void 0===a?"0":a,l=(e.expandCount,e.api),r=e.modalName,d=e.antdType,u=e.style,p=void 0===u?{}:u,m=(e.textDisabled,e.btnIndex),g=Object(S.a)(e,["logicType","btnText","expandFlag","expandCount","api","modalName","antdType","style","textDisabled","btnIndex"]);if("1"===i){var f=c?"\u9690\u85cf":"\u5c55\u5f00";return o.a.createElement("span",{className:"btn-collapse",onClick:s,style:p,key:"btn-".concat(m)},f,o.a.createElement(U.a,{type:c?"up":"down"}))}return"submit"!==e.htmlType&&"reset"!==e.htmlType&&(g.onClick=function(e){n&&r&&n.onShowModal(e,r,l)}),o.a.createElement(C.a,Object.assign({key:"btn-".concat(m),style:p,type:d},g),t)}))},ot=function(e,t){var a,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=e.getFieldDecorator,l=(a=n.index,/\d+/.test(a));return Array.isArray(t)?t.map(function(e){var t=e.label,a=e.key,r=e.rules,c=void 0===r?[]:r,s=e.initialValue,d=e.required,u=Object(S.a)(e,["label","key","rules","initialValue","required"]);return d&&c.push({required:!0,message:"\u8bf7\u8f93\u5165".concat(t)}),o.a.createElement(v.a.Item,Object.assign({label:t,key:"".concat(a,"-item")},$),i(l?"".concat(a,"-").concat(n.index):a,{rules:c,initialValue:n[a]||s})(ze({type:u.type,configs:u})))}):null},it=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i="".concat(n),l=e.modalArr,r=void 0===l?[]:l;if(0===r.length)return null;var c=i?"modal-item-".concat(i):"modal-item",s=i?"modalName-".concat(i):"modalName";return o.a.createElement(v.a.Item,Object.assign({key:c,label:"\u6253\u5f00modal"},$),t.getFieldDecorator(s,{rules:[{required:!0,message:"modal"}],initialValue:a})(o.a.createElement(B.a,{placeholder:"modal"},r.map(function(e){var t=e.index,a=e.name;return o.a.createElement(Ue,{key:"modalName-".concat(t),value:a},a)}))))},lt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0,n=a.initialValue,i=a.key,l=void 0===i?"":i,r=a.label,c=void 0===r?"\u8c03\u7528api":r,s=a.apiName,d="".concat(l),u=e.apiArr,p=void 0===u?[]:u;if(0===p.length)return null;var m=s?"api-item-".concat(s):d?"api-item-".concat(d):"modal-item",g=s||(d?"api-".concat(d):"api");return o.a.createElement(v.a.Item,Object.assign({key:m,label:c},$),t.getFieldDecorator(g,{rules:[{required:!0,message:"api"}],initialValue:n})(o.a.createElement(B.a,{placeholder:"api"},p.map(function(e){var t=e.index,a=e.requestApi;return o.a.createElement(Ue,{key:"api-".concat(t),value:a},a)}))))},rt=ze,ct=(a(388),B.a.Option),st=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(s.a)(this,Object(d.a)(t).call(this,e))).handleSubmit=a.handleSubmit.bind(Object(p.a)(Object(p.a)(a))),a.handleChange=a.handleChange.bind(Object(p.a)(Object(p.a)(a))),a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"handleChange",value:function(e){for(var t=this,a={},n=24/e,o=0;o<e;o++)a["colSpan-".concat(o)]=n;setTimeout(function(){t.props.form.setFieldsValue(a)},0)}},{key:"handleSubmit",value:function(e){e.preventDefault();var t=this.props,a=t.form,n=t.onClose;a.validateFields(function(e,t){if(!e){for(var a=+t.layoutColumn,o=0,i={colSpanArr:[]},l=0;l<a;l++){var r=+t["colSpan-".concat(l)];delete t["colSpan-".concat(l)],o+=r,i.colSpanArr.push(r)}if(o>24)return void k.a.error("\u8de8\u5217\u603b\u6570\u4e0d\u80fd\u8d85\u8fc724!");n(Object.assign(i,t))}})}},{key:"renderColSpanInputs",value:function(){for(var e=this.props.form,t=e.getFieldDecorator,a=+e.getFieldValue("layoutColumn"),n=[],i=0;i<a;i++)n.push(o.a.createElement(v.a.Item,Object.assign({key:"formitem-".concat(i),label:"\u7b2c".concat(i+1,"\u5217")},$),t("colSpan-".concat(i),{initialValue:24/a,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5217\u5bbd!"},{pattern:/^[1-9](\d)?$/,message:"\u53ea\u80fd\u5305\u542b\u6570\u5b57\uff01"}]})(o.a.createElement(y.a,null))));return n}},{key:"renderApiFormItem",value:function(){var e=this.props,t=e.form,a=e.layerConfig;return"query"===t.getFieldValue("formType")?lt(a,t,{label:"\u67e5\u8be2api",apiName:"queryApi"}):o.a.createElement(n.Fragment,null,lt(a,t,{label:"\u65b0\u589eapi",apiName:"addApi"}),lt(a,t,{label:"\u7f16\u8f91api",apiName:"editApi"}))}},{key:"render",value:function(){var e=this.props,t=e.visible,a=e.form,n=e.onClose,i=e.onDeleteContainer,l=a.getFieldDecorator;return o.a.createElement(q.a,{visible:t,maskClosable:!1,width:420,title:"\u7f16\u8f91\u5217",onClose:function(){n(0)}},o.a.createElement(v.a,{onSubmit:this.handleSubmit,style:{padding:"0 20px"}},o.a.createElement(v.a.Item,Object.assign({label:"\u8868\u5355\u5217"},$),l("layoutColumn",{initialValue:3,rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u5217\u6570!"}]})(o.a.createElement(B.a,{onChange:this.handleChange},o.a.createElement(ct,{value:"1"},"1"),o.a.createElement(ct,{value:"2"},"2"),o.a.createElement(ct,{value:"3"},"3"),o.a.createElement(ct,{value:"4"},"4")))),o.a.createElement(R.a,null),this.renderColSpanInputs(),o.a.createElement(R.a,null),o.a.createElement(v.a.Item,Object.assign({label:"\u8868\u5355\u7c7b\u578b"},$),l("formType",{initialValue:"query",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u8868\u5355\u7c7b\u578b!"}]})(o.a.createElement(B.a,null,o.a.createElement(ct,{value:"query"},"\u67e5\u8be2"),o.a.createElement(ct,{value:"save"},"\u65b0\u589e/\u7f16\u8f91")))),this.renderApiFormItem(),o.a.createElement("div",{className:"btn-box"},o.a.createElement(C.a,{type:"primary",htmlType:"submit",style:{marginRight:"10px"}},"\u786e\u5b9a"),o.a.createElement(C.a,{onClick:i},"\u5220\u9664\u5bb9\u5668"))))}}]),t}(n.Component),dt=v.a.create()(st),ut=a(39),pt=a(20),mt=a.n(pt),gt=function(e){function t(){return Object(r.a)(this,t),Object(s.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(c.a)(t,[{key:"getInitialValue",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.type,a=void 0===t?"Input":t,n=e.initialValue;return"DatePicker"===a||"RangePicker"===a?n&&mt()(n,"YYYY-MM-DD"):e.initialValue||""}},{key:"render",value:function(){var e=this.props,t=e.formItemConfig,a=e.form,i=e.context,l=e.preview,r=void 0!==l&&l,c=a.getFieldDecorator,s=t.configs,d=s.colSpan,u=s.label,p=s.name,m=s.rules,g=void 0===m?[]:m,f=s.cellStyles,b=void 0===f?{}:f,h=s.required,y=s.hasLinkage,C=t.type,O=t.textAlign,E=d||8;if(!p&&"Button"!==C)return null;if("1"===y){var x=s.linkName,j=s.condition;if(a.getFieldValue(x)!==j)return null}h&&g.push({required:!0,message:"\u8bf7\u8f93\u5165".concat(u)});var S="Button"===C?Object.assign({},b,{textAlign:O}):b;return o.a.createElement(n.Fragment,null,o.a.createElement(ut.a,{span:d,md:E,sm:24},"Button"!==C?o.a.createElement(v.a.Item,{label:u,style:S},c(p,{rules:g||[],initialValue:this.getInitialValue(s)})(rt(t,r,i))):o.a.createElement(v.a.Item,{style:S},rt(t,r,i))))}}]),t}(n.Component),ft=(a(389),B.a.Option),bt=y.a.TextArea,ht=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(s.a)(this,Object(d.a)(t).call(this,e))).state={buttonArr:[],selectArr:[],radioArr:[],checkboxArr:[]},a.onAddCellStyleItem=a.onAddCellStyleItem.bind(Object(p.a)(Object(p.a)(a))),a.onDeleteCellStyleItem=a.onDeleteCellStyleItem.bind(Object(p.a)(Object(p.a)(a))),a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"getItemSetType",value:function(){return["Select","Button","Radio","Checkbox"]}}]),Object(c.a)(t,[{key:"onAddCellStyleItem",value:function(){var e=this.state.cellStyles,t=(void 0===e?[]:e).slice();t.push({value:"",name:"",index:this.cellStyleIndex}),this.setState({cellStyles:t}),this.cellStyleIndex+=1}},{key:"onDeleteCellStyleItem",value:function(e){var t=this.state.cellStyles,a=(void 0===t?[]:t).reduce(function(t,a){return a.index!==e&&t.push(a),t},[]);this.setState({cellStyles:a})}},{key:"renderLinkage",value:function(e,t){var a=e.condition,i=e.linkName,l=this.props.form.getFieldDecorator;return o.a.createElement(n.Fragment,null,o.a.createElement(v.a.Item,Object.assign({},$,{label:"\u5173\u8054\u7ec4\u4ef6name"}),l("linkName",{initialValue:i})(o.a.createElement(B.a,null,t.map(function(t){var a=t.name,n=t.colIndex,i=t.label;return a&&n!==e.colIndex?o.a.createElement(ft,{value:"".concat(a)},"".concat(a,"/").concat(i)):null})))),o.a.createElement(v.a.Item,Object.assign({},$,{label:"condition"}),l("condition",{initialValue:a})(o.a.createElement(y.a,null))))}},{key:"renderDatePickerExtra",value:function(e){var t=e.showTime,a=void 0!==t&&t,i=e.format,l=void 0===i?"YYYY-MM-DD":i,r=this.props.form.getFieldDecorator;return o.a.createElement(n.Fragment,null,o.a.createElement(v.a.Item,Object.assign({},$,{label:"showTime"}),r("showTime",{initialValue:"1"===a?"1":"0"})(o.a.createElement(B.a,null,o.a.createElement(ft,{value:"1"},"\u662f"),o.a.createElement(ft,{value:"0"},"\u5426")))),o.a.createElement(v.a.Item,Object.assign({},$,{label:"format"}),r("format",{initialValue:l})(o.a.createElement(y.a,null))))}},{key:"renderContent",value:function(){var e=this.state.deleteComponent,t=this.props,a=t.form,i=t.dropComponent,l=void 0!==i&&i,r=t.dropConfig,c=void 0===r?{}:r,s=t.formItemArr,d=c.type,u=c.configs||{},p=u.label,m=u.name,g=u.placeholder,f=u.linkage,b=u.required,h=a.getFieldDecorator;return l&&!e?"Button"===d?this.renderBtnCard():o.a.createElement(n.Fragment,null,o.a.createElement(R.a,null,"\u7ec4\u4ef6"),o.a.createElement(v.a.Item,Object.assign({},$,{label:"label"}),h("label",{initialValue:p})(o.a.createElement(y.a,null))),o.a.createElement(v.a.Item,Object.assign({},$,{label:"name"}),h("name",{initialValue:m})(o.a.createElement(y.a,null))),o.a.createElement(v.a.Item,Object.assign({},$,{label:"required"}),h("required",{initialValue:b})(o.a.createElement(B.a,{allowClear:!0},o.a.createElement(ft,{value:1},"\u662f"),o.a.createElement(ft,{value:0},"\u5426")))),"DatePicker"===d||"RangePicker"===d?this.renderDatePickerExtra(c):null,"Radio"===d?this.renderRadio():null,"Checkbox"===d?this.renderCheckbox():null,"Select"===d?this.renderSelect():null,this.renderDefaultValueItem(),o.a.createElement(v.a.Item,Object.assign({},$,{label:"placeholder"}),h("placeholder",{initialValue:g})(o.a.createElement(y.a,null))),o.a.createElement(v.a.Item,Object.assign({},$,{label:"\u8054\u52a8\u5173\u8054"}),h("hasLinkage",{initialValue:f})(o.a.createElement(B.a,null,o.a.createElement(ft,{value:"0"},"\u5426"),o.a.createElement(ft,{value:"1"},"\u662f")))),"1"===a.getFieldValue("hasLinkage")?this.renderLinkage(c,s):null,o.a.createElement(v.a.Item,{style:{textAlign:"center"}},o.a.createElement(C.a,{onClick:this.onDeleteComponent},"\u5220\u9664\u7ec4\u4ef6"))):null}},{key:"renderCellStylesSetting",value:function(){var e=this,t=this.props.form,a=this.state.cellStyles;return o.a.createElement(Q.a,{title:"style\u8bbe\u7f6e",extra:o.a.createElement(U.a,{type:"plus-circle",onClick:this.onAddCellStyleItem})},a.map(function(a){var i=a.name,l=a.value,r=a.index;return o.a.createElement(n.Fragment,{key:"cell-styleitem-".concat(r)},o.a.createElement(v.a.Item,{key:"cell-styleitem-name-".concat(r),style:{width:"45%",display:"inline-block"}},t.getFieldDecorator("styleName-".concat(r),{initialValue:i})(o.a.createElement(y.a,{placeholder:"style name"}))),o.a.createElement(v.a.Item,{key:"cell-styleitem-value-".concat(r),style:{width:"45%",display:"inline-block",marginLeft:"10px"}},t.getFieldDecorator("styleValue-".concat(r),{initialValue:l})(o.a.createElement(y.a,{placeholder:"style value"}))),o.a.createElement(U.a,{type:"close-circle",style:{marginLeft:"6px",lineHeight:"39px"},onClick:function(){e.onDeleteCellStyleItem(r)}}))}))}},{key:"render",value:function(){for(var e=this,t=this.state.deleteComponent,a=this.props,n=a.visible,i=a.onClose,l=a.form,r=a.onDeleteFormItemContainer,c=a.dropConfig,s=a.colSpanArr,d=void 0===s?[]:s,u=a.dropComponent,p=1,m=c.colSpan,g=0;g<d.length;g++)(m-=d[g].colSpan)>0?p++:g=d.length;var f=c.type,b=c.textAlign,h=void 0===b?"left":b,y=ge(c.cellStyles);return o.a.createElement(q.a,{visible:n,maskClosable:!1,title:"\u7f16\u8f91\u8868\u5355\u9879",onClose:function(){e.onCloseEdit(),i()},width:420},o.a.createElement(v.a,{onSubmit:this.handleSubmit},o.a.createElement(R.a,null,"\u5355\u5143\u683c"),o.a.createElement(v.a.Item,{style:{padding:"0 24px"},label:"style\u8bbe\u7f6e"},l.getFieldDecorator("cellStyles",{initialValue:y})(o.a.createElement(bt,{placeholder:"\u591a\u4e2a\u6837\u5f0f\u5c5e\u6027\u8bf7\u7528\u5206\u53f7\u5206\u9694"}))),o.a.createElement(v.a.Item,{key:"cell-colSpan",label:"\u8de8\u5217\u8bbe\u7f6e",style:{padding:"0 24px"}},l.getFieldDecorator("originSpan",{initialValue:p})(o.a.createElement(B.a,null,d.map(function(e,t){return o.a.createElement(ft,{key:"".concat(e,"-").concat(t),value:t+1},"".concat(t+1,"\u5217"))})))),!t&&u&&"Button"===f?o.a.createElement(v.a.Item,{label:"\u5bf9\u9f50\u65b9\u5f0f",style:{padding:"0 24px"}},l.getFieldDecorator("textAlign",{initialValue:h})(o.a.createElement(B.a,null,o.a.createElement(ft,{key:"left",value:"left"},"\u5de6"),o.a.createElement(ft,{key:"center",value:"center"},"\u4e2d"),o.a.createElement(ft,{key:"right",value:"right"},"\u53f3")))):null,o.a.createElement("div",{className:"btn-box"},o.a.createElement(C.a,{onClick:r},"\u5220\u9664\u5355\u5143\u683c")),this.renderContent(),o.a.createElement("div",{className:"btn-bottom-box"},o.a.createElement(C.a,{type:"primary",htmlType:"submit"},"\u4fdd\u5b58"))))}}]),t}(Ce),vt=v.a.create()(ht),yt=(a(390),["Breadcrumb","Text","Tabs"]),Ct=function(e){function t(e){var a;Object(r.a)(this,t);var n=(a=Object(s.a)(this,Object(d.a)(t).call(this,e))).getConfigFromProps();return a.state={dropComponent:!(!n||!n.type),dropConfig:Object.assign({colSpan:e.colSpan,colIndex:e.colIndex,originSpan:e.originSpan,cellStyles:e.cellStyles||{}},n||{}),visible:!1},a.btnIndex=1,a.onUpdateConfig=a.onUpdateConfig.bind(Object(p.a)(Object(p.a)(a))),a.onShowEditItem=a.onShowEditItem.bind(Object(p.a)(Object(p.a)(a))),a.onEditDropContainer=a.onEditDropContainer.bind(Object(p.a)(Object(p.a)(a))),a.onDrop=a.onDrop.bind(Object(p.a)(Object(p.a)(a))),a.onDeleteCol=a.onDeleteCol.bind(Object(p.a)(Object(p.a)(a))),a.onClose=a.onClose.bind(Object(p.a)(Object(p.a)(a))),a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e){if(e.colSpan!==this.props.colSpan||e.colIndex!==this.props.colIndex){var t=Object.assign({},this.state.dropConfig,{colSpan:e.colSpan,colIndex:e.colIndex,originSpan:e.originSpan,cellStyles:e.cellStyles});this.setState({dropConfig:t})}}},{key:"getConfigFromProps",value:function(){var e=this,t=this.props.configs,a=(void 0===t?{}:t).formItemArr;return(void 0===a?[]:a).find(function(t){return t.colIndex===e.props.colIndex})}},{key:"onShowEditItem",value:function(){this.setState({visible:!0})}},{key:"onDrop",value:function(e){var t=this;if(e.preventDefault(),"drop-container border-box"===e.target.className){this.resetBg();var a=JSON.parse(e.dataTransfer.getData("text/plain")),n=a.type;if(~yt.indexOf(n))return void k.a.warn("\u5f53\u524d\u5bb9\u5668\u4e0d\u652f\u6301\u62d6\u62fd\u7684\u7ec4\u4ef6!");var o=this.props,i=o.onUpdateConfigs,l=o.colIndex,r=Se(a,this,!0);r&&this.setState({dropConfig:Object(x.a)({colIndex:l},r),dropComponent:!0},function(){i(t.state.dropConfig)})}}},{key:"onDeleteCol",value:function(e){e&&e.stopPropagation();var t=this.props,a=t.onUpdateConfigs,n=t.colIndex,o=this.state.dropConfig;this.setState({dropConfig:{colSpan:o.colSpan,originSpan:o.originSpan,colIndex:n},dropComponent:!1}),a({colIndex:n,deleteFlag:!0})}},{key:"resetBg",value:function(){var e=document.querySelectorAll(".form-container .drop-container");e&&e.forEach(function(e){e.style.background=""})}},{key:"onDragenter",value:function(e){"drop-container border-box"===e.target.className&&(e.target.style.background="#dde7f1")}},{key:"onDragLeave",value:function(e){"drop-container border-box"===e.target.className&&(e.target.style.background="")}},{key:"componentWillUnmount",value:function(){this.targetDom&&(this.targetDom.removeEventListener("drop",this.onDrop),this.targetDom.removeEventListener("dragleave",this.onDragLeave),this.targetDom.removeEventListener("dragenter",this.onDragenter))}},{key:"componentDidMount",value:function(){this.targetDom&&(this.targetDom.addEventListener("drop",this.onDrop,!1),this.targetDom.addEventListener("dragleave",this.onDragLeave,!1),this.targetDom.addEventListener("dragenter",this.onDragenter,!1))}},{key:"onUpdateConfig",value:function(e){var t=this,a=this.state.dropConfig,n=null;if(e.deleteFlag)n={colIndex:e.colIndex,colSpan:e.colSpan,originSpan:e.originSpan,cellStyles:e.cellStyles};else{var o=e.colIndex,i=e.colSpan,l=e.originSpan,r=e.cellStyles,c=Object(S.a)(e,["colIndex","colSpan","originSpan","cellStyles"]);n=Object.assign(a,{colIndex:o,colSpan:i,originSpan:l,cellStyles:r,configs:c})}this.setState({dropConfig:n,dropComponent:!e.deleteFlag},function(){(0,t.props.onUpdateConfigs)(n),t.onClose()})}},{key:"onEditDropContainer",value:function(e){"drop-container border-box"===e.target.className&&(e&&e.stopPropagation(),this.setState({visible:!0}))}},{key:"onClose",value:function(){this.setState({visible:!1})}},{key:"getContainerWidth",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;return"".concat(100*e/24,"%")}},{key:"render",value:function(){var e=this,t=this.state,a=t.dropComponent,n=t.dropConfig,i=void 0===n?{}:n,l=t.visible,r=this.props,c=r.layoutColumn,s=r.onDeleteFormItemContainer,d=r.colIndex,u=r.configs,p=void 0===u?{}:u,m=r.preview,g=+d,f=Object.hasOwnProperty.call(i,"colSpan")?i.colSpan:24/c;return o.a.createElement("div",{className:m?"preview-box ".concat("drop-container border-box"):"drop-container border-box",style:{width:this.getContainerWidth(f,c)},ref:function(t){e.targetDom=t}},a||m?o.a.createElement(gt,Object.assign({},this.props,{formItemConfig:m?this.getConfigFromProps():i})):o.a.createElement(U.a,{type:"drag"}),m?null:o.a.createElement(U.a,{type:"bars",className:"icon-operation",onClick:this.onShowEditItem}),o.a.createElement(vt,{visible:l,onDelete:this.onDeleteCol,onUpdateConfigs:this.onUpdateConfig,colSpanArr:p.colSpanArr,formItemArr:p.formItemArr,dropConfig:i,dropComponent:a,layoutColumn:c,onDeleteFormItemContainer:function(){e.setState({visible:!1},function(){s(g)})},onClose:this.onClose}))}}]),t}(n.PureComponent),Ot=(a(391),function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(s.a)(this,Object(d.a)(t).call(this,e))).state={visible:!1,fetchLoading:!1,expand:!1,configs:{layoutColumn:1,formItemArr:[]}},a.onSubmit=a.onSubmit.bind(Object(p.a)(Object(p.a)(a))),a.onShowEditForm=a.onShowEditForm.bind(Object(p.a)(Object(p.a)(a))),a.onCloseEditForm=a.onCloseEditForm.bind(Object(p.a)(Object(p.a)(a))),a.renderFormItemContainer=a.renderFormItemContainer.bind(Object(p.a)(Object(p.a)(a))),a.onAddRow=a.onAddRow.bind(Object(p.a)(Object(p.a)(a))),a.onAddRowCell=a.onAddRowCell.bind(Object(p.a)(Object(p.a)(a))),a.onDeleteRow=a.onDeleteRow.bind(Object(p.a)(Object(p.a)(a))),a.onDeleteContainer=a.onDeleteContainer.bind(Object(p.a)(Object(p.a)(a))),a.onDeleteFormItemContainer=a.onDeleteFormItemContainer.bind(Object(p.a)(Object(p.a)(a))),a.onUpdateConfigs=a.onUpdateConfigs.bind(Object(p.a)(Object(p.a)(a))),a.onCollapse=a.onCollapse.bind(Object(p.a)(Object(p.a)(a))),a.colIndexStart=0,a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.onFormRenderCallBack,a=e.form;"function"===typeof t&&t(a)}},{key:"onShowEditForm",value:function(){this.setState({visible:!0,expand:!1})}},{key:"onCollapse",value:function(){var e=this.state.expand;this.setState({expand:!e})}},{key:"addNewFormItem",value:function(e,t,a){if(e.length<t)for(var n=e.length;n<t;n++)e.push({colIndex:this.colIndexStart+n,colSpan:a[n],originSpan:1});return e}},{key:"onCloseEditForm",value:function(e){var t={visible:!1},a=e.layoutColumn,n=e.colSpanArr,o=+a;if(o){var i=this.state.configs.formItemArr.slice(),l=this.addNewFormItem(i,o,n);l.forEach(function(e){e.colSpan=fe(e.colIndex,e.originSpan,l,n)}),this.colIndexStart+=o,e.layoutColumn=o,e.formItemArr=l,t.configs=e}this.setState(Object(x.a)({},t))}},{key:"onAddRowCell",value:function(){var e=this,t=this.state.configs,a=t.colSpanArr,n=t.formItemArr.slice();if(0!==n.length){for(var o=n.reduce(function(e,t,a){return e+=t.colSpan,a===n.length-1&&(e%=24),e},0),i=0,l=0,r=0;r<a.length;r++)(l+=+a[r])>o&&(i=r,r=a.length);n.push({colIndex:this.colIndexStart,originSpan:1,colSpan:a[i]}),this.colIndexStart+=1;var c=Object.assign({},t);c.formItemArr=n,this.setState({configs:c},function(){var t=e.props;(0,t.onUpdateLayoutConfig)({layoutIndex:t.layoutIndex,configs:c})})}else k.a.warn("\u8bf7\u8bbe\u7f6e\u5bb9\u5668\u5217\u6570")}},{key:"onAddRow",value:function(){var e=this,t=this.state.configs,a=t.formItemArr.slice();if(0!==a.length){for(var n=t.layoutColumn,o=0;o<n;o++)a.push({colIndex:this.colIndexStart+o});this.colIndexStart+=n;var i=Object.assign({},t);i.formItemArr=a,this.setState({configs:i},function(){var t=e.props;(0,t.onUpdateLayoutConfig)({layoutIndex:t.layoutIndex,configs:i})})}else k.a.warn("\u8bf7\u8bbe\u7f6e\u5bb9\u5668\u5217\u6570")}},{key:"onDeleteRow",value:function(){var e=this,t=this.state.configs,a=t.layoutColumn,n=t.formItemArr,o=Object.assign({},t),i=n.slice();i.length<=a?k.a.warn("\u4e0d\u80fd\u518d\u5220\u9664\u4e86"):(i.length=Math.max(0,i.length-a),o.formItemArr=i,this.setState({configs:o},function(){var t=e.props;(0,t.onUpdateLayoutConfig)({layoutIndex:t.layoutIndex,newConfigs:o})}))}},{key:"onDeleteContainer",value:function(){var e=this.props;(0,e.onUpdateLayoutConfig)({layoutIndex:e.layoutIndex,deleteFlag:!0})}},{key:"onDeleteFormItemContainer",value:function(e){var t=this,a=this.state.configs,n=a.formItemArr,o=Object.assign({},a),i=n.filter(function(t){return t.colIndex!==e});o.formItemArr=i,this.setState({configs:o},function(){var e=t.props;(0,e.onUpdateLayoutConfig)({layoutIndex:e.layoutIndex,configs:o})})}},{key:"onUpdateConfigs",value:function(e){var t=e.deleteFlag,a=void 0!==t&&t,n=Object(S.a)(e,["deleteFlag"]),o=this.state.configs,i=o.formItemArr,l=o.colSpanArr,r=Object.assign({},o),c=this.props,s=c.onUpdateLayoutConfig,d=c.layoutIndex,u=i.reduce(function(e,t){return a?n.colIndex!==t.colIndex?e.push(Object.assign({},t)):e.push({colIndex:n.colIndex,colSpan:n.colSpan,originSpan:n.originSpan}):n.colIndex===t.colIndex?e.push(Object.assign({},t,n)):e.push(Object.assign({},t)),e},[]);u.forEach(function(e){e.colIndex>n.colIndex&&(e.colSpan=fe(e.colIndex,e.originSpan,u,l))});var p={};if("Button"===n.type){var m=n.configs.buttonArr.find(function(e){return"1"===e.expandFlag});p.expandCount=m?+m.expandCount:0}r.formItemArr=u,p.configs=r,this.setState(Object(x.a)({},p),function(){s({layoutIndex:d,configs:r})})}},{key:"onSubmit",value:function(e){var t=this;e.preventDefault();var a=this.props,n=a.onShowLoginModal,o=a.form,i=a.execFetchApi,l=a.mode;Ie()?o.validateFields(function(e,a){if(!e){var n=t.state.configs,o=ie(l,n);o?i(o,a):k.a.warn("\u8bf7\u914d\u7f6eform\u7684api\u5c5e\u6027")}}):n()}},{key:"renderFormItemContainer",value:function(){var e=this,t=this.props.preview?this.props:this.state,a=t.configs,n=void 0===a?{}:a,i=t.expand,l=t.expandCount,r=void 0===l?0:l,c=n.formItemArr,s=void 0===c?[]:c,d=n.layoutColumn;return s.map(function(t,a){var n=t.colIndex,l=t.colSpan,c=t.originSpan,s=t.cellStyles,u=t.type;return r>0&&!i&&a+1>r&&"Button"!==u?null:o.a.createElement(Ct,Object.assign({key:"ed-".concat(n),colIndex:n},e.props,{colSpan:l,expand:i,context:e,originSpan:c,layoutColumn:d,cellStyles:s,onCollapse:e.onCollapse,onDeleteFormItemContainer:e.onDeleteFormItemContainer,onUpdateConfigs:e.onUpdateConfigs}))})}},{key:"render",value:function(){var e=this,t=this.state.visible,a=this.props,i=a.layoutIndex,l=a.onUpdateLayoutConfig,r=a.preview,c=a.layerConfig,s=(r?this.props:this.state).configs,d=(void 0===s?{}:s)||{},u=d.layoutColumn,p=void 0===u?1:u,m=d.formItemArr,g=void 0===m?[]:m;return o.a.createElement(n.Fragment,null,o.a.createElement("div",{className:"form-container container ".concat(r?"preview-box":"border-box")},o.a.createElement("div",{className:"inner-box"},o.a.createElement(v.a,{onSubmit:this.onSubmit},o.a.createElement(V.a,{gutter:{md:24/p,lg:24,xl:48}},this.renderFormItemContainer())),g.length>0&&!r?o.a.createElement("div",{style:{textAlign:"center",marginTop:"10px"}},o.a.createElement(C.a,{onClick:this.onAddRowCell},"\u65b0\u589e\u5355\u5143\u683c")):null),r?null:o.a.createElement(U.a,{type:"form",className:"icon-operation",onClick:this.onShowEditForm})),o.a.createElement(dt,{visible:t,layerConfig:c,onDeleteContainer:this.onDeleteContainer,onClose:function(t){var a=t.layoutColumn;e.onCloseEditForm(t),a&&l({layoutIndex:i,configs:t})}}))}}]),t}(n.PureComponent)),Et=v.a.create()(Ot),xt=a(194),jt=a.n(xt),St=(a(392),function(e){function t(){return Object(r.a)(this,t),Object(s.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(c.a)(t,[{key:"renderContainer",value:function(){var e=this.props,t=e.layoutConfig,a=Object(S.a)(e,["layoutConfig"]);return Array.isArray(t)&&t.length>0?t.map(function(e){var t=e.type,n=e.layoutIndex,i="layout-".concat(n),l=Object.assign({key:i},a,e);return"FormContainer"===t?o.a.createElement(Et,l):"TableContainer"===t?o.a.createElement(ue,l):"EmptyContainer"===t?o.a.createElement(jt.a,l):"BoxContainer"===t?o.a.createElement(Me,l):"HeaderContainer"===t?o.a.createElement(Ne,l):"LineContainer"===t?o.a.createElement(W,l):null}):o.a.createElement("div",{className:"empty-tips"},"\u8bf7\u6dfb\u52a0\u5bb9\u5668\u7ec4\u4ef6")}},{key:"render",value:function(){return o.a.createElement(n.Fragment,null,this.renderContainer())}}]),t}(n.PureComponent)),kt=function(e){function t(){return Object(r.a)(this,t),Object(s.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(c.a)(t,[{key:"onDragStart",value:function(e,t){e.dataTransfer.setData("text/plain",JSON.stringify(t))}},{key:"render",value:function(){var e=this,t=this.props,a=t.ch,n=t.data;return o.a.createElement("span",{draggable:"true",className:"drag-item",onDragStart:function(t){e.onDragStart(t,n)}},a)}}]),t}(n.PureComponent),It={component:{form:[{ch:"Input",data:{type:"Input",label:"",name:""}},{ch:"Select",data:{type:"Select"}},{ch:"DatePicker",data:{type:"DatePicker"}},{ch:"RangePicker",data:{type:"RangePicker"}},{ch:"Radio",data:{type:"Radio",radioArr:[{index:0,value:"a1",label:"a"},{index:1,value:"b1",label:"b"}],radioType:"default"}},{ch:"TextArea",data:{type:"TextArea",label:"",name:""}},{ch:"Checkbox",data:{type:"Checkbox"}}],button:[{ch:"\u67e5\u8be2",data:{logicType:"query",type:"Button",antdType:"primary",textDisabled:!0,btnText:"\u67e5\u8be2",htmlType:"submit"}},{ch:"\u91cd\u7f6e",data:{logicType:"reset",type:"Button",antdType:"button",textDisabled:!0,btnText:"\u91cd\u7f6e",htmlType:"reset"}},{ch:"\u5c55\u5f00/\u6536\u8d77",data:{logicType:"expand",type:"Button",textDisabled:!0,btnText:"\u5c55\u5f00/\u6536\u8d77"}},{ch:"\u5bfc\u5165",data:{logicType:"import",type:"Button",btnText:"\u5bfc\u5165"}},{ch:"\u5bfc\u51fa",data:{logicType:"export",type:"Button",btnText:"\u5bfc\u51fa"}},{ch:"\u65b0\u589e",data:{logicType:"add",type:"Button",btnText:"\u65b0\u589e"}},{ch:"\u7f16\u8f91",data:{logicType:"edit",type:"Button",btnText:"\u7f16\u8f91"}},{ch:"\u67e5\u770b",data:{logicType:"view",type:"Button",btnText:"\u67e5\u770b"}},{ch:"\u6279\u91cf",data:{logicType:"mult",type:"Button",btnText:"\u6279\u91cf"}},{ch:"\u8df3\u8f6c",data:{logicType:"skip",type:"Button",btnText:"\u8df3\u8f6c"}}],others:[{ch:"Breadcrumb",data:{type:"Breadcrumb",breadcrumbArr:[{index:0,label:"menu1",value:""},{index:1,label:"menu2",value:""}]}},{ch:"Text",data:{type:"Text",text:"Text"}},{ch:"Tabs",data:{type:"Tabs",tabsArr:[{label:"tab1",value:"tab1",index:0}]}}]},layout:[{ch:"Form",data:{type:"FormContainer"}},{ch:"Table",data:{type:"TableContainer",columns:[{title:"column0",dataIndex:"dataIndex0",index:0},{title:"column1",dataIndex:"dataIndex1",index:1},{title:"column2",dataIndex:"dataIndex2",index:2},{title:"column3",dataIndex:"dataIndex3",index:3},{title:"column4",dataIndex:"dataIndex4",index:4}]}},{ch:"Box",data:{type:"BoxContainer",layoutColumn:1,cellsArr:[{dropIndex:0}]}},{ch:"Header",data:{type:"HeaderContainer",layoutColumn:1,positionFixed:"0",cellsArr:[{dropIndex:0}]}},{ch:"Line",data:{type:"LineContainer"}}]},wt=function(e){function t(){return Object(r.a)(this,t),Object(s.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(c.a)(t,[{key:"renderContentByType",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return o.a.createElement(n.Fragment,{key:"".concat(t)},t?o.a.createElement(R.a,{key:"".concat(t)},t):null,e.map(function(e,t){return o.a.createElement(kt,Object.assign({},e,{key:"drag-".concat(e.ch,"-").concat(t)}))}))}},{key:"render",value:function(){var e=this,t=this.props.tabType,a=It[void 0===t?"component":t]||[];return Array.isArray(a)?this.renderContentByType(a):Object.keys(a).map(function(t){return Array.isArray(a[t])?e.renderContentByType(a[t],t):null})}}]),t}(n.PureComponent),At=(a(393),K.a.TabPane),Dt=function(e){function t(){return Object(r.a)(this,t),Object(s.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){document.addEventListener("dragover",function(e){e.preventDefault()},!1),document.addEventListener("drag",function(e){},!1),document.addEventListener("dragstart",function(e){e.target.style.opacity=.5},!1),document.addEventListener("dragend",function(e){e.target.style.opacity="",document.querySelectorAll(".drop-zone").forEach(function(e){e.style.background="#fff"})},!1),document.addEventListener("dragenter",function(e){"drop-zone"===e.target.className&&(e.target.style.background="#96cdf9")},!1),document.addEventListener("dragleave",function(e){"drop-zone"===e.target.className&&(e.target.style.background="")},!1)}},{key:"render",value:function(){return o.a.createElement(K.a,{defaultActiveKey:"1",className:"aside-tabs"},o.a.createElement(At,{tab:"\u5bb9\u5668",key:"layout"},o.a.createElement(wt,{tabType:"layout"})),o.a.createElement(At,{tab:"\u7ec4\u4ef6",key:"component"},o.a.createElement(wt,null)),o.a.createElement(At,{tab:"\u6a21\u677f",key:"template"},o.a.createElement(wt,{tabType:"template"})))}}]),t}(n.Component),Tt=(a(394),f.a.Sider),Ft=f.a.Content,Pt=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(s.a)(this,Object(d.a)(t).call(this,e))).state={layoutConfig:[]},a.onSubmit=a.onSubmit.bind(Object(p.a)(Object(p.a)(a))),a.onUpdateLayoutConfig=a.onUpdateLayoutConfig.bind(Object(p.a)(Object(p.a)(a))),a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"onSubmit",value:function(){var e=this.props,t=e.onOk,a=e.editModal,n=this.state.layoutConfig;t(Object(x.a)({},a,{layoutConfig:n}))}},{key:"onUpdateLayoutConfig",value:function(e){this.setState({layoutConfig:e})}},{key:"render",value:function(){var e=this.props,t=e.visible,a=e.onCancel,n=e.layerConfig;return o.a.createElement(h.a,{title:"\u5f39\u6846\u7f16\u8f91",width:1024,visible:t,maskClosable:!1,onOk:this.onSubmit,onCancel:a},o.a.createElement(f.a,null,o.a.createElement(Tt,{width:"300"},o.a.createElement(Dt,null)),o.a.createElement(f.a,null,o.a.createElement(Ft,null,o.a.createElement(Kt,{onUpdateLayoutConfig:this.onUpdateLayoutConfig,layerConfig:n,noLayer:!0})))))}}]),t}(n.PureComponent),Lt=localStorage.getItem("common"),Mt=localStorage.getItem("main"),Nt=localStorage.getItem("webapi"),Vt=[{label:"\u63a5\u53e3\u5730\u5740\u524d\u7f00",key:"requestHost",type:"Select",initialValue:Nt,placeholder:"\u63a5\u53e3\u5730\u5740\u524d\u7f00",options:[{value:Lt,label:"common"},{value:Mt,label:"main"},{value:Nt,label:"webapi"}],rules:[{required:!0,message:"host!"}]},{label:"\u8bf7\u6c42\u65b9\u6cd5",key:"requestMethod",type:"Select",initialValue:"GET",placeholder:"\u8bf7\u6c42\u65b9\u6cd5",options:[{value:"GET",label:"GET"},{value:"POST",label:"POST"},{value:"PUT",label:"PUT"},{value:"DELETE",label:"DELETE"}],rules:[{required:!0,message:"method!"}]},{label:"\u63a5\u53e3\u5730\u5740",key:"requestApi",type:"Input",placeholder:"\u63a5\u53e3\u5730\u5740",rules:[{required:!0,message:"\u63a5\u53e3\u5730\u5740!"}]},{label:"\u63a5\u53e3\u53c2\u6570",key:"requestParams",type:"TextArea",placeholder:"\u63a5\u53e3\u5165\u53c2\uff0c\u591a\u4e2a\u53c2\u6570\u4ee5\u9017\u53f7\u5206\u9694"},{label:"modelKey",key:"modelKey",type:"Input",placeholder:"\u5b58\u653e\u5728model\u4e2d\u7684\u5b57\u6bb5\u540d\u79f0",rules:[{required:!0,message:"model key!"}]},{label:"API\u662f\u5426\u5206\u9875",key:"requestPagination",type:"Select",placeholder:"API\u662f\u5426\u5206\u9875",rules:[{required:!0,message:"requestPagination!"}],initialValue:"0",options:[{value:"1",label:"\u662f"},{value:"0",label:"\u5426"}]}],Ut=[{label:"\u540d\u79f0",key:"name",type:"Input",placeholder:"\u82f1\u6587\u540d\u79f0",rules:[{required:!0,message:"\u540d\u79f0!"}]},{label:"width",key:"width",type:"Input"},{label:"title",key:"title",type:"Input",placeholder:"title",rules:[{required:!0,message:"title!"}]}],Bt=(a(395),_.a.Panel),qt=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(s.a)(this,Object(d.a)(t).call(this,e))).state={layerConfig:{modalArr:[],apiArr:[],drawerArr:[]},editModal:null,showEditModal:!1},a.modalAddIndex=0,a.apiAddIndex=0,a.onClose=a.onClose.bind(Object(p.a)(Object(p.a)(a))),a.onAddApi=a.onAddApi.bind(Object(p.a)(Object(p.a)(a))),a.onAddModal=a.onAddModal.bind(Object(p.a)(Object(p.a)(a))),a.onDeleteApi=a.onDeleteApi.bind(Object(p.a)(Object(p.a)(a))),a.onDeleteModal=a.onDeleteModal.bind(Object(p.a)(Object(p.a)(a))),a.onSubmitLayer=a.onSubmitLayer.bind(Object(p.a)(Object(p.a)(a))),a.onShowEditModal=a.onShowEditModal.bind(Object(p.a)(Object(p.a)(a))),a.onCloseEditModal=a.onCloseEditModal.bind(Object(p.a)(Object(p.a)(a))),a.onSaveEditModal=a.onSaveEditModal.bind(Object(p.a)(Object(p.a)(a))),a.renderModalPanelHeader=a.renderModalPanelHeader.bind(Object(p.a)(Object(p.a)(a))),a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentDidUpdate",value:function(){this.props.visible&&!this.initState&&(this.initState=!0,this.setState({layerConfig:this.props.layerConfig}))}},{key:"onShowEditModal",value:function(e){this.setState({showEditModal:!0,editModal:e})}},{key:"onCloseEditModal",value:function(){this.setState({showEditModal:!1,editModal:null})}},{key:"onSaveEditModal",value:function(e){var t=e.layerType,a=this.state.layerConfig,n=Object.assign({},a),o=n.modalArr;if(t===D){var i=(void 0===o?[]:o).reduce(function(t,a){return a.index===e.index&&(a=Object.assign({},a,e)),t.push(a),t},[]);n.modalArr=i}this.setState({layerConfig:n}),this.onCloseEditModal()}},{key:"onClose",value:function(){var e=this.props,t=e.onCloseLayer;e.form.resetFields(),this.initState=!1,t()}},{key:"onSubmitLayer",value:function(e){var t=this;e.preventDefault();var a=this.props,n=a.form,o=a.onUpdateLayerConfig;n.validateFields(function(e,a){if(!e){var n=t.state.layerConfig,i=Object.assign({},n);[D,T].forEach(function(e){var t=te(a,e===D?Ut:Vt,!0);i["".concat(e,"Arr")]=t}),i.modalArr.forEach(function(e){n.modalArr.forEach(function(t){t.index==e.index&&(e.layoutConfig=t.layoutConfig,e.layerType=t.layerType)})}),o(i),t.onClose()}})}},{key:"onAddModal",value:function(){this.onAddItem(D)}},{key:"onAddApi",value:function(){this.onAddItem(T)}},{key:"onAddItem",value:function(e){var t=this.state.layerConfig,a=t["".concat(e,"Arr")].concat([{index:this["".concat(e,"AddIndex")],layerType:e}]),n=Object.assign({},t);n["".concat(e,"Arr")]=a,this.setState({layerConfig:n}),this["".concat(e,"AddIndex")]+=1}},{key:"onDeleteItem",value:function(e,t){var a=this.state.layerConfig,n=a["".concat(e,"Arr")].reduce(function(e,a){return a.index!=t&&e.push(a),e},[]),o=Object.assign({},a);o["".concat(e,"Arr")]=n||[],this.setState({layerConfig:o})}},{key:"onDeleteModal",value:function(e){this.onDeleteItem(D,e)}},{key:"onDeleteApi",value:function(e){this.onDeleteItem(T,e)}},{key:"renderModalPanelHeader",value:function(e){var t=this,a=e.name,n=e.index;return o.a.createElement("div",{className:"panel-header"},o.a.createElement("span",{className:"title"},a||"modal-".concat(n)),o.a.createElement("span",{className:"edit-modal",onClick:function(a){a.stopPropagation(),t.onShowEditModal(e)}},"\u7f16\u8f91"),o.a.createElement(U.a,{type:"close",className:"btn-delete",onClick:function(){t.onDeleteModal(n)}}))}},{key:"renderApiPanelHeader",value:function(e){var t=this,a=e.requestApi,n=e.index;return o.a.createElement("div",{className:"panel-header"},o.a.createElement("span",{className:"title"},a||"api-".concat(n)),o.a.createElement(U.a,{type:"close",className:"btn-delete",onClick:function(){t.onDeleteApi(n)}}))}},{key:"render",value:function(){var e=this,t=this.props,a=t.visible,i=t.form,l=this.state,r=l.layerConfig,c=l.showEditModal,s=l.editModal,d=r.modalArr,u=void 0===d?[]:d,p=r.apiArr,m=void 0===p?[]:p;return Vt[0].initialValue||(Vt[0].initialValue=localStorage.getItem("webapi"),Vt[0].options=[{value:localStorage.getItem("common"),label:"common"},{value:localStorage.getItem("main"),label:"main"},{value:localStorage.getItem("webapi"),label:"webapi"}]),o.a.createElement(n.Fragment,null,o.a.createElement(q.a,{title:"\u5f39\u51fa\u5c42&\u63a5\u53e3",placement:"right",closable:!0,maskClosable:!1,onClose:this.onClose,visible:a,width:"400"},o.a.createElement(v.a,{onSubmit:this.onSubmitLayer},o.a.createElement(R.a,null,"\u5f39\u7a97"),o.a.createElement(_.a,null,u.map(function(t){var a=t.index;return o.a.createElement(Bt,{header:e.renderModalPanelHeader(t),key:"modal-".concat(a)},ot(i,Ut,t))})),o.a.createElement("div",{className:"btn-add-box"},o.a.createElement(C.a,{type:"dashed",size:"large",onClick:this.onAddModal},"\u6dfb\u52a0\u5f39\u7a97")),o.a.createElement(R.a,null,"\u63a5\u53e3"),o.a.createElement(_.a,null,m.map(function(t){var a=t.index;return o.a.createElement(Bt,{header:e.renderApiPanelHeader(t),key:"api-".concat(a)},ot(i,Vt,t))})),o.a.createElement("div",{className:"btn-add-box"},o.a.createElement(C.a,{type:"dashed",size:"large",onClick:this.onAddApi},"\u6dfb\u52a0\u63a5\u53e3")),o.a.createElement(v.a.Item,{style:{marginTop:"20px",textAlign:"center"}},o.a.createElement(C.a,{type:"primary",htmlType:"submit"},"\u786e\u5b9a")))),o.a.createElement(Pt,{layerConfig:this.props.layerConfig,visible:c,editModal:s,onOk:this.onSaveEditModal,onCancel:this.onCloseEditModal}))}}]),t}(n.Component),Rt=v.a.create()(qt),zt=(a(396),function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(s.a)(this,Object(d.a)(t).call(this,e))).state={loading:!1},a.onCancel=a.onCancel.bind(Object(p.a)(Object(p.a)(a))),a.onSubmit=a.onSubmit.bind(Object(p.a)(Object(p.a)(a))),a.onAfterClose=a.onAfterClose.bind(Object(p.a)(Object(p.a)(a))),a.onFormRenderCallBack=a.onFormRenderCallBack.bind(Object(p.a)(Object(p.a)(a))),a.initEdit=!1,a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentDidUpdate",value:function(){var e=this.props,t=e.mode,a=e.visible,n=e.recordData,o=e.api,i=e.execFetchApi,l=e.modalLayoutConfig;if(a&&"edit"===t&&!this.initEdit){if(o)i(o,n);else if(n){var r=l.find(function(e){var t=e.type,a=e.configs;return"FormContainer"===t&&"save"===a.formType});if(r&&Array.isArray(r.configs.formItemArr)){var c=r.configs.formItemArr.reduce(function(e,t){t.type;var a=t.name;return e[a]=n[a],e},{});this.form&&this.form.setFieldsValue(c),this.formData=c}else k.a.warn("\u8bf7\u914d\u7f6e\u7f16\u8f91\u5f39\u7a97")}this.initEdit=!0}}},{key:"onCancel",value:function(){if(!this.state.loading){var e=this.props,t=e.modalName;(0,e.onCancelModal)(t)}}},{key:"renderContent",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=this.props.mode;return t.map(function(t,i){return o.a.createElement(n.Fragment,{key:"preview-".concat(i)},rt(t,{preview:!0,context:e,mode:a,onFormRenderCallBack:e.onFormRenderCallBack}))})}},{key:"onSubmit",value:function(){var e=this;if(!this.state.loading){var t=this.props,a=t.onOkModal,n=t.modalName,o=t.mode,i=t.modalLayoutConfig,l=t.layerConfig,r=t.recordData;this.form?this.form.validateFields(function(t,c){if(!t)if(Array.isArray(i)){var s=i.find(function(e){var t=e.type,a=e.configs;return"FormContainer"===t&&a.formType});if(s){var d=ie(o,s.configs),u=l.apiArr.find(function(e){return e.requestApi===d});if(u&&u.requestParams)u.requestParams.split(",").forEach(function(e){Object.hasOwnProperty.call(r,e)&&!Object.hasOwnProperty.call(c,e)&&(c[e]=r[e])});d?(e.setState({loading:!0}),a(n,d,c).then(function(t){var a=(t.data||{}).code;e.setState({loading:!1}),"0"===a&&(k.a.success("\u4fdd\u5b58\u6210\u529f"),e.onCancel())}).catch(function(){e.setState({loading:!1})})):k.a.warn("\u8bf7\u914d\u7f6eform\u7684api\u5c5e\u6027")}else k.a.warn("\u8bf7\u914d\u7f6eform\u7ec4\u4ef6")}else k.a.warn("\u8bf7\u914d\u7f6eform\u7ec4\u4ef6")}):k.a.warn("\u8bf7\u914d\u7f6eform\u7ec4\u4ef6")}}},{key:"onFormRenderCallBack",value:function(e){this.form=e,this.formData&&this.form.setFieldsValue(this.formData)}},{key:"onAfterClose",value:function(){this.initEdit=!1,this.formData=null,this.form&&this.form.resetFields()}},{key:"render",value:function(){var e=this.props,t=e.title,a=e.visible,n=e.modalLayoutConfig,i=e.mode,l=this.state.loading;return o.a.createElement(h.a,{title:"edit"===i?"\u7f16\u8f91":t,visible:a,onCancel:this.onCancel,onOk:this.onSubmit,afterClose:this.onAfterClose,maskClosable:!1},o.a.createElement(I.a,{spinning:l},this.renderContent(n)))}}]),t}(n.PureComponent)),Ht=(a(397),{modalArr:[],apiArr:[],drawerArr:[]}),Kt=(M="AppService",function(e){return function(t){var a=Object.assign({},t);if(Object.hasOwnProperty.call(P,M)){var n=P[M];"function"===typeof n&&(a.service=new n)}return o.a.createElement(e,a)}}(L=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(s.a)(this,Object(d.a)(t).call(this,e))).state={layoutConfig:e.preview?e.layoutConfig:[],layerConfig:e.layerConfig||Ht,PageIndex:1,PageSize:10,fetchLoading:!1,apiData:{},showLayer:!1,generateLoading:!1},a.paramData={},a.apiConfig={},a.onDrop=a.onDrop.bind(Object(p.a)(Object(p.a)(a))),a.onOkModal=a.onOkModal.bind(Object(p.a)(Object(p.a)(a))),a.onCancelModal=a.onCancelModal.bind(Object(p.a)(Object(p.a)(a))),a.onUpdateApiConfig=a.onUpdateApiConfig.bind(Object(p.a)(Object(p.a)(a))),a.onPageIndexChange=a.onPageIndexChange.bind(Object(p.a)(Object(p.a)(a))),a.onShowSizeChange=a.onShowSizeChange.bind(Object(p.a)(Object(p.a)(a))),a.execFetchApi=a.execFetchApi.bind(Object(p.a)(Object(p.a)(a))),a.onPreviewPage=a.onPreviewPage.bind(Object(p.a)(Object(p.a)(a))),a.onUpdateLayerConfig=a.onUpdateLayerConfig.bind(Object(p.a)(Object(p.a)(a))),a.onToggleLayer=a.onToggleLayer.bind(Object(p.a)(Object(p.a)(a))),a.onGeneratePage=a.onGeneratePage.bind(Object(p.a)(Object(p.a)(a))),a.onUpdateLayoutConfig=a.onUpdateLayoutConfig.bind(Object(p.a)(Object(p.a)(a))),a.layoutIndex=0,a.container=o.a.createRef(),a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"onUpdateLayoutConfig",value:function(e){var t=e.layoutIndex,a=e.configs,n=e.deleteFlag,o=void 0!==n&&n,i=this.state.layoutConfig.slice();if(o){var l=i.findIndex(function(e){return e.layoutIndex===t});i.splice(l,1)}else{i.find(function(e){return e.layoutIndex===t}).configs=a}"function"===typeof this.props.onUpdateLayoutConfig&&this.props.onUpdateLayoutConfig(i),this.setState({layoutConfig:i})}},{key:"componentDidMount",value:function(){var e=this.props.preview;!(void 0!==e&&e)&&this.container&&this.container.current&&this.container.current.addEventListener("drop",this.onDrop,!1)}},{key:"componentWillUnmount",value:function(){var e=this.props.preview;!(void 0!==e&&e)&&this.container&&this.container.current&&this.container.current.removeEventListener("drop",this.onDrop)}},{key:"onDrop",value:function(e){e.preventDefault(),e.stopPropagation();var t=JSON.parse(e.dataTransfer.getData("text/plain")),a=t.type,n=Object(S.a)(t,["type"]);if(e.target.className&&-1!==e.target.className.indexOf("main-container"))if(we(a)){var o=this.state.layoutConfig.slice(),i=Object.assign({type:a,layoutIndex:this.layoutIndex,configs:Object.assign({},n)});o.push(i),this.setState({layoutConfig:o}),this.layoutIndex+=1}else k.a.warn("\u8bf7\u62d6\u62fd\u5bb9\u5668\u7ec4\u4ef6")}},{key:"execFetchApi",value:function(e,t){var a=this,n=this.state.layerConfig.apiArr.find(function(t){return t.requestApi===e});if(n){var o=n.modelKey,i=n.requestHost,l=n.requestMethod,r=n.requestPagination;if(this.toggleLoading(),"1"===r){1!==this.state.PageIndex&&this.setState({PageIndex:1});var c=this.state.PageSize;t.PageIndex=1,t.PageSize=c}return this.paramData[o]=t,this.props.service.fetchApi(i,l,e,t).then(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.data;if(200===e.status){var n=t||{},i=n.code,l=n.message,r=n.data;if("0"!==i)k.a.error(l||"\u8c03\u7528\u63a5\u53e3\u5f02\u5e38");else{var c,s=r.total,d=r.list;a.setState({apiData:(c={},Object(j.a)(c,o,d),Object(j.a)(c,"".concat(o,"Total"),s),c)})}}else{var u=(t||{}).message;k.a.error(u||"\u8c03\u7528\u63a5\u53e3\u5f02\u5e38")}return a.toggleLoading(!1),Promise.resolve(e)}).catch(function(e){return a.toggleLoading(!1),e.response?401===e.response.status?(k.a.error("\u767b\u5f55\u4fe1\u606f\u8fc7\u671f\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55"),a.props.onShowLoginModal()):403===e.response.status&&k.a.error(e.response.data.message):k.a.error(JSON.stringify(e)),Promise.reject(e)})}k.a.warn("api\u914d\u7f6e\u53c2\u6570\u6709\u8bef")}},{key:"toggleLoading",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.setState({fetchLoading:e})}},{key:"onPageIndexChange",value:function(e,t,a){var n=this;this.setState({PageIndex:e},function(){n.execTableQuery(a)})}},{key:"onShowSizeChange",value:function(e,t,a){var n=this;this.setState({PageIndex:1,PageSize:t},function(){n.execTableQuery(a)})}},{key:"execTableQuery",value:function(e){if(this.apiConfig[e]){var t=this.state,a=t.PageIndex,n=t.PageSize,o=this.paramData[e],i=this.apiConfig[e],l=i.host,r=i.method,c=i.api;this.execFetchApi(e,l,r,c,Object.assign(o,{PageIndex:a,PageSize:n}))}else k.a.warn("\u8bf7\u914d\u7f6eTable\u7684modelKey")}},{key:"onGeneratePage",value:function(){var e=this,t=this.props,a=t.pageName,n=t.onShowPageNameModal;if(a){var o=this.state,i=o.layoutConfig,l=void 0===i?[]:i,r=o.layerConfig,c={pageName:a,layoutConfig:l,layerConfig:void 0===r?{}:r};this.setState({generateLoading:!0}),this.props.service.generatePage(c).then(function(t){var a=t.data;"0"==a.code?k.a.success(a.info):k.a.error(a.info),e.setState({generateLoading:!1})}).catch(function(){k.a.error("\u8bf7\u6c42\u5931\u8d25"),e.setState({generateLoading:!1})})}else n()}},{key:"onPreviewPage",value:function(){var e=this.props.onPreviewPage,t=this.state;e(t.layoutConfig,t.layerConfig)}},{key:"onToggleLayer",value:function(){this.setState({showLayer:!this.state.showLayer})}},{key:"onUpdateLayerConfig",value:function(e){this.setState({layerConfig:e})}},{key:"onUpdateApiConfig",value:function(e,t){this.apiConfig[e]=t}},{key:"getChildFuncProps",value:function(){return{execFetchApi:this.execFetchApi,onPageIndexChange:this.onPageIndexChange,onShowSizeChange:this.onShowSizeChange,onUpdateApiConfig:this.onUpdateApiConfig,onUpdateLayoutConfig:this.onUpdateLayoutConfig}}},{key:"onShowModal",value:function(e,t,a,n){var o,i=(o={},Object(j.a)(o,"show".concat(t),!0),Object(j.a)(o,"api",a),Object(j.a)(o,"recordData",n),o);this.setState(Object(x.a)({},i))}},{key:"onCancelModal",value:function(e){var t;this.setState((t={},Object(j.a)(t,"show".concat(e),!1),Object(j.a)(t,"recordData",null),Object(j.a)(t,"api",""),t))}},{key:"onOkModal",value:function(e,t,a){return this.execFetchApi(t,a)}},{key:"renderModal",value:function(){var e=this,t=this.state,a=t.layerConfig,n=t.recordData,i=t.api,l=a.modalArr;return(void 0===l?[]:l).map(function(t){var l=t.name,r=t.title,c=t.width,s=t.layoutConfig,d="show".concat(l),u=e.state[d],p={api:i,width:parseInt(c),title:r,visible:u,recordData:n,layerConfig:a,modalName:l,layoutConfig:e.state.layoutConfig,modalLayoutConfig:s,execFetchApi:e.execFetchApi};return u&&(p.mode=n||i?"edit":"add"),o.a.createElement(zt,Object.assign({},p,{key:"".concat(r,"-").concat(l),onCancelModal:e.onCancelModal,onOkModal:e.onOkModal}))})}},{key:"render",value:function(){var e=this.props,t=e.noLayer,a=void 0!==t&&t,i=e.onShowLoginModal,l=e.preview,r=void 0!==l&&l,c=this.state,s=c.layoutConfig,d=c.generateLoading,u=c.showLayer,p=c.layerConfig,m=c.fetchLoading,g=c.apiData,f=c.PageIndex,b=c.PageSize;return o.a.createElement(n.Fragment,null,o.a.createElement(I.a,{spinning:m},o.a.createElement("div",{className:"main-container border-box ".concat(r?"preview-mode":""),ref:this.container},o.a.createElement(St,Object.assign({onShowLoginModal:i,layoutConfig:s,layerConfig:p,currentPage:f,pageSize:b,apiData:g,context:this,preview:r},this.getChildFuncProps())),r&&a?null:o.a.createElement(C.a,{type:"primary",shape:"round",icon:"plus",size:"large",className:"btn-manage",onClick:this.onToggleLayer,title:"\u5f39\u51fa\u5c42&\u63a5\u53e3\u7f16\u8f91"}),o.a.createElement(Rt,{visible:u,onCloseLayer:this.onToggleLayer,onUpdateLayerConfig:this.onUpdateLayerConfig,layerConfig:p}))),r&&a?null:o.a.createElement(n.Fragment,null,o.a.createElement(C.a,{id:"btn-code",type:"primary",onClick:this.onGeneratePage,loading:d},"\u751f\u6210\u9875\u9762"),o.a.createElement(C.a,{type:"primary",onClick:this.onPreviewPage,style:{marginLeft:"5px"}},"\u9884\u89c8")),this.renderModal())}}],[{key:"getDerivedStateFromProps",value:function(e){return e.visible?{layerConfig:e.layerConfig,layoutConfig:e.layoutConfig}:Object.hasOwnProperty.call(e,"layerConfig")?{layerConfig:e.layerConfig}:null}}]),t}(n.PureComponent))||L),Jt=(a(398),f.a.Sider),Gt=f.a.Content,Wt=function(e){function t(){return Object(r.a)(this,t),Object(s.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.showModal,a=e.layoutConfig,n=e.onCloseModal,i=e.layerConfig;return o.a.createElement(h.a,{visible:t,footer:null,width:"100%",closable:!0,centered:!0,wrapClassName:"preview-page-modal",onCancel:n,title:"\u9875\u9762\u9884\u89c8",maskClosable:!0},o.a.createElement("div",{className:"preview-container"},o.a.createElement(f.a,null,o.a.createElement(Jt,{width:"210"}),o.a.createElement(f.a,null,o.a.createElement(Gt,null,o.a.createElement(Kt,{visible:t,layoutConfig:a,layerConfig:i,preview:!0,noLayer:!0}))))))}}]),t}(n.Component),Yt=(a(399),v.a.create()(N=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(s.a)(this,Object(d.a)(t).call(this,e))).state={showLoginFrame:!1},a.onSubmit=a.onSubmit.bind(Object(p.a)(Object(p.a)(a))),a.onResetModal=a.onResetModal.bind(Object(p.a)(Object(p.a)(a))),a.getIframeUrl=a.getIframeUrl.bind(Object(p.a)(Object(p.a)(a))),a.asyncAppendJs=a.asyncAppendJs.bind(Object(p.a)(Object(p.a)(a))),a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"onSubmit",value:function(e){var t=this;e.preventDefault(),this.props.form.validateFields(function(e,a){e||t.asyncAppendJs(a.appUrl)})}},{key:"componentDidMount",value:function(){var e=this;window.addEventListener("message",function(t){if(t.origin===F){var a=e.props.form.getFieldValue("appUrl"),n="";if(a.indexOf("?")>0&&a.indexOf("MerchantId=")>0){var o=a.slice(a.indexOf("?")+1).split("&").find(function(e){return e.indexOf("MerchantId=")>=0});o&&(n=o.split("=")[1])}localStorage.setItem("access_token",t.data),localStorage.setItem("MerchantId",n),localStorage.setItem("appUrl",a),k.a.success("\u767b\u5f55\u6210\u529f"),e.props.onCloseLoginModal()}},!1)}},{key:"clearStorage",value:function(){["access_token","MerchantId","appUrl","common","main","webapi"].forEach(function(e){localStorage.removeItem(e)})}},{key:"componentDidUpdate",value:function(){this.props.visible&&!this.clearInit&&(this.clearInit=!0,this.clearStorage())}},{key:"asyncAppendJs",value:function(e){var t=this,a=document.createElement("script");a.type="text/javascript",a.onload=function(e){window.configs&&(localStorage.setItem("common",window.configs.host.common),localStorage.setItem("main",window.configs.host.main),localStorage.setItem("webapi",window.configs.host.webapi),t.setState({showLoginFrame:!0},function(){t.sendMessageToIframe()}))};var n=e;e.indexOf("?")&&(n=e.slice(0,e.indexOf("?")-1)),a.src="".concat(n,"/resources/js/configs.js?time=").concat(Date.now()),document.body.appendChild(a)}},{key:"sendMessageToIframe",value:function(){var e=this,t=document.createElement("iframe");t.src=this.getIframeUrl(),t.id="login-app",document.querySelector(".iframe-container").appendChild(t),t.onload=function(){var t=Object.assign({appUrl:e.props.form.getFieldValue("appUrl")},window.configs);document.getElementById("login-app").contentWindow.postMessage(t,F)}}},{key:"onResetModal",value:function(){this.props.form.resetFields(),this.clearInit=!1,this.setState({showLoginFrame:!1})}},{key:"getIframeUrl",value:function(){if(window.configs){var e=window.configs.host.passport.auth;return"".concat(F,"/appLogin?authUrl=").concat(encodeURIComponent(e))}return"".concat(F,"/appLogin")}},{key:"render",value:function(){var e=this.props,t=e.visible,a=e.form,n=e.onCloseLoginModal,i=a.getFieldDecorator,l=this.state.showLoginFrame;return o.a.createElement(h.a,{title:"\u767b\u5f55",visible:t,width:"500px",wrapClassName:"login-modal",onCancel:n,afterClose:this.onResetModal,maskClosable:!1,footer:null},o.a.createElement("div",{className:"login-wrapper ".concat(l?"slide-l":"")},o.a.createElement("div",{className:"url-container"},o.a.createElement(v.a,{onSubmit:this.onSubmit},o.a.createElement(v.a.Item,null,i("appUrl",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5e94\u7528url"},{type:"url",message:"url\u683c\u5f0f\u4e0d\u5408\u6cd5"}]})(o.a.createElement(y.a,{placeholder:"\u8bf7\u8f93\u5165\u5e94\u7528url"}))),o.a.createElement("p",{className:"btn-box"},o.a.createElement(C.a,{type:"primary",htmlType:"submit"},"\u786e\u5b9a")))),o.a.createElement("div",{className:"iframe-container"})))}}]),t}(n.PureComponent))||N),_t=f.a.Sider,Qt=f.a.Content,$t=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(s.a)(this,Object(d.a)(t).call(this,e))).state={showLoginModal:!1,showEditNameModal:!1,showPreviewModal:!1,pageName:""},a.onPreviewPage=a.onPreviewPage.bind(Object(p.a)(Object(p.a)(a))),a.onShowLoginModal=a.onShowLoginModal.bind(Object(p.a)(Object(p.a)(a))),a.onCloseLoginModal=a.onCloseLoginModal.bind(Object(p.a)(Object(p.a)(a))),a.onClosePreviewModal=a.onClosePreviewModal.bind(Object(p.a)(Object(p.a)(a))),a.onShowPageNameModal=a.onShowPageNameModal.bind(Object(p.a)(Object(p.a)(a))),a.onClosePageNameModal=a.onClosePageNameModal.bind(Object(p.a)(Object(p.a)(a))),a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){Ie()||this.onShowLoginModal()}},{key:"onCloseLoginModal",value:function(){this.setState({showLoginModal:!1})}},{key:"onShowLoginModal",value:function(){this.setState({showLoginModal:!0})}},{key:"onShowPageNameModal",value:function(){this.setState({showEditNameModal:!0})}},{key:"onClosePageNameModal",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.setState({showEditNameModal:!1,pageName:e},function(){e&&document.querySelector("#btn-code").click()})}},{key:"onClosePreviewModal",value:function(){this.setState({showPreviewModal:!1})}},{key:"onPreviewPage",value:function(e,t){this.setState({showPreviewModal:!0}),this.layoutConfig=e,this.layerConfig=t}},{key:"render",value:function(){var e=this.state,t=e.showEditNameModal,a=e.showPreviewModal,n=e.pageName,i=e.showLoginModal;return o.a.createElement("div",{className:"App"},o.a.createElement(b.a,{locale:g.a},o.a.createElement(f.a,null,o.a.createElement(_t,{width:"300"},o.a.createElement(Dt,null)),o.a.createElement(f.a,null,o.a.createElement(Qt,null,o.a.createElement(Kt,{pageName:n,onShowLoginModal:this.onShowLoginModal,onShowPageNameModal:this.onShowPageNameModal,onPreviewPage:this.onPreviewPage}))),o.a.createElement(E,{onCloseModal:this.onClosePageNameModal,visible:t}),o.a.createElement(Wt,{layoutConfig:this.layoutConfig,layerConfig:this.layerConfig,onCloseModal:this.onClosePreviewModal,showModal:a}),o.a.createElement(Yt,{visible:i,onCloseLoginModal:this.onCloseLoginModal}))))}}]),t}(n.Component);l.a.render(o.a.createElement($t,null),document.getElementById("root"))}},[[199,1,2]]]);
//# sourceMappingURL=main.5ca238bf.chunk.js.map