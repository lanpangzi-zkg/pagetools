(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1294:function(e,t,a){},1295:function(e,t,a){},1296:function(e,t,a){},1297:function(e,t,a){},1298:function(e,t,a){},1299:function(e,t,a){},1300:function(e,t,a){},1301:function(e,t,a){},1302:function(e,t,a){},1303:function(e,t,a){},1304:function(e,t,a){},1305:function(e,t,a){},1306:function(e,t,a){},1307:function(e,t,a){},1308:function(e,t,a){},1309:function(e,t,a){},1310:function(e,t,a){},1311:function(e,t,a){},1312:function(e,t,a){},1316:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),i=a(10),l=a.n(i),r=(a(612),a(613),a(20)),c=a(19),s=a(23),u=a(21),d=a(22),m=a(7),p=a(602),h=a.n(p),f=a(1333),b=a(1327),g=a(1332),v=a(1329),y=a(1331),C=a(84),O=(a(614),function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).afterClose=a.afterClose.bind(Object(m.a)(Object(m.a)(a))),a.onSubmit=a.onSubmit.bind(Object(m.a)(Object(m.a)(a))),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"onSubmit",value:function(e){e&&e.preventDefault();var t=this.props,a=t.form,n=t.onOkModal;a.validateFields(function(e,t){if(!e){var a=t.pageName,o=t.projectDir;n(a,o)}})}},{key:"afterClose",value:function(){this.props.form.resetFields()}},{key:"render",value:function(){var e=this.props,t=e.visible,a=e.form,n=e.onCloseModal,i=a.getFieldDecorator;return o.a.createElement(g.a,{visible:t,footer:null,width:450,closable:!0,centered:!0,afterClose:this.afterClose,onOk:this.onSubmit,onCancel:n,title:"\u9875\u9762\u540d\u79f0",maskClosable:!0},o.a.createElement(v.a,{onSubmit:this.onSubmit,style:{padding:"20px 40px"}},o.a.createElement(v.a.Item,null,i("pageName",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u9875\u9762\u540d\u79f0!"},{pattern:/^[a-zA-Z]+$/,message:"\u540d\u79f0\u53ea\u80fd\u5305\u542b\u5b57\u6bcd\uff01"}]})(o.a.createElement(y.a,{placeholder:"\u53ea\u80fd\u5305\u542b\u5b57\u6bcd"}))),window.ipcRenderer?o.a.createElement(v.a.Item,null,i("projectDir",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u9879\u76ee\u6587\u4ef6\u5939!"}]})(o.a.createElement(y.a,{placeholder:"\u9879\u76ee\u6587\u4ef6\u5939"}))):null,o.a.createElement(v.a.Item,{style:{marginTop:"15px",textAlign:"center"}},o.a.createElement(C.a,{type:"primary",htmlType:"submit"},"\u786e\u5b9a"))))}}]),t}(n.Component)),E=v.a.create()(O),j=a(58),x=a(32),k=a(43),S=a(1325),I=a(1326),w=a(121),A=a.n(w),D="HeaderContainer",T="modal",F="api",P="https://pagetools.herokuapp.com";A.a.interceptors.response.use(function(e){return e},function(e){return Promise.reject(e)});var L={AppService:function(){function e(){Object(r.a)(this,e)}return Object(c.a)(e,[{key:"generatePage",value:function(e){return A()({method:"POST",url:"".concat(P,"/generatePage"),data:e})}},{key:"fetchApi",value:function(e,t,a,n){return A()({method:"post",url:"".concat(P,"/fetchApi"),data:{host:e,method:t,api:a,params:n,appUrl:localStorage.getItem("appUrl"),access_token:localStorage.getItem("access_token"),MerchantId:localStorage.getItem("MerchantId")}})}}]),e}()};var M,N,U,V=a(159),R=a(18),B=a(1324),q=a(1334),z=a(1323),K=a(1339),H=a(1328),Y=a(363),G=a(1337),J=a(1336),W=(a(713),function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).onDelete=a.onDelete.bind(Object(m.a)(Object(m.a)(a))),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"onDelete",value:function(){(0,this.props.onUpdateLayoutConfig)({deleteFlag:!0})}},{key:"render",value:function(){return o.a.createElement("div",{className:"fulu-cell-box line-box"},o.a.createElement(z.a,null),o.a.createElement(R.a,{type:"close",className:"delete-line",onClick:this.onDelete}))}}]),t}(n.PureComponent)),_=a(603),Q=a(1330),$=a(1335),Z={labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}},X=a(95),ee=(a(599),a(1338),function(e,t,a){var i=t.operationArr,l=void 0===i?[]:i,r=t.columns.slice();return Object.keys(e).forEach(function(t){var a=e[t];if(t.indexOf("-")>0){var n=t.split("-"),o=Object(X.a)(n,2),i=o[0],l=o[1],c=r.find(function(e){return e.index===+l});c&&(c[i]=a,"width"!==i||a||delete c.width,"fixed"===i&&(c[i]="1"===a),delete e[t])}}),"1"===e.hasOperation?function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2?arguments[2]:void 0,i=null;return e.length>0&&"\u64cd\u4f5c"===e[e.length-1].title?i=e[e.length-1]:(i={title:"\u64cd\u4f5c",dataIndex:"operation"},e.push(i)),i.render=function(e,i){return Array.isArray(t)?o.a.createElement(n.Fragment,null,t.map(function(e,n){var l=e.opText,r=e.opType,c=e.modalName,s=e.api,u=void 0===s?"":s,d=e.skipUrl,m={};return m.onClick="edit"===r||"view"===r?function(e){a.onShowModal(e,c,u,i)}:"skip"===r?function(e){window.location=d}:function(e){a.props.execFetchApi(u,i)},o.a.createElement(o.a.Fragment,null,o.a.createElement("a",Object.assign({href:"javascript:;",key:"op-".concat(n)},m),l),n!==t.length-1?o.a.createElement(z.a,{type:"vertical"}):null)})):null},e}(r,l,a):(r.length>0&&"1"===r[0].sortIndex&&(r[0].render=function(e,t){return o.a.createElement("span",null,t+1)}),r)}),te=function(e,t,a){var n={columns:ee(e,t,a)};return Object.keys(e).forEach(function(t){var o=e[t];"pagination"===t?"1"===o?n.pagination={pageSize:e.pageSize,pageSizeOptions:e.pageSizeOptions.split(",")}:n[t]="1"===o:"rowSelection"===t?"1"===o?(n.rowSelection={type:e.type,onChange:function(e,t){a.setState({selectedRowKeys:e,selectedRows:t})}},"radio"===e.type&&(n.rowSelection.columnTitle=e.columnTitle)):n[t]=null:n[t]=o}),n},ae=a(604),ne=a(11),oe=a.n(ne),ie=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD";return e&&e.format?e.format(t):e},le=function(e,t,a){var n=a?[]:{};return Object.keys(e).forEach(function(o){var i=o;if(a){if(o.indexOf("-")>0){var l=o.split("-"),r=Object(X.a)(l,2),c=r[0],s=r[1];if(ce(i=c,t)){var u,d=se(function(e){return e.index===s},n);if(d)d[i]=e[o];else n.push((u={},Object(j.a)(u,i,e[o]),Object(j.a)(u,"index",s),u))}}}else ce(i,t)&&(n[i]=e[o])}),n},re=function(e,t,a){var n={};return t.forEach(function(t){var o="".concat(t,"-").concat(a);Object.hasOwnProperty.call(e,o)&&(n[t]=e[o],delete e[o])}),n},ce=function(e,t){return!!se(e,t)},se=function(e,t){var a="function"===typeof e;return t.find(function(t){return a?e(t):t.key===e})},ue=function(e,t){var a=t.formType,n=t.queryApi,o=t.addApi,i=t.editApi;return"query"===a?n:"add"===e?o:i},de=function(e,t){return e.formItemArr.forEach(function(e){var a=e.type,n=e.name,o=e.dateKeys,i=e.format;if("DatePicker"===a)t[n]=ie(t[n],i);else if("RangePicker"===a&&Array.isArray(t[n])&&t[n].length>0){var l=Object(X.a)(t[n],2),r=l[0],c=l[1],s=o.split(","),u=Object(X.a)(s,2),d=u[0],m=u[1];t[d]=ie(r,i),t[m]=ie(c,i),delete t[n]}}),t},me=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"query";return pe(e).find(function(e){var a=e.formType;return t===a})},pe=function(e){return e.reduce(function(e,t){var a=t.type,n=t.cellsArr;return Array.isArray(n)&&n.length>0?e.push.apply(e,Object(ae.a)(me({layoutConfig:n}))):"FormContainer"===a&&e.push(t),e},[])},he=(a(1294),Q.a.Panel),fe=B.a.Option,be={labelCol:{xs:{span:24},sm:{span:10}},wrapperCol:{xs:{span:24},sm:{span:14}}},ge=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={configs:e.configs},a.setColumnMaxIndex(e),a.onSubmit=a.onSubmit.bind(Object(m.a)(Object(m.a)(a))),a.onAddColumn=a.onAddColumn.bind(Object(m.a)(Object(m.a)(a))),a.onDeleteColumn=a.onDeleteColumn.bind(Object(m.a)(Object(m.a)(a))),a.onAddOperation=a.onAddOperation.bind(Object(m.a)(Object(m.a)(a))),a.onDeleteOperation=a.onDeleteOperation.bind(Object(m.a)(Object(m.a)(a))),a.renderOperationBtn=a.renderOperationBtn.bind(Object(m.a)(Object(m.a)(a))),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e){e.visible!==this.props.visible&&e.visible&&(this.setState({configs:e.configs}),this.setColumnMaxIndex(e),this.setOperationMaxIndex(e))}},{key:"setColumnMaxIndex",value:function(e){var t=e.configs.columns,a=void 0===t?[]:t;this.columnMaxIndex=a.length||0}},{key:"setOperationMaxIndex",value:function(e){var t=e.configs.operationArr,a=void 0===t?[]:t;this.operationMaxIndex=a.length||0}},{key:"addColumnMaxIndex",value:function(){this.columnMaxIndex+=1}},{key:"addOperationMaxIndex",value:function(){this.operationMaxIndex+=1}},{key:"onAddOperation",value:function(){var e=this.state.configs.operationArr,t=(void 0===e?[]:e).slice(),a=this.operationMaxIndex;t.push({opText:"\u64cd\u4f5c",index:a}),this.setState({configs:this.getNewConfigs("operationArr",t)}),this.addOperationMaxIndex()}},{key:"onAddColumn",value:function(){var e=this.state.configs.columns.slice(),t=this.columnMaxIndex;e.push({title:"column".concat(t),dataIndex:"dataIndex".concat(t),index:t}),this.setState({configs:this.getNewConfigs("columns",e)}),this.addColumnMaxIndex()}},{key:"onDeleteOperation",value:function(e){var t=this.state.configs,a=t.operationArr.reduce(function(t,a){return a.index!==e&&t.push(Object.assign({},a)),t},[]);Object.assign({},t).operationArr=a,this.setState({configs:this.getNewConfigs("operationArr",a)})}},{key:"onDeleteColumn",value:function(e){var t=this.state.configs,a=t.columns.reduce(function(t,a){return a.index!==e&&t.push(Object.assign({},a)),t},[]);Object.assign({},t).columns=a,this.setState({configs:this.getNewConfigs("columns",a)})}},{key:"getNewConfigs",value:function(e,t){var a=this.state.configs,n=Object.assign({},a);return n[e]=t,n}},{key:"onSubmit",value:function(e){var t=this;e.preventDefault();var a=this.props,n=a.context,o=a.form,i=a.onUpdateLayoutConfig;o.validateFields(function(e,a){if(!e){var o=t.state.configs,l=[];if("1"===a.hasOperation)for(var r=o.operationArr,c=void 0===r?[]:r,s=["opText","opType","modalName","modalData","api","skipUrl"],u=0;u<c.length;u++){var d=c[u].index;l.push(Object.assign(c[u],re(a,s,d)))}var m=te(a,o,n);m.operationArr=l,delete m.pageSize,delete m.pageSizeOptions,delete m.type,delete m.columnTitle,i(m)}})}},{key:"renderPanelHeader",value:function(e){var t=this,a=e.title,n=e.index;return o.a.createElement("div",{className:"panel-header"},o.a.createElement("span",{className:"title"},a),o.a.createElement(R.a,{type:"close",className:"btn-delete",onClick:function(){t.onDeleteColumn(n)}}))}},{key:"renderOperationHeader",value:function(e){var t=this,a=e.opText,n=e.index;return o.a.createElement("div",{className:"panel-header"},o.a.createElement("span",{className:"title"},a),o.a.createElement(R.a,{type:"close",className:"btn-delete",onClick:function(){t.onDeleteOperation(n)}}))}},{key:"renderCollapse",value:function(){var e=this,t=this.props.form,a=this.state.configs.columns,n=void 0===a?[]:a,i=t.getFieldDecorator;return o.a.createElement(Q.a,null,n.map(function(t,a){var l=t.title,r=t.index,c=t.dataIndex,s=t.width,u=t.sortIndex,d=t.align,m=void 0===d?"left":d,p=t.fixed,h=void 0!==p&&p;return"\u64cd\u4f5c"===l&&a===n.length-1?null:o.a.createElement(he,{header:e.renderPanelHeader(t),key:"".concat(l,"-").concat(r)},o.a.createElement(v.a.Item,Object.assign({label:"title"},Z),i("title-".concat(r),{rules:[{required:!0,message:"\u8bf7\u8f93\u5165title!"}],initialValue:l})(o.a.createElement(y.a,null))),o.a.createElement(v.a.Item,Object.assign({label:"dataIndex"},Z),i("dataIndex-".concat(r),{rules:[{required:!0,message:"dataIndex!"}],initialValue:c})(o.a.createElement(y.a,null))),o.a.createElement(v.a.Item,Object.assign({label:"width"},Z),i("width-".concat(r),{initialValue:s||""},{rules:[{pattern:/^\d+(%)?$/,message:"\u8bf7\u8f93\u5165\u6570\u5b57\u6216\u8005\u767e\u5206\u6bd4!"}]})(o.a.createElement(y.a,null))),0===a?o.a.createElement(v.a.Item,Object.assign({label:"\u5e8f\u53f7\u5217"},Z),i("sortIndex-".concat(r),{initialValue:u})(o.a.createElement(B.a,{placeholder:"\u662f\u5426\u663e\u793a\u5e8f\u53f7"},o.a.createElement(fe,{value:"0"},"false"),o.a.createElement(fe,{value:"1"},"true")))):null,o.a.createElement(v.a.Item,Object.assign({label:"align"},Z),i("align-".concat(r),{initialValue:m})(o.a.createElement(B.a,null,o.a.createElement(fe,{value:"left"},"left"),o.a.createElement(fe,{value:"right"},"right"),o.a.createElement(fe,{value:"center"},"center")))),o.a.createElement(v.a.Item,Object.assign({label:"fixed"},Z),i("fixed-".concat(r),{initialValue:h?"1":"0"})(o.a.createElement(B.a,null,o.a.createElement(fe,{value:"0"},"false"),o.a.createElement(fe,{value:"1"},"true")))))}))}},{key:"renderOperationBtn",value:function(e){var t=this.props,a=t.form,n=t.layerConfig,i=a.getFieldDecorator,l=e.index,r=e.opText,c=e.opType,s=e.modalName,u=e.modalData,d=e.api,m=e.skipUrl,p=a.getFieldValue("opType-".concat(l));return o.a.createElement(he,{header:this.renderOperationHeader(e),key:"op-".concat(l)},o.a.createElement(v.a.Item,Object.assign({label:"\u6587\u5b57"},Z),i("opText-".concat(l),{initialValue:r})(o.a.createElement(y.a,null))),o.a.createElement(v.a.Item,Object.assign({label:"\u7c7b\u578b"},Z),i("opType-".concat(l),{initialValue:c})(o.a.createElement(B.a,null,o.a.createElement(fe,{value:"edit"},"\u7f16\u8f91(\u5f39\u7a97)"),o.a.createElement(fe,{value:"view"},"\u67e5\u770b(\u5f39\u7a97)"),o.a.createElement(fe,{value:"delete"},"\u5220\u9664"),o.a.createElement(fe,{value:"skip"},"\u8df3\u8f6c")))),"edit"===p||"view"===p?gt(n,a,s,l):null,"edit"===p||"view"===p?o.a.createElement(v.a.Item,Object.assign({label:"\u6570\u636e\u6765\u6e90"},Z),i("modalData-".concat(l),{rules:[{required:!0,message:"\u9009\u62e9\u6570\u636e\u6765\u6e90"}],initialValue:u})(o.a.createElement(B.a,null,o.a.createElement(fe,{value:"table"},"\u8868\u683c"),o.a.createElement(fe,{value:"api"},"\u63a5\u53e3\u8c03\u7528")))):null,"skip"===p?o.a.createElement(v.a.Item,Object.assign({label:"\u8def\u5f84\u5730\u5740"},Z),i("skipUrl-".concat(l),{rules:[{required:!0,message:"\u8f93\u5165\u8def\u5f84\u5730\u5740"}],initialValue:m})(o.a.createElement(y.a,null))):null,"api"===a.getFieldValue("modalData-".concat(l))||"delete"===p?vt(n,a,{initialValue:d,key:l}):null)}},{key:"renderTableProps",value:function(){var e=this.props.form,t=this.state.configs,a=e.getFieldDecorator,i=t.operationArr,l=void 0===i?[]:i,r=t.pagination,c=t.rowSelection,s=t.hasOperation,u=void 0===s?"0":s,d=t.rowKey,m=r||{},p=m.pageSize,h=void 0===p?10:p,f=m.pageSizeOptions,b=void 0===f?"10,20,30":f,g=c||{},O=g.type,E=void 0===O?"checkbox":O,j=g.columnTitle,x=void 0===j?"\u9009\u62e9":j,k=Object.keys(r||{}).length>0?"1":"0",S=Object.keys(c||{}).length>0?"1":"0";return o.a.createElement(n.Fragment,null,o.a.createElement(v.a.Item,Object.assign({label:"\u64cd\u4f5c\u5217"},Z),a("hasOperation",{initialValue:u})(o.a.createElement(B.a,null,o.a.createElement(fe,{value:"0"},"\u65e0"),o.a.createElement(fe,{value:"1"},"\u6709")))),"1"===e.getFieldValue("hasOperation")?[o.a.createElement(Q.a,{key:"op-collapse"},l.map(this.renderOperationBtn)),o.a.createElement(n.Fragment,{key:"op-collapse-btns"},"1"===e.getFieldValue("hasOperation")?o.a.createElement("div",{className:"btn-add-box"},o.a.createElement(C.a,{type:"dashed",size:"large",onClick:this.onAddOperation},"\u6dfb\u52a0\u64cd\u4f5c\u9879")):null)]:null,o.a.createElement(v.a.Item,Object.assign({label:"pagination"},Z),a("pagination",{initialValue:k})(o.a.createElement(B.a,null,o.a.createElement(fe,{value:"0"},"false"),o.a.createElement(fe,{value:"1"},"true")))),o.a.createElement(v.a.Item,Object.assign({label:"rowKey"},Z),a("rowKey",{initialValue:d})(o.a.createElement(y.a,null))),"1"===e.getFieldValue("pagination")?o.a.createElement($.a,{title:"pagination\u914d\u7f6e"},o.a.createElement(v.a.Item,Object.assign({label:"pageSize"},Z),a("pageSize",{initialValue:h})(o.a.createElement(y.a,null))),o.a.createElement(v.a.Item,Object.assign({label:"pageSizeOptions"},be),a("pageSizeOptions",{initialValue:Array.isArray(b)?b.join(","):b})(o.a.createElement(B.a,null,o.a.createElement(fe,{value:"10,20,30"},"10,20,30"),o.a.createElement(fe,{value:"10,20,30,40"},"10,20,30,40"),o.a.createElement(fe,{value:"20,30,40"},"20,30,40"))))):null,o.a.createElement(v.a.Item,Object.assign({label:"rowSelection"},Z),a("rowSelection",{initialValue:S})(o.a.createElement(B.a,null,o.a.createElement(fe,{value:"0"},"false"),o.a.createElement(fe,{value:"1"},"true")))),"1"===e.getFieldValue("rowSelection")?o.a.createElement($.a,{title:"rowSelection\u914d\u7f6e"},o.a.createElement(v.a.Item,Object.assign({label:"type"},Z),a("type",{initialValue:E})(o.a.createElement(B.a,null,o.a.createElement(fe,{value:"checkbox"},"checkbox"),o.a.createElement(fe,{value:"radio"},"radio")))),"radio"===e.getFieldValue("type")?o.a.createElement(v.a.Item,Object.assign({label:"columnTitle"},Z),a("columnTitle",{initialValue:x})(o.a.createElement(y.a,null))):null):null)}},{key:"render",value:function(){var e=this.props,t=e.visible,a=e.onClose,n=e.onDeleteContainer,i=e.form.getFieldDecorator,l=this.state.configs.dataSrouce;return o.a.createElement(q.a,{title:"\u8868\u683c\u7f16\u8f91",maskClosable:!1,width:420,onClose:a,visible:t},o.a.createElement(v.a,{onSubmit:this.onSubmit},o.a.createElement(z.a,null,"\u8868\u5934"),this.renderCollapse(),o.a.createElement("div",{className:"btn-add-box"},o.a.createElement(C.a,{type:"dashed",size:"large",onClick:this.onAddColumn},"\u6dfb\u52a0\u8868\u5934\u5217")),o.a.createElement(z.a,null,"\u8868\u683c\u5c5e\u6027"),this.renderTableProps(),o.a.createElement(z.a,null,"\u6570\u636e\u6e90"),o.a.createElement(v.a.Item,Object.assign({label:"dataSrouce"},Z),i("modelKey",{initialValue:l})(o.a.createElement(y.a,{placeholder:"model key"}))),o.a.createElement(v.a.Item,{style:{marginTop:"20px",textAlign:"center"}},o.a.createElement(C.a,{type:"primary",htmlType:"submit",style:{marginRight:"10px"}},"\u786e\u5b9a"),o.a.createElement(C.a,{onClick:n},"\u5220\u9664\u5bb9\u5668"))))}}]),t}(n.Component),ve=v.a.create()(ge),ye=(a(1295),function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={visible:!1},a.onClose=a.onClose.bind(Object(m.a)(Object(m.a)(a))),a.onShowEditTable=a.onShowEditTable.bind(Object(m.a)(Object(m.a)(a))),a.onUpdateConfigs=a.onUpdateConfigs.bind(Object(m.a)(Object(m.a)(a))),a.onDeleteContainer=a.onDeleteContainer.bind(Object(m.a)(Object(m.a)(a))),a.onPageIndexChange=a.onPageIndexChange.bind(Object(m.a)(Object(m.a)(a))),a.onShowSizeChange=a.onShowSizeChange.bind(Object(m.a)(Object(m.a)(a))),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"onShowEditTable",value:function(){this.setState({visible:!0})}},{key:"onClose",value:function(e){e.stopPropagation(),this.setState({visible:!1})}},{key:"onUpdateConfigs",value:function(e){var t=this.props,a=t.configs,n=t.onUpdateLayoutConfig,o=a.layoutIndex;n(Object(x.a)({layoutIndex:o,type:"TableContainer"},e)),this.setState({visible:!1})}},{key:"onDeleteContainer",value:function(){var e=this.props,t=e.configs;(0,e.onUpdateLayoutConfig)({layoutIndex:t.layoutIndex,deleteFlag:!0})}},{key:"getMockDataSource",value:function(e,t){for(var a=[],n=function(t){var n={};e.forEach(function(e){Object.keys(e).forEach(function(a){n[e.dataIndex]="".concat(e.dataIndex,"-").concat(t)})}),a.push(n)},o=0;o<t;o++)n(o);return a}},{key:"getModelKey",value:function(){var e=this.props.configs;return(void 0===e?{}:e).modelKey}},{key:"onPageIndexChange",value:function(e,t){this.props.onPageIndexChange(e,t,this.getModelKey())}},{key:"onShowSizeChange",value:function(e,t){this.props.onShowSizeChange(e,t,this.getModelKey())}},{key:"getRowSelection",value:function(e,t){var a=this.props,n=a.preview,o=void 0!==n&&n,i=a.context;return e&&(e.selectedRowKeys=t,o&&(e.onChange=function(e,t){i.setState({selectedRowKeys:e,selectedRows:t})})),e}},{key:"render",value:function(){var e=this,t=this.state.visible,a=this.props,n=a.configs,i=void 0===n?{}:n,l=a.apiData,r=void 0===l?{}:l,c=a.currentPage,s=a.pageSize,u=a.context,d=a.layerConfig,m=a.preview,p=void 0!==m&&m,h=u.GuiContext,f=i.pagination,b=void 0!==f&&f,g=i.rowSelection,v=void 0===g?null:g,y=i.columns,C=void 0===y?[]:y,O=i.modelKey,E=i.mockData,j=i.rowKey,x=C.slice(),k=/^\d+$/.test(E)?+E:0,S=O&&Object.hasOwnProperty.call(r,O),I=S?r[O]:this.getMockDataSource(C,k);return b&&(b.showQuickJumper=!0,b.showSizeChanger=!0,b.current=c,b.pageSize=s,b.total=S?r["".concat(O,"Total")]:k,b.onChange=this.onPageIndexChange,b.onShowSizeChange=this.onShowSizeChange),o.a.createElement("div",{className:"table-container container ".concat(p?"preview-box":"")},o.a.createElement(h.Consumer,null,function(t){var a=t.selectedRowKeys;return o.a.createElement(_.a,{columns:x,bordered:!0,dataSource:I,pagination:b,rowSelection:e.getRowSelection(v,a),rowKey:j})}),o.a.createElement(ve,{visible:t,layerConfig:d,configs:i,context:u,onClose:this.onClose,onDeleteContainer:this.onDeleteContainer,onUpdateLayoutConfig:this.onUpdateConfigs}),p?null:o.a.createElement(R.a,{type:"form",className:"icon-operation",onClick:this.onShowEditTable}))}}]),t}(n.Component)),Ce=function(e){function t(){return Object(r.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"onUpdateConfigs",value:function(e){var t=this,a=this.props.onUpdateLayoutConfig;this.setState({configs:e},function(){a(Object(x.a)({layoutIndex:t.getContainerIndex(),type:t.getContainerType()},e))})}},{key:"onToggleEditDrawer",value:function(){this.setState({visible:!this.state.visible})}},{key:"onDeleteContainer",value:function(){(0,this.props.onUpdateLayoutConfig)({layoutIndex:this.getContainerIndex(),deleteFlag:!0}),this.onToggleEditDrawer()}},{key:"getContainerIndex",value:function(){return this.props.configs.layoutIndex}},{key:"getContainerType",value:function(){return this.props.configs.type}},{key:"_render",value:function(){return null}},{key:"render",value:function(){return this._render()}}]),t}(n.PureComponent),Oe=function(e){function t(){return Object(r.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.configs,a=void 0===t?{}:t,n=Object(k.a)(e,["configs"]),i=a.cellStyles,l=a.textAlign,r=void 0===l?"center":l,c="Button"===a.type?Object.assign({},i,{textAlign:r}):i;return o.a.createElement("div",{style:c},yt(a,n))}}]),t}(n.Component),Ee=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:";";return e?e.split(t).reduce(function(e,t){var a=t.split(":"),n=Object(X.a)(a,2),o=n[0],i=n[1];return o&&i&&(e[o]=i.replace(/['"\s]/g,"")),e},{}):{}},je=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:";";return"[object Object]"===Object.prototype.toString.call(e)?Object.keys(e).reduce(function(t,a){return t.push("".concat(a,":").concat(e[a])),t},[]).join(t):Array.isArray(e)?e.join(t):e},xe=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=0;if(t===n.length)o=24;else{for(var i=0,l=0,r=0;r<a.length;r++)if(a[r].colIndex>=e){if(0===(l%=24))i=0;else for(var c=0;c<n.length;c++)(l-=n[c])<=0&&(i=c+1,c=n.length);r=a.length}else l+=a[r].colSpan;var s,u=0;for(t<=n.length-i&&(u=i),s=u+t-1;u<=s;u++)o+=n[u]}return o},ke=["btnText","antdType","skipUrl","api","modalName"],Se=B.a.Option,Ie=Q.a.Panel,we=["import","export","edit","view","mult"],Ae=["add","edit","view"],De=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={deleteComponent:!1},a.handleSubmit=a.handleSubmit.bind(Object(m.a)(Object(m.a)(a))),a.onAddListItem=a.onAddListItem.bind(Object(m.a)(Object(m.a)(a))),a.onDeleteButton=a.onDeleteButton.bind(Object(m.a)(Object(m.a)(a))),a.onDeleteListItem=a.onDeleteListItem.bind(Object(m.a)(Object(m.a)(a))),a.onDeleteComponent=a.onDeleteComponent.bind(Object(m.a)(Object(m.a)(a))),a.renderBtnPanelHeader=a.renderBtnPanelHeader.bind(Object(m.a)(Object(m.a)(a))),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"getItemSetType",value:function(){return[]}},{key:"componentWillReceiveProps",value:function(e){var t=e.configs,a=void 0===t?{}:t,n=a.type;if(~this.getItemSetType().indexOf(n)&&!this["init".concat(n)]&&e.visible){var o=n.toLowerCase(),i="".concat(o,"Arr"),l=a[i]||[];this.setState(Object(j.a)({},i,l)),this["".concat(o,"Index")]=l.length,this["init".concat(n)]=!0}}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),e.stopPropagation();var a=this.state,n=a.deleteComponent,o=a.buttonArr,i=this.props,l=i.form,r=i.onUpdateConfigs,c=i.configs,s=i.colSpanArr,u=i.formItemArr,d=i.inForm,m=void 0!==d&&d,p=this.getItemSetType();l.validateFields(function(e,a){if(!e){var i=Object.assign({},c,a);i.cellStyles=Ee(a.cellStyles),n&&(i.deleteFlag=!0);var l=i.type;if(~p.indexOf(l)&&"Button"!==l){var d=l.toLowerCase(),h="".concat(d,"Arr"),f=t.state[h].slice();f.forEach(function(e){var t=e.index,n="".concat(d,"Label-").concat(t),o="".concat(d,"Value-").concat(t);e.label=a[n],e.value=a[o],delete i[n],delete i[o]}),i[h]=f}else if("DatePicker"===l||"RangePicker"===l){var b=a.format;i.showTime="1"===a.showTime,"DatePicker"===l&&(i.initialValue=a.initialValue&&a.initialValue.format(b))}else if("Button"===l){var g=o.slice();g.forEach(function(e){var t=e.btnIndex;if(ke.forEach(function(n){var o="".concat(n,"-").concat(t);e[n]=a[o],delete i[o]}),"expand"===e.logicType){var n="expandCount-".concat(t);e.expandCount=a[n],delete i[n]}}),i.buttonArr=g}if(m){var v=a.originSpan,y=void 0===v?1:v;i.originSpan=y,i.colSpan=xe(i.colIndex,y,u,s)}t.onCloseEdit(),r(i)}})}},{key:"onCloseEdit",value:function(){var e=this;this.getItemSetType().forEach(function(t){e["init".concat(t)]=!1}),this.initBtn=!1,this.setState({deleteComponent:!1})}},{key:"onDeleteComponent",value:function(){this.setState({deleteComponent:!0})}},{key:"onDeleteButton",value:function(e){var t=this.state.buttonArr,a=(void 0===t?[]:t).reduce(function(t,a){return a.btnIndex!==e&&t.push(a),t},[]);this.setState({buttonArr:a})}},{key:"onDeleteListItem",value:function(e,t){var a="".concat(t,"Arr"),n=this.state[a].reduce(function(t,a){return a.index!==e&&t.push(a),t},[]);this.setState(Object(j.a)({},a,n))}},{key:"onAddListItem",value:function(e){var t="".concat(e,"Arr"),a=this.state[t].slice();a.push({label:"",value:"",index:this["".concat(e,"Index")]}),this.setState(Object(j.a)({},t,a)),this["".concat(e,"Index")]+=1}},{key:"renderDefaultValueItem",value:function(){var e=this.props,t=e.configs,a=void 0===t?{}:t,n=e.form,i=a.type,l=a.initialValue,r=a.text,c=n.getFieldDecorator;if(~this.getItemSetType().indexOf(i)){var s=i.toLowerCase(),u="".concat(s,"Arr"),d=this.state[u]||[];return o.a.createElement(v.a.Item,Object.assign({},Z,{label:"initialValue"}),c("initialValue",{initialValue:l})(o.a.createElement(B.a,{allowClear:!0},d.map(function(e){var t=e.index,a=n.getFieldValue("".concat(s,"Value-").concat(t)),i=n.getFieldValue("".concat(s,"Label-").concat(t));return o.a.createElement(Se,{value:a,key:"op-".concat(t)},"".concat(a,"/").concat(i))}))))}return"DatePicker"===i?o.a.createElement(v.a.Item,Object.assign({},Z,{label:"initialValue"}),c("initialValue",{initialValue:l})(o.a.createElement(H.a,{style:{width:"100%"}}))):"Input"===i?o.a.createElement(v.a.Item,Object.assign({},Z,{label:"initialValue"}),c("initialValue",{initialValue:l})(o.a.createElement(y.a,null))):"Text"===i?o.a.createElement(v.a.Item,Object.assign({},Z,{label:"text"}),c("text",{initialValue:r})(o.a.createElement(y.a,null))):null}},{key:"renderBtnPanelHeader",value:function(e){var t=this,a=e.btnText,n=e.btnIndex;return o.a.createElement("div",{className:"panel-header"},o.a.createElement("span",{className:"title"},a),o.a.createElement(R.a,{type:"close",className:"btn-delete",onClick:function(){t.onDeleteButton(n)}}))}},{key:"renderTabs",value:function(){return this.renderItemSettingCard({title:"tab\u8bbe\u7f6e",dataKey:"tabs"})}},{key:"renderBreadcrumb",value:function(){return this.renderItemSettingCard({title:"breadcrumb\u8bbe\u7f6e",dataKey:"breadcrumb",labPlaceholder:"\u540d\u79f0",valPlaceholder:"\u8def\u5f84"})}},{key:"renderSelect",value:function(){return this.renderItemSettingCard({title:"select\u8bbe\u7f6e",dataKey:"select"})}},{key:"renderRadio",value:function(){return this.renderItemSettingCard({title:"radio\u8bbe\u7f6e",dataKey:"radio"})}},{key:"renderCheckbox",value:function(){return this.renderItemSettingCard({title:"checkbox\u8bbe\u7f6e",dataKey:"checkbox"})}},{key:"renderItemSettingCard",value:function(e){var t=this,a=e.title,i=e.dataKey,l=e.labPlaceholder,r=void 0===l?"label":l,c=e.valPlaceholder,s=void 0===c?"value":c,u=this.props.form,d="".concat(i,"Arr"),m=this.state[d]||[];return o.a.createElement($.a,{title:a,extra:o.a.createElement(R.a,{type:"plus-circle",onClick:function(){t.onAddListItem(i)}})},m.map(function(e){var a=e.label,l=e.value,c=e.index;return o.a.createElement(n.Fragment,{key:"".concat(i,"-").concat(c)},o.a.createElement(v.a.Item,{className:"half-item",key:"".concat(i,"-label-").concat(c)},u.getFieldDecorator("".concat(i,"Label-").concat(c),{initialValue:a,rules:[{required:!0,message:r}]})(o.a.createElement(y.a,{placeholder:r}))),o.a.createElement(v.a.Item,{className:"half-item",key:"".concat(i,"-value-").concat(c),style:{marginLeft:"10px"}},u.getFieldDecorator("".concat(i,"Value-").concat(c),{initialValue:l})(o.a.createElement(y.a,{placeholder:s}))),o.a.createElement(R.a,{type:"close-circle",style:{marginLeft:"6px",lineHeight:"39px"},onClick:function(){t.onDeleteListItem(c,i)}}))}))}},{key:"renderBtnExpand",value:function(e){var t=this.props.form,a=e.btnIndex,n=e.expandCount;return o.a.createElement(v.a.Item,Object.assign({key:"expandCount-".concat(a),label:"\u6298\u53e0\u53ef\u89c1\u6570"},Z),t.getFieldDecorator("expandCount-".concat(a),{rules:[{required:"true",message:"\u6298\u53e0\u53ef\u89c1\u6570"}],initialValue:n})(o.a.createElement(y.a,{placeholder:"expandCount"})))}},{key:"renderApiItem",value:function(e){var t=e.btnIndex,a=e.api,n=e.logicType,o=this.props,i=o.layerConfig,l=void 0===i?{}:i,r=o.form;return we.indexOf(n)>=0?vt(l,r,{initialValue:a,key:t}):null}},{key:"renderModalItem",value:function(e){var t=e.btnIndex,a=e.modalName,n=e.logicType,o=this.props,i=o.layerConfig,l=void 0===i?{}:i,r=o.form;return Ae.indexOf(n)>=0?gt(l,r,a,t):null}},{key:"renderBtnCard",value:function(){var e=this,t=this.props.form,a=this.state.buttonArr,n=void 0===a?[]:a,i=n.reduce(function(e,t){var a=t.btnIndex;return e.push("btn-".concat(a)),e},[]);return o.a.createElement($.a,{title:"\u6309\u94ae\u533a\u57df"},o.a.createElement(Q.a,{defaultActiveKey:i},n.map(function(a){var n=a.btnIndex,i=a.btnText,l=a.antdType,r=void 0===l?"":l,c=a.htmlType,s=void 0===c?"button":c,u=a.logicType,d=a.textDisabled,m=a.skipUrl;return o.a.createElement(Ie,{header:e.renderBtnPanelHeader(a),key:"btn-".concat(n)},o.a.createElement(v.a.Item,Object.assign({key:"btnText-".concat(n),label:"\u6309\u94ae\u6587\u5b57"},Z),t.getFieldDecorator("btnText-".concat(n),{initialValue:i,rules:[{required:!0,message:"\u6309\u94ae\u6587\u5b57"}]})(o.a.createElement(y.a,{placeholder:"\u6309\u94ae\u6587\u5b57",disabled:d}))),"expand"!==u?o.a.createElement(v.a.Item,Object.assign({key:"antdType-".concat(n),label:"type"},Z),t.getFieldDecorator("antdType-".concat(n),{initialValue:r})(o.a.createElement(B.a,{placeholder:"\u6309\u94ae\u7c7b\u578b",disabled:"submit"===s||"reset"===s},o.a.createElement(Se,{value:"primary"},"primary"),o.a.createElement(Se,{value:"dashed"},"dashed"),o.a.createElement(Se,{value:"danger"},"danger"),o.a.createElement(Se,{value:""},"none")))):null,e.renderApiItem(a),e.renderModalItem(a),"expand"===u?e.renderBtnExpand(a):null,"skip"===u?o.a.createElement(v.a.Item,Object.assign({key:"skipUrl-".concat(n),label:"\u8def\u5f84\u5730\u5740"},Z),t.getFieldDecorator("skipUrl-".concat(n),{rules:[{required:!0,message:"\u8f93\u5165\u8def\u5f84\u5730\u5740"}],initialValue:m})(o.a.createElement(y.a,null))):null)})))}}]),t}(n.Component),Te=(a(1296),B.a.Option),Fe=y.a.TextArea,Pe=function(e){function t(){return Object(r.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"getItemSetType",value:function(){return["Tabs","Breadcrumb","Button","Radio"]}},{key:"renderContent",value:function(){var e=this.props,t=e.form,a=e.configs,i=a.placeholder,l=a.type,r=t.getFieldDecorator;return this.state.deleteComponent?null:"Button"===l?this.renderBtnCard():"Breadcrumb"===l?this.renderBreadcrumb():"Tabs"===l?this.renderTabs():"Radio"===l?this.renderRadio():o.a.createElement(n.Fragment,null,this.renderDefaultValueItem(),"Text"!==l&&"Breadcrumb"!==l?o.a.createElement(v.a.Item,Object.assign({},Z,{label:"placeholder"}),r("placeholder",{initialValue:i})(o.a.createElement(y.a,null))):null)}},{key:"render",value:function(){var e=this,t=this.props,a=t.visible,n=t.onClose,i=t.form,l=t.configs,r=je(l.cellStyles),c=l.type,s=l.radioType,u=l.textAlign,d=void 0===u?"center":u;return o.a.createElement(q.a,{visible:a,maskClosable:!1,title:"\u7f16\u8f91\u7ec4\u4ef6",onClose:function(){e.onCloseEdit(),n()},width:420},o.a.createElement(v.a,{onSubmit:this.handleSubmit},o.a.createElement(v.a.Item,Object.assign({label:"style\u8bbe\u7f6e"},Z),i.getFieldDecorator("cellStyles",{initialValue:r})(o.a.createElement(Fe,{placeholder:"\u591a\u4e2a\u6837\u5f0f\u5c5e\u6027\u8bf7\u7528\u5206\u53f7\u5206\u9694"}))),"Button"===c?o.a.createElement(v.a.Item,Object.assign({label:"\u5bf9\u9f50\u65b9\u5f0f"},Z),i.getFieldDecorator("textAlign",{initialValue:d})(o.a.createElement(B.a,null,o.a.createElement(Te,{key:"left",value:"left"},"\u5de6"),o.a.createElement(Te,{key:"center",value:"center"},"\u4e2d"),o.a.createElement(Te,{key:"right",value:"right"},"\u53f3")))):null,"Radio"===c?o.a.createElement(v.a.Item,Object.assign({label:"\u7c7b\u578b"},Z),i.getFieldDecorator("radioType",{initialValue:s})(o.a.createElement(B.a,null,o.a.createElement(Te,{key:"default",value:"default"},"\u9ed8\u8ba4"),o.a.createElement(Te,{key:"tab",value:"tab"},"tab")))):null,this.renderContent(),o.a.createElement("div",{className:"btn-box"},o.a.createElement(C.a,{onClick:this.onDeleteComponent},"\u5220\u9664\u7ec4\u4ef6")),o.a.createElement("div",{className:"btn-bottom-box"},o.a.createElement(C.a,{type:"primary",htmlType:"submit"},"\u4fdd\u5b58"))))}}]),t}(De),Le=v.a.create()(Pe),Me=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=t.state.dropComponent,o=t.props.configs,i=e.type,l=Object(k.a)(e,["type"]),r={textAlign:"left"};if(n){if("Button"!==i||"Button"!==o.type)return;(r=Object.assign({},o)).buttonArr.push(Object(x.a)({btnIndex:t.btnIndex},l)),t.btnIndex+=1}else"Button"===i?(r.buttonArr=[Object(x.a)({btnIndex:t.btnIndex},l)],t.btnIndex+=1):r=Object(x.a)({},l),r.type=i;if(a&&"Button"!==r.type){var c=t.props.configs,s=c.originSpan,u=c.cellStyles,d=c.colIndex,m=c.colSpan;r.originSpan=s,r.cellStyles=u,r.colIndex=d,r.colSpan=m,r.label=i,r.name="name-".concat(d)}return r},Ne=["FormContainer","TableContainer","EmptyContainer","BoxContainer",D,"LineContainer"],Ue=function(){return!!localStorage.getItem("access_token")&&!!localStorage.getItem("webapi")},Ve=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.type,a=void 0===t?"Input":t,n=e.initialValue,o=e.format,i=void 0===o?"YYYY-MM-DD":o;return"DatePicker"===a?n&&oe()(n,i):"Checkbox"===a?[n]:n||""},Re=function(e){return Ne.indexOf(e)>-1},Be=(a(1297),"drop-container"),qe=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={configs:e.configs,showEdit:!1,dropComponent:!!e.configs.type},a.onDrop=a.onDrop.bind(Object(m.a)(Object(m.a)(a))),a.onDragenter=a.onDragenter.bind(Object(m.a)(Object(m.a)(a))),a.onToggleEdit=a.onToggleEdit.bind(Object(m.a)(Object(m.a)(a))),a.onUpdateConfigs=a.onUpdateConfigs.bind(Object(m.a)(Object(m.a)(a))),a.btnIndex=1,a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.DropDom&&!this.props.preview&&(this.DropDom.addEventListener("drop",this.onDrop,!1),this.DropDom.addEventListener("dragleave",this.onDragLeave,!1),this.DropDom.addEventListener("dragenter",this.onDragenter,!1))}},{key:"componentWillUnmount",value:function(){this.DropDom&&!this.props.preview&&(this.DropDom.removeEventListener("drop",this.onDrop),this.DropDom.removeEventListener("dragleave",this.onDragLeave),this.DropDom.removeEventListener("dragenter",this.onDragenter))}},{key:"onToggleEdit",value:function(){this.setState({showEdit:!this.state.showEdit})}},{key:"onUpdateConfigs",value:function(e){var t=e.deleteFlag,a=void 0!==t&&t,n=Object(k.a)(e,["deleteFlag"]),o=this.props,i=o.onUpdateLayoutConfig,l=o.configs.layoutIndex,r={configs:{layoutIndex:l}};a?(r.dropComponent=!1,r.configs.cellStyles=n.cellStyles):r.configs=Object.assign({},this.state.configs,n),this.setState(Object(x.a)({},r)),i(Object(x.a)({},r.configs,{deleteFlag:a,layoutIndex:l})),Re(this.state.configs.type)||this.onToggleEdit()}},{key:"onDrop",value:function(e){var t=this;if(e.preventDefault(),e.stopPropagation(),e.target.className===Be){this.resetBg();var a=JSON.parse(e.dataTransfer.getData("text/plain")),n=this.props,o=n.onUpdateLayoutConfig,i=n.configs,l=void 0===i?{}:i,r=Me(a,this),c=r.type,s=Object(k.a)(r,["type"]),u=l.layoutIndex;s&&this.setState({configs:Object(x.a)({type:c,layoutIndex:u},s),dropComponent:!0},function(){o(t.state.configs)})}}},{key:"resetBg",value:function(){var e=document.querySelectorAll(".drop-container");e&&e.forEach(function(e){e.style.background=""})}},{key:"onDragenter",value:function(e){e.target.className===Be&&(e.target.style.background="#dde7f1")}},{key:"onDragLeave",value:function(e){e.target.className===Be&&(e.target.style.background="")}},{key:"render",value:function(){var e=this,t=this.state,a=t.dropComponent,i=t.configs,l=t.showEdit,r=this.props,c=r.layerConfig,s=r.preview,u=s?this.props.configs:Object.assign({},i);return o.a.createElement("div",{className:"drop-container",ref:function(t){e.DropDom=t}},a||s?o.a.createElement(n.Fragment,null,o.a.createElement(Oe,Object.assign({},this.props,{onUpdateLayoutConfig:this.onUpdateConfigs,configs:u})),Re(i.type)||s?null:o.a.createElement(R.a,{type:"bars",className:"icon-operation",onClick:this.onToggleEdit})):s?null:o.a.createElement(R.a,{type:"drag"}),o.a.createElement(Le,{visible:l,configs:i,layerConfig:c,inForm:!1,onClose:this.onToggleEdit,onUpdateConfigs:this.onUpdateConfigs}))}}]),t}(n.Component),ze=(a(1298),y.a.TextArea),Ke=B.a.Option,He=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).handleSubmit=a.handleSubmit.bind(Object(m.a)(Object(m.a)(a))),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"handleSubmit",value:function(e){e.preventDefault();var t=this.props,a=t.form,n=t.onClose;a.validateFields(function(e,t){if(!e){var a=t.boxStyles,o=Object(k.a)(t,["boxStyles"]),i=Object(x.a)({boxStyles:Ee(a)},o);n(i)}})}},{key:"render",value:function(){var e=this.props,t=e.visible,a=e.form,n=e.onClose,i=e.configs,l=void 0===i?{}:i,r=e.onDeleteContainer,c=l.boxStyles,s=void 0===c?{}:c,u=l.layoutColumn,d=void 0===u?3:u,m=l.positionFixed,p=void 0===m?"0":m,h=l.type,f=je(s),b=a.getFieldDecorator;return o.a.createElement(q.a,{visible:t,maskClosable:!1,width:420,title:"\u7f16\u8f91\u5217",onClose:function(){n(0)}},o.a.createElement(v.a,{onSubmit:this.handleSubmit,style:{padding:"0 20px"}},o.a.createElement(v.a.Item,Object.assign({label:"style\u8bbe\u7f6e"},Z),a.getFieldDecorator("boxStyles",{initialValue:f})(o.a.createElement(ze,{placeholder:"\u591a\u4e2a\u6837\u5f0f\u5c5e\u6027\u8bf7\u7528\u5206\u53f7\u5206\u9694"}))),h===D?o.a.createElement(v.a.Item,Object.assign({label:"\u4f4d\u7f6e\u56fa\u5b9a"},Z),b("positionFixed",{initialValue:p})(o.a.createElement(B.a,null,o.a.createElement(Ke,{value:"1"},"\u662f"),o.a.createElement(Ke,{value:"0"},"\u5426")))):null,h!==D?o.a.createElement(v.a.Item,Object.assign({label:"\u5bb9\u5668\u5217"},Z),b("layoutColumn",{initialValue:d,rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u5217\u6570!"}]})(o.a.createElement(B.a,null,o.a.createElement(Ke,{value:"1"},"1"),o.a.createElement(Ke,{value:"2"},"2"),o.a.createElement(Ke,{value:"3"},"3"),o.a.createElement(Ke,{value:"4"},"4"),o.a.createElement(Ke,{value:"5"},"5"),o.a.createElement(Ke,{value:"6"},"6"),o.a.createElement(Ke,{value:"7"},"7"),o.a.createElement(Ke,{value:"8"},"8")))):null,o.a.createElement("div",{className:"btn-box"},o.a.createElement(C.a,{type:"primary",htmlType:"submit",style:{marginRight:"10px"}},"\u786e\u5b9a"),o.a.createElement(C.a,{onClick:r},"\u5220\u9664\u5bb9\u5668"))))}}]),t}(n.Component),Ye=v.a.create()(He),Ge=(a(1299),function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={visible:!1,configs:{cellsArr:[{layoutIndex:0}],layoutColumn:1}},a.onAddRowCell=a.onAddRowCell.bind(Object(m.a)(Object(m.a)(a))),a.onReceiveConfigs=a.onReceiveConfigs.bind(Object(m.a)(Object(m.a)(a))),a.onUpdateConfigs=a.onUpdateConfigs.bind(Object(m.a)(Object(m.a)(a))),a.onDeleteContainer=a.onDeleteContainer.bind(Object(m.a)(Object(m.a)(a))),a.onToggleEditDrawer=a.onToggleEditDrawer.bind(Object(m.a)(Object(m.a)(a))),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"onReceiveConfigs",value:function(e){var t=e.deleteFlag,a=void 0!==t&&t,n=Object(k.a)(e,["deleteFlag"]),o=this.state.configs,i=this.props.layoutColumn,l=Object.assign(Object(x.a)({},o),i),r=l.cellsArr.reduce(function(e,t){return a?n.layoutIndex!==t.layoutIndex?e.push(Object.assign({},t)):e.push({layoutIndex:n.layoutIndex}):n.layoutIndex===t.layoutIndex?e.push(Object.assign({},t,n)):e.push(Object.assign({},t)),e},[]);l.cellsArr=r,this.onUpdateConfigs(l)}},{key:"onAddRowCell",value:function(){var e=this.props,t=e.onUpdateLayoutConfig,a=e.layoutIndex,n=this.state.configs,o=n.cellsArr,i={layoutColumn:n.layoutColumn,cellsArr:o.concat([{layoutIndex:o.length}])},l={configs:i};this.setState(Object(x.a)({},l),function(){t({layoutIndex:a,configs:i})})}},{key:"rendeCell",value:function(e){if(!e)return null;for(var t=this.props,a=t.preview,n=t.context,i=void 0===n?this:n,l=t.apiData,r=t.execFetchApi,c=t.onShowLoginModal,s=Object(k.a)(t,["preview","context","apiData","execFetchApi","onShowLoginModal"]),u=[],d="".concat(100/e,"%"),m=(a?this.props:this.state).configs.cellsArr,p=m.length,h=this.props.layerConfig,f={preview:a},b=Math.max(p,e),g=0;g<b;g++){var v=g;f.configs=Object.assign(m.length-1>=g?m[g]:{},{layoutIndex:v}),u.push(o.a.createElement("div",{className:"cell border-box",key:"cell-".concat(e,"-").concat(g),style:{width:d}},o.a.createElement(qe,Object.assign({layoutIndex:v,apiData:l,execFetchApi:r,layerConfig:h},s,f,{onShowLoginModal:c,context:i,onUpdateLayoutConfig:this.onReceiveConfigs}))))}return u}},{key:"_render",value:function(){var e=this,t=this.state.visible,a=this.props,n=a.onUpdateLayoutConfig,i=a.configs,l=void 0===i?{}:i,r=a.preview,c=l.layoutColumn,s=void 0===c?1:c,u=l.boxStyles;return o.a.createElement("div",{className:"fulu-cell-box ".concat(r?"preview-mode":"edit-mode"),style:u},o.a.createElement("div",{className:"clear-box"},this.rendeCell(+s)),o.a.createElement(Ye,{visible:t,configs:l,onClose:function(t){if(l){var a=t.layoutColumn,o={cellsArr:e.state.configs.cellsArr,layoutColumn:+a,layoutIndex:l.layoutIndex,type:"BoxContainer",boxStyles:t.boxStyles};e.setState({configs:o}),n(o)}e.onToggleEditDrawer()},onDeleteContainer:this.onDeleteContainer}),r?null:o.a.createElement(R.a,{type:"form",className:"icon-operation",onClick:this.onToggleEditDrawer}),r?null:o.a.createElement("div",{className:"btn-add-box"},o.a.createElement(C.a,{ghost:!0,type:"primary",onClick:this.onAddRowCell},"+ boxItem")))}}]),t}(Ce)),Je=(a(1300),function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={visible:!1,configs:{cellsArr:[{layoutIndex:0}],type:D,layoutColumn:1}},a.onToggleEdit=a.onToggleEdit.bind(Object(m.a)(Object(m.a)(a))),a.onDeleteContainer=a.onDeleteContainer.bind(Object(m.a)(Object(m.a)(a))),a.onUpdateConfigs=a.onUpdateConfigs.bind(Object(m.a)(Object(m.a)(a))),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"onToggleEdit",value:function(){this.setState({visible:!this.state.visible})}},{key:"onDeleteContainer",value:function(){var e=this.props;(0,e.onUpdateLayoutConfig)({layoutIndex:e.layoutIndex,deleteFlag:!0}),this.onToggleEdit()}},{key:"onUpdateConfigs",value:function(e){var t=e.deleteFlag,a=void 0!==t&&t,n=Object(k.a)(e,["deleteFlag"]),o=this.props,i=o.onUpdateLayoutConfig,l=o.configs.layoutIndex,r=Object.assign({layoutIndex:l},this.state.configs),c=r.cellsArr.reduce(function(e,t){return a?n.layoutIndex!==t.layoutIndex?e.push(Object.assign({},t)):e.push({layoutIndex:n.layoutIndex}):n.layoutIndex===t.layoutIndex?e.push(Object.assign({},t,n)):e.push(Object.assign({},t)),e},[]);r.cellsArr=c,this.setState({configs:r},function(){i(r)})}},{key:"rendeCell",value:function(e){if(!e)return null;for(var t=[],a="".concat(100/e,"%"),n=this.props.preview,i=(n?this.props.configs:this.state.configs).cellsArr,l=void 0===i?[]:i,r=l.length,c=0;c<r;c++)t.push(o.a.createElement("div",{className:"cell border-box",key:"cell-".concat(e,"-").concat(c),style:{width:a}},o.a.createElement(qe,{layoutIndex:c,preview:n,configs:Object.assign({layoutIndex:c},l[c]),onUpdateLayoutConfig:this.onUpdateConfigs})));return t}},{key:"render",value:function(){var e=this,t=this.state.visible,a=this.props,n=a.onUpdateLayoutConfig,i=a.configs,l=void 0===i?{}:i,r=a.preview,c=void 0!==r&&r,s=a.type,u=l.layoutIndex,d=l.layoutColumn,m=void 0===d?1:d,p=l.boxStyles,h="1"===l.positionFixed?"position-fixed":"",f=c?"preview-box":"";return o.a.createElement("div",{className:"header-box fulu-cell-box ".concat(h,"  ").concat(f),style:p},this.rendeCell(+m),o.a.createElement(Ye,{visible:t,configs:l,type:s,onClose:function(t){if(t){for(var a=t.layoutColumn,o=e.state.configs.cellsArr.slice(0,a),i=0;i<a;i++)o.length<=i&&o.push({layoutIndex:i});var l=Object(x.a)({},t,{layoutIndex:u,type:D,cellsArr:o});e.setState({configs:l}),n(l)}e.onToggleEdit()},onDeleteContainer:this.onDeleteContainer}),c?null:o.a.createElement(R.a,{type:"form",className:"icon-operation",onClick:this.onToggleEdit}))}}]),t}(n.Component)),We=K.a.Group,_e=B.a.Option,Qe=H.a.RangePicker,$e=Y.a.TabPane,Ze=y.a.TextArea,Xe=function(e,t){var a=e.placeholder,n=void 0===a?"":a,i=null;switch(e.type){case"Text":i=rt(e);break;case"Breadcrumb":i=lt(e);break;case"Select":i=dt(e);break;case"RangePicker":i=pt(e);break;case"DatePicker":i=mt(e);break;case"Radio":i=ct(e);break;case"Checkbox":i=ut(e);break;case"Tabs":i=st(e);break;case"Button":i=ft(e,t);break;case"FormContainer":i=tt(e,t);break;case"LineContainer":i=ot(e,t);break;case"TableContainer":i=nt(e,t);break;case"BoxContainer":i=it(e,t);break;case"HeaderContainer":i=at(e,t);break;case"TextArea":i=et(e);break;case"Input":i=o.a.createElement(y.a,{placeholder:n})}return i},et=function(e){e.colIndex,e.dropIndex,e.originSpan,e.cellStyles,e.hasLinkage;var t=Object(k.a)(e,["colIndex","dropIndex","originSpan","cellStyles","hasLinkage"]);return o.a.createElement(Ze,t)},tt=function(e,t){return o.a.createElement(Ft,Object.assign({configs:e},t))},at=function(e){return o.a.createElement(Je,e)},nt=function(e,t){return o.a.createElement(ye,Object.assign({configs:e},t))},ot=function(e){return o.a.createElement(W,{configs:e})},it=function(e,t){return o.a.createElement(Ge,Object.assign({configs:e},t))},lt=function(e){var t=e.breadcrumbArr,a=void 0===t?[]:t,n=e.style;return o.a.createElement(G.a,{style:n},a.map(function(e,t){var a=e.label,n=e.value;return o.a.createElement(G.a.Item,{key:"breadcrumb-".concat(t)},n?o.a.createElement("a",{href:n},a):o.a.createElement("span",null,a))}))},rt=function(e){var t=e.text,a=e.style;return o.a.createElement("span",{style:a},t)},ct=function(e){var t=e.style,a=void 0===t?{}:t,n=e.radioArr,i=void 0===n?[]:n,l="tab"===e.radioType?J.a.Button:J.a;return o.a.createElement(J.a.Group,{style:Object(x.a)({},a)},Array.isArray(i)?i.map(function(e){var t=e.key,a=e.label,n=e.value;return o.a.createElement(l,{key:t||n,value:n},a)}):null)},st=function(e){var t=e.style,a=void 0===t?{}:t,n=e.tabsArr,i=void 0===n?[]:n;return o.a.createElement(Y.a,{style:a},Array.isArray(i)?i.map(function(e){var t=e.key,a=e.label,n=e.value;return o.a.createElement($e,{key:t||n,tab:a})}):null)},ut=function(e){var t=e.style,a=void 0===t?{}:t,n=e.checkboxArr,i=void 0===n?[]:n;return Array.isArray(i)?o.a.createElement(We,{options:i,style:Object(x.a)({width:"100%"},a)}):null},dt=function(e){var t=e.style,a=void 0===t?{}:t,n=(e.options,e.selectArr,Object(k.a)(e,["style","options","selectArr"])),i=Object.hasOwnProperty.call(e,"options")?e.options:e.selectArr;return o.a.createElement(B.a,Object.assign({style:Object(x.a)({width:"100%"},a)},n),Array.isArray(i)?i.map(function(e){var t=e.key,a=e.label,n=e.value;return o.a.createElement(_e,{key:t||n,value:n},a)}):null)},mt=function(e){var t=e.showTime,a=e.format;return o.a.createElement(H.a,{style:{width:"100%"},showTime:t,format:a})},pt=function(e){var t=e.showTime,a=e.format;return o.a.createElement(Qe,{showTime:t,format:a,style:{width:"100%"}})},ht=function(e,t){return"mult"===e&&!(Array.isArray(t)&&t.length>0)},ft=function(e,t){var a=t.context,n=t.onResetForm,i=e.buttonArr,l=void 0===i?[]:i,r=a||{},c=r.state,s=r.onCollapse,u=c.expand,d=void 0===u||u,m=a.GuiContext;return o.a.createElement(m.Consumer,null,function(e){var t=e.selectedRowKeys;return o.a.createElement("span",{className:"btn-group"},l.map(function(e){var i=e.logicType,l=e.btnText,r=(e.expandCount,e.api),c=e.modalName,u=e.antdType,m=e.skipUrl,p=e.style,h=void 0===p?{}:p,f=(e.textDisabled,e.btnIndex),b=Object(k.a)(e,["logicType","btnText","expandCount","api","modalName","antdType","skipUrl","style","textDisabled","btnIndex"]);if("expand"===i){var g=d?"\u6536\u8d77":"\u5c55\u5f00";return o.a.createElement("span",{className:"fulu-btn-collapse",onClick:s,style:h,key:"btn-".concat(f)},g,o.a.createElement(R.a,{type:d?"up":"down"}))}return"submit"!==e.htmlType&&(b.onClick=function(t){a&&("reset"===e.htmlType?n():c?a.onShowModal(t,c,r):"mult"===i?a.execFetchApi(r,{},i):"skip"===i&&(window.location=m))}),o.a.createElement(C.a,Object.assign({key:"btn-".concat(f),style:h,type:u},b,{disabled:ht(i,t)}),l)}))})},bt=function(e,t){var a,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=e.getFieldDecorator,l=(a=n.index,/\d+/.test(a));return Array.isArray(t)?t.map(function(e){var t=e.label,a=e.key,r=e.rules,c=void 0===r?[]:r,s=e.initialValue;return e.required&&c.push({required:!0,message:"\u8bf7\u8f93\u5165".concat(t)}),o.a.createElement(v.a.Item,Object.assign({label:t,key:"".concat(a,"-item")},Z),i(l?"".concat(a,"-").concat(n.index):a,{rules:c,initialValue:n[a]||s})(Xe(e)))}):null},gt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i="".concat(n),l=e.modalArr,r=void 0===l?[]:l;if(0===r.length)return null;var c=i?"modal-item-".concat(i):"modal-item",s=i?"modalName-".concat(i):"modalName";return o.a.createElement(v.a.Item,Object.assign({key:c,label:"\u6253\u5f00modal"},Z),t.getFieldDecorator(s,{rules:[{required:!0,message:"modal"}],initialValue:a})(o.a.createElement(B.a,{placeholder:"modal"},r.map(function(e){var t=e.index,a=e.name;return o.a.createElement(_e,{key:"modalName-".concat(t),value:a},a)}))))},vt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0,n=a.initialValue,i=a.key,l=void 0===i?"":i,r=a.label,c=void 0===r?"\u8c03\u7528api":r,s=a.apiName,u="".concat(l),d=e.apiArr,m=void 0===d?[]:d;if(0===m.length)return null;var p=s?"api-item-".concat(s):u?"api-item-".concat(u):"modal-item",h=s||(u?"api-".concat(u):"api");return o.a.createElement(v.a.Item,Object.assign({key:p,label:c},Z),t.getFieldDecorator(h,{rules:[{required:!0,message:"api"}],initialValue:n})(o.a.createElement(B.a,{placeholder:"api"},m.map(function(e){var t=e.index,a=e.requestApi;return o.a.createElement(_e,{key:"api-".concat(t),value:a},a)}))))},yt=Xe,Ct=(a(1301),B.a.Option),Ot=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).handleSubmit=a.handleSubmit.bind(Object(m.a)(Object(m.a)(a))),a.handleChange=a.handleChange.bind(Object(m.a)(Object(m.a)(a))),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"handleChange",value:function(e){for(var t=this,a={},n=24/e,o=0;o<e;o++)a["colSpan-".concat(o)]=n;setTimeout(function(){t.props.form.setFieldsValue(a)},0)}},{key:"handleSubmit",value:function(e){e.preventDefault();var t=this.props,a=t.form,n=t.onSave;a.validateFields(function(e,t){if(!e){for(var a=+t.layoutColumn,o=0,i={colSpanArr:[]},l=0;l<a;l++){var r=+t["colSpan-".concat(l)];delete t["colSpan-".concat(l)],o+=r,i.colSpanArr.push(r)}if(o>24)return void S.a.error("\u8de8\u5217\u603b\u6570\u4e0d\u80fd\u8d85\u8fc724!");n(Object.assign(i,t))}})}},{key:"renderColSpanInputs",value:function(){for(var e=this.props.form,t=e.getFieldDecorator,a=+e.getFieldValue("layoutColumn"),n=[],i=0;i<a;i++)n.push(o.a.createElement(v.a.Item,Object.assign({key:"formitem-".concat(i),label:"\u7b2c".concat(i+1,"\u5217")},Z),t("colSpan-".concat(i),{initialValue:24/a,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5217\u5bbd!"},{pattern:/^[1-9](\d)?$/,message:"\u53ea\u80fd\u5305\u542b\u6570\u5b57\uff01"}]})(o.a.createElement(y.a,null))));return n}},{key:"renderApiFormItem",value:function(){var e=this.props,t=e.form,a=e.layerConfig;return"query"===t.getFieldValue("formType")?vt(a,t,{label:"\u67e5\u8be2api",apiName:"queryApi"}):o.a.createElement(n.Fragment,null,vt(a,t,{label:"\u65b0\u589eapi",apiName:"addApi"}),vt(a,t,{label:"\u7f16\u8f91api",apiName:"editApi"}))}},{key:"render",value:function(){var e=this.props,t=e.visible,a=e.form,n=e.onClose,i=e.onDeleteContainer,l=a.getFieldDecorator;return o.a.createElement(q.a,{visible:t,maskClosable:!1,width:420,title:"\u7f16\u8f91\u5217",onClose:n},o.a.createElement(v.a,{onSubmit:this.handleSubmit,style:{padding:"0 20px"}},o.a.createElement(v.a.Item,Object.assign({label:"\u8868\u5355\u5217"},Z),l("layoutColumn",{initialValue:3,rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u5217\u6570!"}]})(o.a.createElement(B.a,{onChange:this.handleChange},o.a.createElement(Ct,{value:"1"},"1"),o.a.createElement(Ct,{value:"2"},"2"),o.a.createElement(Ct,{value:"3"},"3"),o.a.createElement(Ct,{value:"4"},"4")))),o.a.createElement(z.a,null),this.renderColSpanInputs(),o.a.createElement(z.a,null),o.a.createElement(v.a.Item,Object.assign({label:"\u5bf9\u9f50\u65b9\u5f0f"},Z),l("formItemAlign",{initialValue:"lr"})(o.a.createElement(B.a,null,o.a.createElement(Ct,{value:"lr"},"\u5de6\u53f3\u5bf9\u9f50"),o.a.createElement(Ct,{value:"r"},"\u6587\u5b57\u53f3\u5bf9\u9f50")))),o.a.createElement(v.a.Item,Object.assign({label:"\u8868\u5355\u7c7b\u578b"},Z),l("formType",{initialValue:"query",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u8868\u5355\u7c7b\u578b!"}]})(o.a.createElement(B.a,null,o.a.createElement(Ct,{value:"query"},"\u67e5\u8be2"),o.a.createElement(Ct,{value:"save"},"\u65b0\u589e/\u7f16\u8f91")))),this.renderApiFormItem(),o.a.createElement("div",{className:"btn-box"},o.a.createElement(C.a,{type:"primary",htmlType:"submit",style:{marginRight:"10px"}},"\u786e\u5b9a"),o.a.createElement(C.a,{onClick:i},"\u5220\u9664\u5bb9\u5668"))))}}]),t}(n.Component),Et=v.a.create()(Ot),jt=a(73),xt=function(e){function t(){return Object(r.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.configs,a=e.form,i=e.context,l=e.preview,r=void 0!==l&&l,c=e.colSpanArr,s=void 0===c?[]:c,u=e.formItemAlign,d=e.onResetForm,m=a.getFieldDecorator,p=t.type,h=t.colSpan,f=t.label,b=t.name,g=t.rules,y=void 0===g?[]:g,C=t.required,O=h||s[0]||8;if(!b&&"Button"!==p)return null;C&&y.push({required:!0,message:"\u8bf7\u8f93\u5165".concat(f)});var E=function(e){var t=e.type,a=e.cellStyles,n=e.textAlign;return"Button"===t?Object.assign({},a,{textAlign:n}):a||{}}(t),j={label:f,style:E};return"r"===u&&(j.labelCol={span:6},j.wrapperCol={span:14}),o.a.createElement(n.Fragment,null,o.a.createElement(jt.a,{span:O,md:O,sm:24},"Button"!==p?o.a.createElement(v.a.Item,j,m(b,{rules:y||[],initialValue:Ve(t)})(yt(t,{preview:r,context:i}))):o.a.createElement(v.a.Item,{style:E},yt(t,{preview:r,context:i,onResetForm:d}))))}}]),t}(n.Component),kt=(a(1302),B.a.Option),St=y.a.TextArea,It=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={buttonArr:[],selectArr:[],radioArr:[],checkboxArr:[]},a.onAddCellStyleItem=a.onAddCellStyleItem.bind(Object(m.a)(Object(m.a)(a))),a.onDeleteCellStyleItem=a.onDeleteCellStyleItem.bind(Object(m.a)(Object(m.a)(a))),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"getItemSetType",value:function(){return["Select","Button","Radio","Checkbox"]}}]),Object(c.a)(t,[{key:"onAddCellStyleItem",value:function(){var e=this.state.cellStyles,t=(void 0===e?[]:e).slice();t.push({value:"",name:"",index:this.cellStyleIndex}),this.setState({cellStyles:t}),this.cellStyleIndex+=1}},{key:"onDeleteCellStyleItem",value:function(e){var t=this.state.cellStyles,a=(void 0===t?[]:t).reduce(function(t,a){return a.index!==e&&t.push(a),t},[]);this.setState({cellStyles:a})}},{key:"renderLinkage",value:function(e,t){var a=e.condition,i=e.linkName,l=this.props.form.getFieldDecorator;return o.a.createElement(n.Fragment,null,o.a.createElement(v.a.Item,Object.assign({},Z,{label:"\u5173\u8054\u7ec4\u4ef6name"}),l("linkName",{initialValue:i})(o.a.createElement(B.a,null,t.map(function(t){var a=t.name,n=t.colIndex,i=t.label;return a&&n!==e.colIndex?o.a.createElement(kt,{value:"".concat(a),key:"linkage-".concat(a)},"".concat(a,"/").concat(i)):null})))),o.a.createElement(v.a.Item,Object.assign({},Z,{label:"\u663e\u793a\u6761\u4ef6"}),l("condition",{initialValue:a})(o.a.createElement(y.a,null))))}},{key:"renderDatePickerExtra",value:function(e){var t=e.type,a=e.showTime,i=void 0!==a&&a,l=e.format,r=void 0===l?"YYYY-MM-DD":l,c=e.dateKeys,s=this.props.form.getFieldDecorator;return o.a.createElement(n.Fragment,null,o.a.createElement(v.a.Item,Object.assign({},Z,{label:"showTime"}),s("showTime",{initialValue:"1"===i?"1":"0"})(o.a.createElement(B.a,null,o.a.createElement(kt,{value:"1"},"\u662f"),o.a.createElement(kt,{value:"0"},"\u5426")))),o.a.createElement(v.a.Item,Object.assign({},Z,{label:"format"}),s("format",{initialValue:r})(o.a.createElement(y.a,null))),"RangePicker"===t?o.a.createElement(v.a.Item,Object.assign({},Z,{label:"\u63a5\u53e3\u5bf9\u5e94\u5b57\u6bb5"}),s("dateKeys",{rules:[{required:!0,message:"\u63a5\u53e3\u5bf9\u5e94\u5b57\u6bb5"}],initialValue:c})(o.a.createElement(y.a,{placeholder:"\u4e24\u4e2a\u5b57\u6bb5\uff0c\u4ee5\u9017\u53f7\u9694\u4e0d\u5f00"}))):null)}},{key:"renderContent",value:function(){var e=this.state.deleteComponent,t=this.props,a=t.form,i=t.dropComponent,l=void 0!==i&&i,r=t.configs,c=void 0===r?{}:r,s=t.formItemArr,u=c.type,d=c.label,m=c.name,p=c.placeholder,h=c.linkage,f=c.required,b=a.getFieldDecorator;return l&&!e?"Button"===u?this.renderBtnCard():o.a.createElement(n.Fragment,null,o.a.createElement(z.a,null,"\u7ec4\u4ef6"),o.a.createElement(v.a.Item,Object.assign({},Z,{label:"label"}),b("label",{rules:[{required:!0,message:"label"}],initialValue:d})(o.a.createElement(y.a,null))),o.a.createElement(v.a.Item,Object.assign({},Z,{label:"name"}),b("name",{rules:[{required:!0,message:"name"}],initialValue:m})(o.a.createElement(y.a,null))),o.a.createElement(v.a.Item,Object.assign({},Z,{label:"required"}),b("required",{initialValue:f})(o.a.createElement(B.a,{allowClear:!0},o.a.createElement(kt,{value:1},"\u662f"),o.a.createElement(kt,{value:0},"\u5426")))),"DatePicker"===u||"RangePicker"===u?this.renderDatePickerExtra(c):null,"Radio"===u?this.renderRadio():null,"Checkbox"===u?this.renderCheckbox():null,"Select"===u?this.renderSelect():null,this.renderDefaultValueItem(),o.a.createElement(v.a.Item,Object.assign({},Z,{label:"placeholder"}),b("placeholder",{initialValue:p})(o.a.createElement(y.a,null))),o.a.createElement(v.a.Item,Object.assign({},Z,{label:"\u8054\u52a8\u5173\u8054"}),b("hasLinkage",{initialValue:h})(o.a.createElement(B.a,null,o.a.createElement(kt,{value:"0"},"\u5426"),o.a.createElement(kt,{value:"1"},"\u662f")))),"1"===a.getFieldValue("hasLinkage")?this.renderLinkage(c,s):null,o.a.createElement(v.a.Item,{style:{textAlign:"center"}},o.a.createElement(C.a,{onClick:this.onDeleteComponent},"\u5220\u9664\u7ec4\u4ef6"))):null}},{key:"renderCellStylesSetting",value:function(){var e=this,t=this.props.form,a=this.state.cellStyles;return o.a.createElement($.a,{title:"style\u8bbe\u7f6e",extra:o.a.createElement(R.a,{type:"plus-circle",onClick:this.onAddCellStyleItem})},a.map(function(a){var i=a.name,l=a.value,r=a.index;return o.a.createElement(n.Fragment,{key:"cell-styleitem-".concat(r)},o.a.createElement(v.a.Item,{className:"half-item",key:"cell-styleitem-name-".concat(r)},t.getFieldDecorator("styleName-".concat(r),{initialValue:i})(o.a.createElement(y.a,{placeholder:"style name"}))),o.a.createElement(v.a.Item,{className:"half-item",key:"cell-styleitem-value-".concat(r),style:{marginLeft:"10px"}},t.getFieldDecorator("styleValue-".concat(r),{initialValue:l})(o.a.createElement(y.a,{placeholder:"style value"}))),o.a.createElement(R.a,{type:"close-circle",style:{marginLeft:"6px",lineHeight:"39px"},onClick:function(){e.onDeleteCellStyleItem(r)}}))}))}},{key:"render",value:function(){for(var e=this,t=this.state.deleteComponent,a=this.props,n=a.visible,i=a.onClose,l=a.form,r=a.onDeleteFormItemContainer,c=a.dropComponent,s=a.configs,u=a.colSpanArr,d=s.colSpan,m=s.type,p=s.textAlign,h=void 0===p?"left":p,f=s.cellStyles,b=1,g=d,y=0;y<u.length;y++)(g-=u[y].colSpan)>0?b++:y=u.length;return o.a.createElement(q.a,{visible:n,maskClosable:!1,title:"\u7f16\u8f91\u8868\u5355\u9879",onClose:function(){e.onCloseEdit(),i()},width:420},o.a.createElement(v.a,{onSubmit:this.handleSubmit},o.a.createElement(z.a,null,"\u5355\u5143\u683c"),o.a.createElement(v.a.Item,{style:{padding:"0 24px"},label:"style\u8bbe\u7f6e"},l.getFieldDecorator("cellStyles",{initialValue:je(f)})(o.a.createElement(St,{placeholder:"\u591a\u4e2a\u6837\u5f0f\u5c5e\u6027\u8bf7\u7528\u5206\u53f7\u5206\u9694"}))),o.a.createElement(v.a.Item,{key:"cell-colSpan",label:"\u8de8\u5217\u8bbe\u7f6e",style:{padding:"0 24px"}},l.getFieldDecorator("originSpan",{initialValue:b})(o.a.createElement(B.a,null,u.map(function(e,t){return o.a.createElement(kt,{key:"".concat(e,"-").concat(t),value:t+1},"".concat(t+1,"\u5217"))})))),!t&&c&&"Button"===m?o.a.createElement(v.a.Item,{label:"\u5bf9\u9f50\u65b9\u5f0f",style:{padding:"0 24px"}},l.getFieldDecorator("textAlign",{initialValue:h})(o.a.createElement(B.a,null,o.a.createElement(kt,{key:"left",value:"left"},"\u5de6"),o.a.createElement(kt,{key:"center",value:"center"},"\u4e2d"),o.a.createElement(kt,{key:"right",value:"right"},"\u53f3")))):null,o.a.createElement("div",{className:"btn-box"},o.a.createElement(C.a,{onClick:r},"\u5220\u9664\u5355\u5143\u683c")),this.renderContent(),o.a.createElement("div",{className:"btn-bottom-box"},o.a.createElement(C.a,{type:"primary",htmlType:"submit"},"\u4fdd\u5b58"))))}}]),t}(De),wt=v.a.create()(It),At=(a(1303),["Breadcrumb","Text","Tabs"]),Dt=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={dropComponent:!!e.configs.type},a.btnIndex=1,a.onUpdateConfigs=a.onUpdateConfigs.bind(Object(m.a)(Object(m.a)(a))),a.onShowEditItem=a.onShowEditItem.bind(Object(m.a)(Object(m.a)(a))),a.onEditDropContainer=a.onEditDropContainer.bind(Object(m.a)(Object(m.a)(a))),a.onDrop=a.onDrop.bind(Object(m.a)(Object(m.a)(a))),a.onDeleteChildren=a.onDeleteChildren.bind(Object(m.a)(Object(m.a)(a))),a.onClose=a.onClose.bind(Object(m.a)(Object(m.a)(a))),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"onShowEditItem",value:function(){this.setState({visible:!0})}},{key:"onDrop",value:function(e){if(e.preventDefault(),"drop-container border-box"===e.target.className){this.resetBg();var t=JSON.parse(e.dataTransfer.getData("text/plain")),a=t.type;if(~At.indexOf(a))return void S.a.warn("\u5f53\u524d\u5bb9\u5668\u4e0d\u652f\u6301\u62d6\u62fd\u7684\u7ec4\u4ef6!");var n=this.props,o=n.onUpdateFormItemConfigs,i=n.colIndex,l=Me(t,this,!0);l&&this.setState({dropComponent:!0},function(){o(Object(x.a)({colIndex:i},l))})}}},{key:"onDeleteChildren",value:function(e){e&&e.stopPropagation();var t=this.props,a=t.onUpdateFormItemConfigs,n=t.colIndex;this.setState({dropComponent:!1}),a({colIndex:n,deleteFlag:!0})}},{key:"resetBg",value:function(){var e=document.querySelectorAll(".form-container .drop-container");e&&e.forEach(function(e){e.style.background=""})}},{key:"onDragenter",value:function(e){"drop-container border-box"===e.target.className&&(e.target.style.background="#dde7f1")}},{key:"onDragLeave",value:function(e){"drop-container border-box"===e.target.className&&(e.target.style.background="")}},{key:"componentWillUnmount",value:function(){this.targetDom&&(this.targetDom.removeEventListener("drop",this.onDrop),this.targetDom.removeEventListener("dragleave",this.onDragLeave),this.targetDom.removeEventListener("dragenter",this.onDragenter))}},{key:"componentDidMount",value:function(){this.targetDom&&(this.targetDom.addEventListener("drop",this.onDrop,!1),this.targetDom.addEventListener("dragleave",this.onDragLeave,!1),this.targetDom.addEventListener("dragenter",this.onDragenter,!1))}},{key:"onUpdateConfigs",value:function(e){var t=this,a=this.props.configs,n=a.colIndex;this.setState({dropComponent:!e.deleteFlag},function(){(0,t.props.onUpdateFormItemConfigs)(Object.assign(a,e,{colIndex:n})),t.onClose()})}},{key:"onEditDropContainer",value:function(e){"drop-container border-box"===e.target.className&&(e&&e.stopPropagation(),this.setState({visible:!0}))}},{key:"onClose",value:function(){this.setState({visible:!1})}},{key:"getContainerWidth",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;return"".concat(100*e/24,"%")}},{key:"render",value:function(){var e=this,t=this.props,a=t.layoutColumn,n=t.onDeleteFormItemContainer,i=t.preview,l=void 0!==i&&i,r=t.colSpanArr,c=void 0===r?[]:r,s=t.formItemArr,u=void 0===s?[]:s,d=t.configs,m=this.state,p=m.dropComponent,h=m.visible,f=+d.colIndex,b=Object.hasOwnProperty.call(d,"colSpan")?d.colSpan:24/a;return o.a.createElement("div",{className:l?"preview-box ".concat("drop-container border-box"):"drop-container border-box",style:{width:this.getContainerWidth(b)},ref:function(t){e.targetDom=t}},p||l?o.a.createElement(xt,Object.assign({},this.props,{configs:d})):o.a.createElement(R.a,{type:"drag"}),l?null:o.a.createElement(R.a,{type:"bars",className:"icon-operation",onClick:this.onShowEditItem}),o.a.createElement(wt,{inForm:!0,visible:h,onDelete:this.onDeleteChildren,onUpdateConfigs:this.onUpdateConfigs,colSpanArr:c,formItemArr:u,configs:d,dropComponent:p,layoutColumn:a,onDeleteFormItemContainer:function(){e.setState({visible:!1},function(){n(f)})},onClose:this.onClose}))}}]),t}(n.PureComponent),Tt=(a(1304),function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={visible:!1,fetchLoading:!1,expand:!0,configs:{layoutColumn:1,colSpanArr:[],formItemArr:[]}},a.onSubmit=a.onSubmit.bind(Object(m.a)(Object(m.a)(a))),a.onAddRow=a.onAddRow.bind(Object(m.a)(Object(m.a)(a))),a.onCollapse=a.onCollapse.bind(Object(m.a)(Object(m.a)(a))),a.onDeleteRow=a.onDeleteRow.bind(Object(m.a)(Object(m.a)(a))),a.onResetForm=a.onResetForm.bind(Object(m.a)(Object(m.a)(a))),a.onAddRowCell=a.onAddRowCell.bind(Object(m.a)(Object(m.a)(a))),a.onShowEditForm=a.onShowEditForm.bind(Object(m.a)(Object(m.a)(a))),a.onCloseEditForm=a.onCloseEditForm.bind(Object(m.a)(Object(m.a)(a))),a.onUpdateConfigs=a.onUpdateConfigs.bind(Object(m.a)(Object(m.a)(a))),a.onDeleteContainer=a.onDeleteContainer.bind(Object(m.a)(Object(m.a)(a))),a.onUpdateFormLayout=a.onUpdateFormLayout.bind(Object(m.a)(Object(m.a)(a))),a.renderFormItemContainer=a.renderFormItemContainer.bind(Object(m.a)(Object(m.a)(a))),a.onUpdateFormItemConfigs=a.onUpdateFormItemConfigs.bind(Object(m.a)(Object(m.a)(a))),a.onDeleteFormItemContainer=a.onDeleteFormItemContainer.bind(Object(m.a)(Object(m.a)(a))),a.colIndexStart=0,a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.onFormRenderCallBack,a=e.form;"function"===typeof t&&t(a)}},{key:"onResetForm",value:function(){this.props.form.resetFields()}},{key:"onShowEditForm",value:function(){this.setState({visible:!0,expand:!1})}},{key:"onCollapse",value:function(){var e=this.state.expand;this.setState({expand:!e})}},{key:"addNewFormItem",value:function(e,t,a){if(e.length<t)for(var n=e.length;n<t;n++)e.push({colIndex:this.colIndexStart+n,colSpan:a[n],originSpan:1});return e}},{key:"onCloseEditForm",value:function(){this.setState({visible:!1})}},{key:"onAddRowCell",value:function(){var e=this,t=this.state.configs,a=t.colSpanArr,n=t.formItemArr.slice();if(0!==n.length){for(var o=n.reduce(function(e,t,a){return e+=t.colSpan,a===n.length-1&&(e%=24),e},0),i=0,l=0,r=0;r<a.length;r++)(l+=+a[r])>o&&(i=r,r=a.length);n.push({colIndex:this.colIndexStart,originSpan:1,colSpan:a[i]}),this.colIndexStart+=1;var c=Object.assign({},t);c.formItemArr=n,this.setState({configs:c},function(){e.onUpdateConfigs(c)})}else S.a.warn("\u8bf7\u8bbe\u7f6e\u5bb9\u5668\u5217\u6570")}},{key:"onUpdateConfigs",value:function(e){var t=this.props,a=t.onUpdateLayoutConfig,n=t.configs;a(Object(x.a)({layoutIndex:n.layoutIndex,type:"FormContainer"},e))}},{key:"onAddRow",value:function(){var e=this,t=this.state.configs,a=t.formItemArr.slice();if(0!==a.length){for(var n=t.layoutColumn,o=0;o<n;o++)a.push({colIndex:this.colIndexStart+o});this.colIndexStart+=n;var i=Object.assign({},t);i.formItemArr=a,this.setState({configs:i},function(){e.onUpdateConfigs(i)})}else S.a.warn("\u8bf7\u8bbe\u7f6e\u5bb9\u5668\u5217\u6570")}},{key:"onDeleteRow",value:function(){var e=this,t=this.state.configs,a=t.layoutColumn,n=t.formItemArr,o=Object.assign({},t),i=n.slice();i.length<=a?S.a.warn("\u4e0d\u80fd\u518d\u5220\u9664\u4e86"):(i.length=Math.max(0,i.length-a),o.formItemArr=i,this.setState({configs:o},function(){e.onUpdateConfigs(o)}))}},{key:"onDeleteContainer",value:function(){var e=this.props;(0,e.onUpdateLayoutConfig)({layoutIndex:e.layoutIndex,deleteFlag:!0})}},{key:"onDeleteFormItemContainer",value:function(e){var t=this,a=this.state.configs,n=a.formItemArr,o=Object.assign({},a),i=n.filter(function(t){return t.colIndex!==e});o.formItemArr=i,this.setState({configs:o},function(){t.onUpdateConfigs(o)})}},{key:"onUpdateFormItemConfigs",value:function(e){var t=this,a=e.deleteFlag,n=void 0!==a&&a,o=Object(k.a)(e,["deleteFlag"]),i=this.state.configs,l=i.formItemArr,r=i.colSpanArr,c=Object.assign({},i),s=l.reduce(function(e,t){return n?o.colIndex!==t.colIndex?e.push(Object.assign({},t)):e.push({colIndex:o.colIndex,colSpan:o.colSpan,originSpan:o.originSpan}):o.colIndex===t.colIndex?e.push(Object.assign({},t,o)):e.push(Object.assign({},t)),e},[]);s.forEach(function(e){e.colIndex>o.colIndex&&(e.colSpan=xe(e.colIndex,e.originSpan,s,r))}),c.formItemArr=s,this.setState({configs:c},function(){t.onUpdateConfigs(c)})}},{key:"onUpdateFormLayout",value:function(e){var t=this,a=this.state.configs,n=e.layoutColumn,o=e.colSpanArr,i={},l=+n;if(l){var r=a.formItemArr.slice(),c=this.addNewFormItem(r,l,o);c.forEach(function(e){e.colSpan=xe(e.colIndex,e.originSpan,c,o)}),this.colIndexStart+=l,e.layoutColumn=l,e.formItemArr=c,i.configs=e}this.setState(Object(x.a)({},i),function(){t.onCloseEditForm(),t.onUpdateConfigs(e)})}},{key:"onSubmit",value:function(e){e.preventDefault();var t=this.props,a=t.onShowLoginModal,n=t.form,o=t.execFetchApi,i=t.mode,l=t.configs;Ue()?n.validateFields(function(e,t){if(!e){var a=ue(i,l);a?o(a,de(l,t)):S.a.warn("\u8bf7\u914d\u7f6eform\u7684api\u5c5e\u6027")}}):a()}},{key:"getExpandCount",value:function(){var e=(this.props.preview?this.props.configs||{}:this.state.configs).formItemArr,t=void 0===e?[]:e,a=0,n=!0,o=!1,i=void 0;try{for(var l,r=t[Symbol.iterator]();!(n=(l=r.next()).done);n=!0){var c=l.value;if("Button"===c.type&&Array.isArray(c.buttonArr)){var s=!0,u=!1,d=void 0;try{for(var m,p=c.buttonArr[Symbol.iterator]();!(s=(m=p.next()).done);s=!0){var h=m.value;"expand"===h.logicType&&(a=+(h.expandCount||0));break}}catch(f){u=!0,d=f}finally{try{s||null==p.return||p.return()}finally{if(u)throw d}}}}}catch(f){o=!0,i=f}finally{try{n||null==r.return||r.return()}finally{if(o)throw i}}return a}},{key:"renderFormItemContainer",value:function(){var e=this,t=this.props,a=t.form,n=t.preview,i=t.context,l=n?this.props.configs||{}:this.state.configs,r=l.formItemArr,c=void 0===r?[]:r,s=l.layoutColumn,u=l.colSpanArr,d=l.formItemAlign;this.GuiContext=i.GuiContext;var m=this.state.expand,p=this.getExpandCount();return c.map(function(t,l){var r=t.colIndex,h=t.type,f=t.hasLinkage;if(p>0&&!m&&l+1>p&&"Button"!==h)return null;if("1"===f){var b=t.linkName,g=t.condition;if(a.getFieldValue(b)!==g)return null}return o.a.createElement(Dt,{key:"ed-".concat(r),colIndex:r,configs:t,expand:m,context:i,onResetForm:e.onResetForm,form:a,preview:n,formItemAlign:d,formItemArr:c,colSpanArr:u,layoutColumn:s,onCollapse:e.onCollapse,onDeleteFormItemContainer:e.onDeleteFormItemContainer,onUpdateFormItemConfigs:e.onUpdateFormItemConfigs})})}},{key:"render",value:function(){var e=this.state.visible,t=this.props,a=t.preview,i=t.layerConfig,l=(a?this.props:this.state).configs,r=(void 0===l?{}:l)||{},c=r.layoutColumn,s=void 0===c?1:c,u=r.formItemArr,d=void 0===u?[]:u;return o.a.createElement(n.Fragment,null,o.a.createElement("div",{className:"form-container container ".concat(a?"preview-box":"border-box")},o.a.createElement("div",{className:"inner-box"},o.a.createElement(v.a,{onSubmit:this.onSubmit},o.a.createElement(V.a,{gutter:{md:24/s,lg:24,xl:48}},this.renderFormItemContainer())),d.length>0&&!a?o.a.createElement("div",{style:{textAlign:"center",marginTop:"10px"}},o.a.createElement(C.a,{ghost:!0,type:"primary",onClick:this.onAddRowCell},"+FormItem")):null),a?null:o.a.createElement(R.a,{type:"form",className:"icon-operation",onClick:this.onShowEditForm})),o.a.createElement(Et,{visible:e,layerConfig:i,onDeleteContainer:this.onDeleteContainer,onSave:this.onUpdateFormLayout,onClose:this.onCloseEditForm}))}}]),t}(n.PureComponent)),Ft=v.a.create()(Tt),Pt=a(601),Lt=a.n(Pt),Mt=(a(1305),function(e){function t(){return Object(r.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"renderContainer",value:function(){var e=this.props,t=e.layoutConfig,a=Object(k.a)(e,["layoutConfig"]);return Array.isArray(t)&&t.length>0?t.map(function(e){var t=e.type,n=e.layoutIndex,i="layout-".concat(n);return"FormContainer"===t?o.a.createElement(Ft,Object.assign({key:i},a,{configs:e})):"TableContainer"===t?o.a.createElement(ye,Object.assign({key:i},a,{configs:e})):"EmptyContainer"===t?o.a.createElement(Lt.a,Object.assign({key:i},a,{configs:e})):"BoxContainer"===t?o.a.createElement(Ge,Object.assign({key:i},a,{configs:e})):t===D?o.a.createElement(Je,Object.assign({key:i},a,{configs:e})):"LineContainer"===t?o.a.createElement(W,Object.assign({key:i},a,{configs:e})):null}):o.a.createElement("div",{className:"empty-tips"},"\u8bf7\u6dfb\u52a0\u5bb9\u5668\u7ec4\u4ef6")}},{key:"render",value:function(){return o.a.createElement(n.Fragment,null,this.renderContainer())}}]),t}(n.PureComponent)),Nt=function(e){function t(){return Object(r.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"onDragStart",value:function(e,t){e.dataTransfer.setData("text/plain",JSON.stringify(t))}},{key:"render",value:function(){var e=this,t=this.props,a=t.ch,n=t.data;return o.a.createElement("span",{draggable:"true",className:"drag-item",onDragStart:function(t){e.onDragStart(t,n)}},a)}}]),t}(n.PureComponent),Ut={component:{form:[{ch:"Input",data:{type:"Input",label:"",name:""}},{ch:"Select",data:{type:"Select"}},{ch:"DatePicker",data:{type:"DatePicker"}},{ch:"RangePicker",data:{type:"RangePicker"}},{ch:"Radio",data:{type:"Radio",radioArr:[{index:0,value:"a1",label:"a"},{index:1,value:"b1",label:"b"}],radioType:"default"}},{ch:"TextArea",data:{type:"TextArea",label:"",name:""}},{ch:"Checkbox",data:{type:"Checkbox",checkboxArr:[{index:0,value:"a1",label:"a"},{index:1,value:"b1",label:"b"}]}}],button:[{ch:"\u67e5\u8be2",data:{logicType:"query",type:"Button",antdType:"primary",textDisabled:!0,btnText:"\u67e5\u8be2",htmlType:"submit"}},{ch:"\u91cd\u7f6e",data:{logicType:"reset",type:"Button",antdType:"button",textDisabled:!0,btnText:"\u91cd\u7f6e",htmlType:"reset"}},{ch:"\u5c55\u5f00/\u6536\u8d77",data:{logicType:"expand",type:"Button",textDisabled:!0,btnText:"\u5c55\u5f00/\u6536\u8d77",htmlType:"button"}},{ch:"\u5bfc\u5165",data:{logicType:"import",type:"Button",btnText:"\u5bfc\u5165",htmlType:"button"}},{ch:"\u5bfc\u51fa",data:{logicType:"export",type:"Button",btnText:"\u5bfc\u51fa",htmlType:"button"}},{ch:"\u65b0\u589e",data:{logicType:"add",type:"Button",btnText:"\u65b0\u589e",htmlType:"button"}},{ch:"\u7f16\u8f91",data:{logicType:"edit",type:"Button",btnText:"\u7f16\u8f91",htmlType:"button"}},{ch:"\u67e5\u770b",data:{logicType:"view",type:"Button",btnText:"\u67e5\u770b",htmlType:"button"}},{ch:"\u6279\u91cf",data:{logicType:"mult",type:"Button",btnText:"\u6279\u91cf",htmlType:"button"}},{ch:"\u8df3\u8f6c",data:{logicType:"skip",type:"Button",btnText:"\u8df3\u8f6c",htmlType:"button"}}],others:[{ch:"Breadcrumb",data:{type:"Breadcrumb",breadcrumbArr:[{index:0,label:"menu1",value:""},{index:1,label:"menu2",value:""}]}},{ch:"Text",data:{type:"Text",text:"Text"}},{ch:"Tabs",data:{type:"Tabs",tabsArr:[{label:"tab1",value:"tab1",index:0}]}}]},layout:[{ch:"Form",data:{type:"FormContainer"}},{ch:"Table",data:{type:"TableContainer",columns:[{title:"column0",dataIndex:"dataIndex0",index:0},{title:"column1",dataIndex:"dataIndex1",index:1},{title:"column2",dataIndex:"dataIndex2",index:2},{title:"column3",dataIndex:"dataIndex3",index:3},{title:"column4",dataIndex:"dataIndex4",index:4}]}},{ch:"Box",data:{type:"BoxContainer",layoutColumn:1,cellsArr:[{layoutIndex:0}]}},{ch:"Header",data:{type:"HeaderContainer",layoutColumn:1,positionFixed:"0",cellsArr:[{layoutIndex:0}]}},{ch:"Line",data:{type:"LineContainer"}}]},Vt=function(e){function t(){return Object(r.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"renderContentByType",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return o.a.createElement(n.Fragment,{key:"".concat(t)},t?o.a.createElement(z.a,{key:"".concat(t)},t):null,e.map(function(e,t){return o.a.createElement(Nt,Object.assign({},e,{key:"drag-".concat(e.ch,"-").concat(t)}))}))}},{key:"render",value:function(){var e=this,t=this.props.tabType,a=Ut[void 0===t?"component":t]||[];return Array.isArray(a)?this.renderContentByType(a):Object.keys(a).map(function(t){return Array.isArray(a[t])?e.renderContentByType(a[t],t):null})}}]),t}(n.PureComponent),Rt=(a(1306),Y.a.TabPane),Bt=function(e){function t(){return Object(r.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){document.addEventListener("dragover",function(e){e.preventDefault()},!1),document.addEventListener("drag",function(e){},!1),document.addEventListener("dragstart",function(e){e.target.style.opacity=.5},!1),document.addEventListener("dragend",function(e){e.target.style.opacity="",document.querySelectorAll(".drop-zone").forEach(function(e){e.style.background="#fff"})},!1),document.addEventListener("dragenter",function(e){"drop-zone"===e.target.className&&(e.target.style.background="#96cdf9")},!1),document.addEventListener("dragleave",function(e){"drop-zone"===e.target.className&&(e.target.style.background="")},!1)}},{key:"render",value:function(){return o.a.createElement(Y.a,{defaultActiveKey:"1",className:"aside-tabs"},o.a.createElement(Rt,{tab:"\u5bb9\u5668",key:"layout"},o.a.createElement(Vt,{tabType:"layout"})),o.a.createElement(Rt,{tab:"\u7ec4\u4ef6",key:"component"},o.a.createElement(Vt,null)),o.a.createElement(Rt,{tab:"\u6a21\u677f",key:"template"},o.a.createElement(Vt,{tabType:"template"})))}}]),t}(n.Component),qt=(a(1307),f.a.Sider),zt=f.a.Content,Kt=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={layoutConfig:[]},a.onSubmit=a.onSubmit.bind(Object(m.a)(Object(m.a)(a))),a.onUpdateLayoutConfig=a.onUpdateLayoutConfig.bind(Object(m.a)(Object(m.a)(a))),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"onSubmit",value:function(){var e=this.props,t=e.onOk,a=e.editModal,n=this.state.layoutConfig;t(Object(x.a)({},a,{layoutConfig:n}))}},{key:"onUpdateLayoutConfig",value:function(e){this.setState({layoutConfig:e})}},{key:"render",value:function(){var e=this.props,t=e.visible,a=e.onCancel,n=e.layerConfig;return o.a.createElement(g.a,{title:"\u5f39\u6846\u7f16\u8f91",width:1024,visible:t,maskClosable:!1,onOk:this.onSubmit,onCancel:a},o.a.createElement(f.a,null,o.a.createElement(qt,{width:"300"},o.a.createElement(Bt,null)),o.a.createElement(f.a,null,o.a.createElement(zt,null,o.a.createElement(Zt,{onUpdateLayoutConfig:this.onUpdateLayoutConfig,layerConfig:n,noLayer:!0})))))}}]),t}(n.PureComponent),Ht=[{label:"\u63a5\u53e3\u5730\u5740\u524d\u7f00",key:"requestHost",type:"Select",initialValue:"",placeholder:"\u63a5\u53e3\u5730\u5740\u524d\u7f00",options:[{value:localStorage.getItem("common"),label:"common"},{value:localStorage.getItem("main"),label:"main"},{value:localStorage.getItem("webapi"),label:"webapi"}],rules:[{required:!0,message:"host!"}]},{label:"\u8bf7\u6c42\u65b9\u6cd5",key:"requestMethod",type:"Select",initialValue:"GET",placeholder:"\u8bf7\u6c42\u65b9\u6cd5",options:[{value:"GET",label:"GET"},{value:"POST",label:"POST"},{value:"PUT",label:"PUT"},{value:"DELETE",label:"DELETE"}],rules:[{required:!0,message:"method!"}]},{label:"\u63a5\u53e3\u5730\u5740",key:"requestApi",type:"Input",placeholder:"\u63a5\u53e3\u5730\u5740",rules:[{required:!0,message:"\u63a5\u53e3\u5730\u5740!"}]},{label:"\u63a5\u53e3\u53c2\u6570",key:"requestParams",type:"TextArea",placeholder:"\u63a5\u53e3\u5165\u53c2\uff0c\u591a\u4e2a\u53c2\u6570\u4ee5\u9017\u53f7\u5206\u9694"},{label:"modelKey",key:"modelKey",type:"Input",placeholder:"\u5b58\u653e\u5728model\u4e2d\u7684\u5b57\u6bb5\u540d\u79f0",rules:[{required:!0,message:"model key!"}]},{label:"API\u662f\u5426\u5206\u9875",key:"requestPagination",type:"Select",placeholder:"API\u662f\u5426\u5206\u9875",rules:[{required:!0,message:"requestPagination!"}],initialValue:"0",options:[{value:"1",label:"\u662f"},{value:"0",label:"\u5426"}]}],Yt=[{label:"\u540d\u79f0",key:"name",type:"Input",placeholder:"\u82f1\u6587\u540d\u79f0",rules:[{required:!0,message:"\u540d\u79f0!"}]},{label:"width",key:"width",type:"Input"},{label:"title",key:"title",type:"Input",placeholder:"title",rules:[{required:!0,message:"title!"}]}],Gt=(a(1308),Q.a.Panel),Jt=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={layerConfig:{modalArr:[],apiArr:[],drawerArr:[]},editModal:null,showEditModal:!1},a.modalAddIndex=0,a.apiAddIndex=0,a.onClose=a.onClose.bind(Object(m.a)(Object(m.a)(a))),a.onAddApi=a.onAddApi.bind(Object(m.a)(Object(m.a)(a))),a.onAddModal=a.onAddModal.bind(Object(m.a)(Object(m.a)(a))),a.onDeleteApi=a.onDeleteApi.bind(Object(m.a)(Object(m.a)(a))),a.onDeleteModal=a.onDeleteModal.bind(Object(m.a)(Object(m.a)(a))),a.onSubmitLayer=a.onSubmitLayer.bind(Object(m.a)(Object(m.a)(a))),a.onShowEditModal=a.onShowEditModal.bind(Object(m.a)(Object(m.a)(a))),a.onCloseEditModal=a.onCloseEditModal.bind(Object(m.a)(Object(m.a)(a))),a.onSaveEditModal=a.onSaveEditModal.bind(Object(m.a)(Object(m.a)(a))),a.renderModalPanelHeader=a.renderModalPanelHeader.bind(Object(m.a)(Object(m.a)(a))),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidUpdate",value:function(){this.props.visible&&!this.initState&&(this.initState=!0,this.setState({layerConfig:this.props.layerConfig}))}},{key:"onShowEditModal",value:function(e){this.setState({showEditModal:!0,editModal:e})}},{key:"onCloseEditModal",value:function(){this.setState({showEditModal:!1,editModal:null})}},{key:"onSaveEditModal",value:function(e){var t=e.layerType,a=this.state.layerConfig,n=Object.assign({},a),o=n.modalArr;if(t===T){var i=(void 0===o?[]:o).reduce(function(t,a){return a.index===e.index&&(a=Object.assign({},a,e)),t.push(a),t},[]);n.modalArr=i}this.setState({layerConfig:n}),this.onCloseEditModal()}},{key:"onClose",value:function(){var e=this.props,t=e.onCloseLayer;e.form.resetFields(),this.initState=!1,t()}},{key:"onSubmitLayer",value:function(e){var t=this;e.preventDefault();var a=this.props,n=a.form,o=a.onUpdateLayerConfig;n.validateFields(function(e,a){if(!e){var n=t.state.layerConfig,i=Object.assign({},n);[T,F].forEach(function(e){var t=le(a,e===T?Yt:Ht,!0);i["".concat(e,"Arr")]=t}),i.modalArr.forEach(function(e){n.modalArr.forEach(function(t){t.index==e.index&&(e.layoutConfig=t.layoutConfig,e.layerType=t.layerType)})}),o(i),t.onClose()}})}},{key:"onAddModal",value:function(){this.onAddItem(T)}},{key:"onAddApi",value:function(){this.onAddItem(F)}},{key:"onAddItem",value:function(e){var t=this.state.layerConfig,a=t["".concat(e,"Arr")].concat([{index:this["".concat(e,"AddIndex")],layerType:e}]),n=Object.assign({},t);n["".concat(e,"Arr")]=a,this.setState({layerConfig:n}),this["".concat(e,"AddIndex")]+=1}},{key:"onDeleteItem",value:function(e,t){var a=this.state.layerConfig,n=a["".concat(e,"Arr")].reduce(function(e,a){return a.index!=t&&e.push(a),e},[]),o=Object.assign({},a);o["".concat(e,"Arr")]=n||[],this.setState({layerConfig:o})}},{key:"onDeleteModal",value:function(e){this.onDeleteItem(T,e)}},{key:"onDeleteApi",value:function(e){this.onDeleteItem(F,e)}},{key:"renderModalPanelHeader",value:function(e){var t=this,a=e.name,n=e.index;return o.a.createElement("div",{className:"panel-header"},o.a.createElement("span",{className:"title"},a||"modal-".concat(n)),o.a.createElement("span",{className:"edit-modal",onClick:function(a){a.stopPropagation(),t.onShowEditModal(e)}},"\u7f16\u8f91"),o.a.createElement(R.a,{type:"close",className:"btn-delete",onClick:function(){t.onDeleteModal(n)}}))}},{key:"renderApiPanelHeader",value:function(e){var t=this,a=e.requestApi,n=e.index;return o.a.createElement("div",{className:"panel-header"},o.a.createElement("span",{className:"title"},a||"api-".concat(n)),o.a.createElement(R.a,{type:"close",className:"btn-delete",onClick:function(){t.onDeleteApi(n)}}))}},{key:"render",value:function(){var e=this,t=this.props,a=t.visible,i=t.form,l=this.state,r=l.layerConfig,c=l.showEditModal,s=l.editModal,u=r.modalArr,d=void 0===u?[]:u,m=r.apiArr,p=void 0===m?[]:m;Ht[0].initialValue||(Ht[0].initialValue=localStorage.getItem("webapi"),Ht[0].options=[{value:localStorage.getItem("common"),label:"common"},{value:localStorage.getItem("main"),label:"main"},{value:localStorage.getItem("webapi"),label:"webapi"}]);var h=d.reduce(function(e,t){var a=t.index;return e.push("modal-".concat(a)),e},[]),f=p.reduce(function(e,t){var a=t.index;return e.push("api-".concat(a)),e},[]);return o.a.createElement(n.Fragment,null,o.a.createElement(q.a,{title:"\u5f39\u51fa\u5c42&\u63a5\u53e3",placement:"right",closable:!0,maskClosable:!1,onClose:this.onClose,visible:a,width:"400"},o.a.createElement(v.a,{onSubmit:this.onSubmitLayer},o.a.createElement(z.a,null,"\u5f39\u7a97"),o.a.createElement(Q.a,{defaultActiveKey:h},d.map(function(t){var a=t.index;return o.a.createElement(Gt,{header:e.renderModalPanelHeader(t),key:"modal-".concat(a)},bt(i,Yt,t))})),o.a.createElement("div",{className:"btn-add-box"},o.a.createElement(C.a,{type:"dashed",size:"large",onClick:this.onAddModal},"\u6dfb\u52a0\u5f39\u7a97")),o.a.createElement(z.a,null,"\u63a5\u53e3"),o.a.createElement(Q.a,{defaultActiveKey:f},p.map(function(t){var a=t.index;return o.a.createElement(Gt,{header:e.renderApiPanelHeader(t),key:"api-".concat(a)},bt(i,Ht,t))})),o.a.createElement("div",{className:"btn-add-box"},o.a.createElement(C.a,{type:"dashed",size:"large",onClick:this.onAddApi},"\u6dfb\u52a0\u63a5\u53e3")),o.a.createElement(v.a.Item,{style:{marginTop:"20px",textAlign:"center"}},o.a.createElement(C.a,{type:"primary",htmlType:"submit"},"\u786e\u5b9a")))),o.a.createElement(Kt,{layerConfig:this.props.layerConfig,visible:c,editModal:s,onOk:this.onSaveEditModal,onCancel:this.onCloseEditModal}))}}]),t}(n.Component),Wt=v.a.create()(Jt),_t=(a(1309),function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={loading:!1},a.onCancel=a.onCancel.bind(Object(m.a)(Object(m.a)(a))),a.onSubmit=a.onSubmit.bind(Object(m.a)(Object(m.a)(a))),a.onAfterClose=a.onAfterClose.bind(Object(m.a)(Object(m.a)(a))),a.onFormRenderCallBack=a.onFormRenderCallBack.bind(Object(m.a)(Object(m.a)(a))),a.initEdit=!1,a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidUpdate",value:function(){var e=this,t=this.props,a=t.mode,n=t.visible,o=t.recordData,i=t.api,l=t.execFetchApi,r=t.modalLayoutConfig;n&&"edit"===a&&!this.initEdit&&(i?(this.setState({loading:!0}),l(i,o).then(function(t){var a=t.code,n=t.data;"0"===a&&e.onInitForm(n),e.setState({loading:!1})}).catch(function(){e.setState({loading:!1})})):o&&this.onInitForm(r,o),this.initEdit=!0)}},{key:"onInitForm",value:function(e,t){var a=me(e,"save");if(a&&Array.isArray(a.formItemArr)){var n=a.formItemArr.reduce(function(e,a){var n=a.type,o=a.name,i=a.format,l=void 0===i?"YYYY-MM-DD":i,r=a.dateKeys;if("DatePicker"===n)e[o]=oe()(t[o],l);else if("RangePicker"===n&&r){var c=Object(X.a)(r,2),s=c[0],u=c[1];t[s]&&t[u]&&(e[o]=[oe()(t[s],l),oe()(t[u],l)])}else e[o]=t[o];return e},{});this.form&&this.form.setFieldsValue(n),this.formData=n}else S.a.warn("\u8bf7\u914d\u7f6e\u7f16\u8f91\u5f39\u7a97")}},{key:"onCancel",value:function(){if(!this.state.loading){var e=this.props,t=e.modalName;(0,e.onCancelModal)(t)}}},{key:"renderContent",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=this.props.mode;return t.map(function(t,i){return o.a.createElement(n.Fragment,{key:"preview-".concat(i)},yt(t,{preview:!0,context:e,mode:a,onFormRenderCallBack:e.onFormRenderCallBack}))})}},{key:"onSubmit",value:function(){var e=this;if(!this.state.loading){var t=this.props,a=t.onOkModal,n=t.modalName,o=t.mode,i=t.modalLayoutConfig,l=t.layerConfig,r=t.recordData;this.form?this.form.validateFields(function(t,c){if(!t)if(Array.isArray(i)){var s=me(i,"save");if(s){var u=ue(o,s),d=l.apiArr.find(function(e){return e.requestApi===u});if(d&&d.requestParams)d.requestParams.split(",").forEach(function(e){Object.hasOwnProperty.call(r,e)&&!Object.hasOwnProperty.call(c,e)&&(c[e]=r[e])});u?(e.setState({loading:!0}),a(n,u,de(s,c)).then(function(t){var a=(t.data||{}).code;e.setState({loading:!1}),"0"===a&&(S.a.success("\u4fdd\u5b58\u6210\u529f"),e.onCancel())}).catch(function(){e.setState({loading:!1})})):S.a.warn("\u8bf7\u914d\u7f6eform\u7684api\u5c5e\u6027")}else S.a.warn("\u8bf7\u914d\u7f6eform\u7ec4\u4ef6")}else S.a.warn("\u8bf7\u914d\u7f6eform\u7ec4\u4ef6")}):S.a.warn("\u8bf7\u914d\u7f6eform\u7ec4\u4ef6")}}},{key:"onFormRenderCallBack",value:function(e){this.form=e,this.formData&&this.form.setFieldsValue(this.formData)}},{key:"onAfterClose",value:function(){this.initEdit=!1,this.formData=null,this.form&&this.form.resetFields()}},{key:"render",value:function(){var e=this.props,t=e.title,a=e.visible,n=e.modalLayoutConfig,i=e.mode,l=this.state.loading;return o.a.createElement(g.a,{title:"edit"===i?"\u7f16\u8f91":t,visible:a,onCancel:this.onCancel,onOk:this.onSubmit,afterClose:this.onAfterClose,maskClosable:!1},o.a.createElement(I.a,{spinning:l},this.renderContent(n)))}}]),t}(n.PureComponent)),Qt=(a(1310),o.a.createContext({selectedRows:[],selectedRowKeys:[]})),$t={modalArr:[],apiArr:[],drawerArr:[]},Zt=(N="AppService",function(e){return function(t){var a=Object.assign({},t);if(Object.hasOwnProperty.call(L,N)){var n=L[N];"function"===typeof n&&(a.service=new n)}return o.a.createElement(e,a)}}(M=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={layoutConfig:e.preview?e.layoutConfig:[],layerConfig:e.layerConfig||$t,PageIndex:1,PageSize:10,fetchLoading:!1,apiData:{},showLayer:!1,selectedRows:[],selectedRowKeys:[],generateLoading:!1},a.paramData={},a.apiConfig={},a.GuiContext=Qt,a.onDrop=a.onDrop.bind(Object(m.a)(Object(m.a)(a))),a.onOkModal=a.onOkModal.bind(Object(m.a)(Object(m.a)(a))),a.onCancelModal=a.onCancelModal.bind(Object(m.a)(Object(m.a)(a))),a.onUpdateApiConfig=a.onUpdateApiConfig.bind(Object(m.a)(Object(m.a)(a))),a.onPageIndexChange=a.onPageIndexChange.bind(Object(m.a)(Object(m.a)(a))),a.onShowSizeChange=a.onShowSizeChange.bind(Object(m.a)(Object(m.a)(a))),a.execFetchApi=a.execFetchApi.bind(Object(m.a)(Object(m.a)(a))),a.onPreviewPage=a.onPreviewPage.bind(Object(m.a)(Object(m.a)(a))),a.onUpdateLayerConfig=a.onUpdateLayerConfig.bind(Object(m.a)(Object(m.a)(a))),a.onToggleLayer=a.onToggleLayer.bind(Object(m.a)(Object(m.a)(a))),a.onGeneratePage=a.onGeneratePage.bind(Object(m.a)(Object(m.a)(a))),a.onUpdateLayoutConfig=a.onUpdateLayoutConfig.bind(Object(m.a)(Object(m.a)(a))),a.layoutIndex=0,a.container=o.a.createRef(),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"onUpdateLayoutConfig",value:function(e){var t=e.layoutIndex,a=e.deleteFlag,n=void 0!==a&&a,o=this.state.layoutConfig.slice();if(n){var i=o.findIndex(function(e){return e.layoutIndex===t});o.splice(i,1)}else{var l=o.findIndex(function(e){return e.layoutIndex===t});o[l]=e}"function"===typeof this.props.onUpdateLayoutConfig&&this.props.onUpdateLayoutConfig(o),this.setState({layoutConfig:o})}},{key:"componentDidMount",value:function(){var e=this.props.preview;!(void 0!==e&&e)&&this.container&&this.container.current&&this.container.current.addEventListener("drop",this.onDrop,!1)}},{key:"componentWillUnmount",value:function(){var e=this.props.preview;!(void 0!==e&&e)&&this.container&&this.container.current&&this.container.current.removeEventListener("drop",this.onDrop)}},{key:"onDrop",value:function(e){e.preventDefault(),e.stopPropagation();var t=JSON.parse(e.dataTransfer.getData("text/plain")),a=t.type,n=Object(k.a)(t,["type"]);if(e.target.className&&-1!==e.target.className.indexOf("main-container"))if(Re(a)){var o=this.state.layoutConfig.slice(),i=Object.assign(Object(x.a)({type:a,layoutIndex:this.layoutIndex},n));o.push(i),this.setState({layoutConfig:o}),this.layoutIndex+=1}else S.a.warn("\u8bf7\u62d6\u62fd\u5bb9\u5668\u7ec4\u4ef6")}},{key:"execFetchApi",value:function(e,t,a){var n=this,o=this.state.layerConfig.apiArr.find(function(t){return t.requestApi===e});if(o){var i=o.modelKey,l=o.requestHost,r=o.requestMethod,c=o.requestPagination,s=o.requestParams,u=void 0===s?"":s;if("mult"===a){var d=this.state,m=d.selectedRows,p=d.selectedRowKeys;if(0===m.length)return void S.a.warn("\u8bf7\u9009\u62e9\u6570\u636e");if(u){var h=u.split(",");t=m.reduce(function(e,t){var a={};return h.forEach(function(e){a[e]=t[e]}),e.push(a),e},[])}else t=p}if(this.toggleLoading(),"1"===c){1!==this.state.PageIndex&&this.setState({PageIndex:1});var f=this.state.PageSize;t.PageIndex=1,t.PageSize=f}return this.paramData[i]=t,this.props.service.fetchApi(l,r,e,t).then(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.data;if(200===e.status){var o=t||{},l=o.code,r=o.message,s=o.data;if("0"!==l)S.a.error(r||"\u8c03\u7528\u63a5\u53e3\u5f02\u5e38");else{var u=n.state.apiData,d=Object.assign({},u);if("mult"===a&&n.setState({selectedRowKeys:[],selectedRows:[]}),"1"===c){var m=s.total,p=s.list;d[i]=p,d["".concat(i,"Total")]=m}else d[i]=s;n.setState({apiData:d})}}else{var h=(t||{}).message;S.a.error(h||"\u8c03\u7528\u63a5\u53e3\u5f02\u5e38")}return n.toggleLoading(!1),Promise.resolve(e)}).catch(function(e){return n.toggleLoading(!1),e.response?401===e.response.status?(S.a.error("\u767b\u5f55\u4fe1\u606f\u8fc7\u671f\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55"),n.props.onShowLoginModal()):403===e.response.status&&S.a.error(e.response.data.message):S.a.error(JSON.stringify(e)),Promise.reject(e)})}S.a.warn("api\u914d\u7f6e\u53c2\u6570\u6709\u8bef")}},{key:"toggleLoading",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.setState({fetchLoading:e})}},{key:"onPageIndexChange",value:function(e,t,a){var n=this;this.setState({PageIndex:e},function(){n.execTableQuery(a)})}},{key:"onShowSizeChange",value:function(e,t,a){var n=this;this.setState({PageIndex:1,PageSize:t},function(){n.execTableQuery(a)})}},{key:"execTableQuery",value:function(e){if(this.apiConfig[e]){var t=this.state,a=t.PageIndex,n=t.PageSize,o=this.paramData[e],i=this.apiConfig[e].api;this.execFetchApi(i,Object.assign(o,{PageIndex:a,PageSize:n}))}else S.a.warn("\u8bf7\u914d\u7f6eTable\u7684modelKey")}},{key:"onGeneratePage",value:function(){var e=this,t=this.props,a=t.pageName,n=t.projectDir,o=t.onShowPageNameModal;if(a){if(!window.ipcRenderer||n){var i=this.state,l=i.layoutConfig,r=void 0===l?[]:l,c=i.layerConfig,s=void 0===c?{}:c;if(0!==r.length){var u={pageName:a,projectDir:n,layoutConfig:r,layerConfig:s};if(this.setState({generateLoading:!0}),window.ipcRenderer)return window.ipcRenderer.send("createCode",JSON.stringify(u)),void window.ipcRenderer.on("createCodeReply",function(t,a){var n=JSON.parse(a),o=n.code,i=n.info;0==o?S.a.success(i):S.a.error(i),e.setState({generateLoading:!1})});this.props.service.generatePage(u).then(function(t){var n=t.data;if("0"==n.code){S.a.success(n.info);var o=document.createElement("a");o.href="".concat("https://pagetools.herokuapp.com","/sourceCache/").concat(a,".tar"),o.style.display="none",document.body.appendChild(o),o.click(),document.body.removeChild(o)}else S.a.error(n.info);e.setState({generateLoading:!1})}).catch(function(){S.a.error("\u8bf7\u6c42\u5931\u8d25"),e.setState({generateLoading:!1})})}else S.a.warn("\u8bf7\u914d\u7f6e\u9875\u9762\u4fe1\u606f")}}else o()}},{key:"onPreviewPage",value:function(){var e=this.props.onPreviewPage,t=this.state;e(t.layoutConfig,t.layerConfig)}},{key:"onToggleLayer",value:function(){this.setState({showLayer:!this.state.showLayer})}},{key:"onUpdateLayerConfig",value:function(e){this.setState({layerConfig:e})}},{key:"onUpdateApiConfig",value:function(e,t){this.apiConfig[e]=t}},{key:"getChildFuncProps",value:function(){return{execFetchApi:this.execFetchApi,onPageIndexChange:this.onPageIndexChange,onShowSizeChange:this.onShowSizeChange,onUpdateApiConfig:this.onUpdateApiConfig,onUpdateLayoutConfig:this.onUpdateLayoutConfig}}},{key:"onShowModal",value:function(e,t,a,n){var o,i=(o={},Object(j.a)(o,"show".concat(t),!0),Object(j.a)(o,"api",a),Object(j.a)(o,"recordData",n),o);this.setState(Object(x.a)({},i))}},{key:"onCancelModal",value:function(e){var t;this.setState((t={},Object(j.a)(t,"show".concat(e),!1),Object(j.a)(t,"recordData",null),Object(j.a)(t,"api",""),t))}},{key:"onOkModal",value:function(e,t,a){return this.execFetchApi(t,a)}},{key:"renderModal",value:function(){var e=this,t=this.state,a=t.layerConfig,n=t.recordData,i=t.api,l=a.modalArr;return(void 0===l?[]:l).map(function(t){var l=t.name,r=t.title,c=t.width,s=t.layoutConfig,u="show".concat(l),d=e.state[u],m={api:i,width:parseInt(c),title:r,visible:d,recordData:n,layerConfig:a,modalName:l,layoutConfig:e.state.layoutConfig,modalLayoutConfig:s,execFetchApi:e.execFetchApi};return d&&(m.mode=n||i?"edit":"add"),o.a.createElement(_t,Object.assign({},m,{key:"".concat(r,"-").concat(l),onCancelModal:e.onCancelModal,onOkModal:e.onOkModal}))})}},{key:"render",value:function(){var e=this.props,t=e.noLayer,a=void 0!==t&&t,i=e.onShowLoginModal,l=e.preview,r=void 0!==l&&l,c=this.state,s=c.layoutConfig,u=c.generateLoading,d=c.showLayer,m=c.layerConfig,p=c.fetchLoading,h=c.apiData,f=c.PageIndex,b=c.PageSize,g=!0;return a?g=!1:r&&(g=!1),o.a.createElement(n.Fragment,null,o.a.createElement(I.a,{spinning:p},o.a.createElement("div",{className:"main-container border-box ".concat(r?"preview-mode":""),ref:this.container},o.a.createElement(Qt.Provider,{value:{selectedRows:this.state.selectedRows,selectedRowKeys:this.state.selectedRowKeys}},o.a.createElement(Mt,Object.assign({onShowLoginModal:i,layoutConfig:s,layerConfig:m,currentPage:f,pageSize:b,apiData:h,context:this,preview:r},this.getChildFuncProps()))),g?o.a.createElement(C.a,{type:"primary",shape:"round",icon:"plus",size:"large",className:"btn-manage",onClick:this.onToggleLayer,title:"\u5f39\u51fa\u5c42&\u63a5\u53e3\u7f16\u8f91"}):null,o.a.createElement(Wt,{visible:d,onCloseLayer:this.onToggleLayer,onUpdateLayerConfig:this.onUpdateLayerConfig,layerConfig:m}))),g?o.a.createElement(n.Fragment,null,o.a.createElement(C.a,{id:"btn-code",type:"primary",onClick:this.onGeneratePage,loading:u},"\u751f\u6210\u9875\u9762"),o.a.createElement(C.a,{type:"primary",onClick:this.onPreviewPage,style:{marginLeft:"5px"}},"\u9884\u89c8")):null,this.renderModal())}}],[{key:"getDerivedStateFromProps",value:function(e){return e.visible?{layerConfig:e.layerConfig,layoutConfig:e.layoutConfig}:Object.hasOwnProperty.call(e,"layerConfig")?{layerConfig:e.layerConfig}:null}}]),t}(n.PureComponent))||M),Xt=(a(1311),f.a.Sider),ea=f.a.Content,ta=function(e){function t(){return Object(r.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.showModal,a=e.layoutConfig,n=e.onCloseModal,i=e.layerConfig;return o.a.createElement(g.a,{visible:t,footer:null,width:"100%",closable:!0,centered:!0,wrapClassName:"preview-page-modal",onCancel:n,title:"\u9875\u9762\u9884\u89c8",maskClosable:!0},o.a.createElement("div",{className:"preview-container"},o.a.createElement(f.a,null,o.a.createElement(Xt,{width:"210"}),o.a.createElement(f.a,null,o.a.createElement(ea,null,o.a.createElement(Zt,{visible:t,layoutConfig:a,layerConfig:i,preview:!0,noLayer:!0}))))))}}]),t}(n.Component),aa=(a(1312),v.a.create()(U=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={showLoginFrame:!1},a.onSubmit=a.onSubmit.bind(Object(m.a)(Object(m.a)(a))),a.onResetModal=a.onResetModal.bind(Object(m.a)(Object(m.a)(a))),a.getIframeUrl=a.getIframeUrl.bind(Object(m.a)(Object(m.a)(a))),a.asyncAppendJs=a.asyncAppendJs.bind(Object(m.a)(Object(m.a)(a))),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"onSubmit",value:function(e){var t=this;e.preventDefault(),this.props.form.validateFields(function(e,a){e||t.asyncAppendJs(a.appUrl)})}},{key:"componentDidMount",value:function(){var e=this;window.addEventListener("message",function(t){if(t.origin===P){var a=e.props.form.getFieldValue("appUrl"),n="";if(a&&a.indexOf("?")>0&&a.indexOf("MerchantId=")>0){var o=a.slice(a.indexOf("?")+1).split("&").find(function(e){return e.indexOf("MerchantId=")>=0});o&&(n=o.split("=")[1]),localStorage.setItem("access_token",t.data),localStorage.setItem("MerchantId",n),localStorage.setItem("appUrl",a),S.a.success("\u767b\u5f55\u6210\u529f"),e.props.onCloseLoginModal()}}},!1)}},{key:"clearStorage",value:function(){["access_token","MerchantId","appUrl","common","main","webapi"].forEach(function(e){localStorage.removeItem(e)})}},{key:"componentDidUpdate",value:function(){this.props.visible&&!this.clearInit&&(this.clearInit=!0,this.clearStorage())}},{key:"asyncAppendJs",value:function(e){var t=this,a=document.createElement("script");a.type="text/javascript",a.onload=function(e){console.log(e),window.configs&&(localStorage.setItem("common",window.configs.host.common),localStorage.setItem("main",window.configs.host.main),localStorage.setItem("webapi",window.configs.host.webapi),t.setState({showLoginFrame:!0},function(){t.sendMessageToIframe()}))};var n=e;e.indexOf("?")&&(n=e.slice(0,e.indexOf("?")-1)),a.src="".concat(n,"/resources/js/configs.js?time=").concat(Date.now()),document.body.appendChild(a)}},{key:"sendMessageToIframe",value:function(){var e=this,t=document.createElement("iframe");t.src=this.getIframeUrl(),t.id="login-app",document.querySelector(".iframe-container").appendChild(t),t.onload=function(){var t=Object.assign({appUrl:e.props.form.getFieldValue("appUrl")},window.configs);document.getElementById("login-app").contentWindow.postMessage(t,P)}}},{key:"onResetModal",value:function(){this.props.form.resetFields(),this.clearInit=!1,this.setState({showLoginFrame:!1})}},{key:"getIframeUrl",value:function(){if(window.configs){var e=window.configs.host.passport.auth;return"".concat(P,"/appLogin?authUrl=").concat(encodeURIComponent(e))}return"".concat(P,"/appLogin")}},{key:"render",value:function(){var e=this.props,t=e.visible,a=e.form,n=e.onCloseLoginModal,i=a.getFieldDecorator,l=this.state.showLoginFrame;return o.a.createElement(g.a,{title:"\u767b\u5f55",visible:t,width:"500px",wrapClassName:"login-modal",onCancel:n,afterClose:this.onResetModal,maskClosable:!1,footer:null},o.a.createElement("div",{className:"login-wrapper ".concat(l?"slide-l":"")},o.a.createElement("div",{className:"url-container"},o.a.createElement(v.a,{onSubmit:this.onSubmit},o.a.createElement(v.a.Item,null,i("appUrl",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5e94\u7528url"},{type:"url",message:"url\u683c\u5f0f\u4e0d\u5408\u6cd5"}]})(o.a.createElement(y.a,{placeholder:"\u8bf7\u8f93\u5165\u5e94\u7528url"}))),o.a.createElement("p",{className:"btn-box"},o.a.createElement(C.a,{type:"primary",htmlType:"submit"},"\u786e\u5b9a")))),o.a.createElement("div",{className:"iframe-container"})))}}]),t}(n.PureComponent))||U),na=f.a.Sider,oa=f.a.Content,ia=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={showLoginModal:!1,showEditNameModal:!1,showPreviewModal:!1,pageName:""},a.onSubmitPageName=a.onSubmitPageName.bind(Object(m.a)(Object(m.a)(a))),a.onPreviewPage=a.onPreviewPage.bind(Object(m.a)(Object(m.a)(a))),a.onShowLoginModal=a.onShowLoginModal.bind(Object(m.a)(Object(m.a)(a))),a.onCloseLoginModal=a.onCloseLoginModal.bind(Object(m.a)(Object(m.a)(a))),a.onClosePreviewModal=a.onClosePreviewModal.bind(Object(m.a)(Object(m.a)(a))),a.onShowPageNameModal=a.onShowPageNameModal.bind(Object(m.a)(Object(m.a)(a))),a.onClosePageNameModal=a.onClosePageNameModal.bind(Object(m.a)(Object(m.a)(a))),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){Ue()||this.onShowLoginModal()}},{key:"onCloseLoginModal",value:function(){this.setState({showLoginModal:!1})}},{key:"onShowLoginModal",value:function(){this.setState({showLoginModal:!0})}},{key:"onShowPageNameModal",value:function(){this.setState({showEditNameModal:!0})}},{key:"onSubmitPageName",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;this.setState({showEditNameModal:!1,pageName:e,projectDir:t},function(){(!window.ipcRenderer&&e||e&&t)&&document.querySelector("#btn-code").click()})}},{key:"onClosePageNameModal",value:function(){this.setState({showEditNameModal:!1})}},{key:"onClosePreviewModal",value:function(){this.setState({showPreviewModal:!1})}},{key:"onPreviewPage",value:function(e,t){this.setState({showPreviewModal:!0}),this.layoutConfig=e,this.layerConfig=t}},{key:"render",value:function(){var e=this.state,t=e.pageName,a=e.projectDir,n=e.showLoginModal,i=e.showPreviewModal,l=e.showEditNameModal;return o.a.createElement("div",{className:"App"},o.a.createElement(b.a,{locale:h.a},o.a.createElement(f.a,null,o.a.createElement(na,{width:"300"},o.a.createElement(Bt,null)),o.a.createElement(f.a,null,o.a.createElement(oa,null,o.a.createElement(Zt,{pageName:t,projectDir:a,onShowLoginModal:this.onShowLoginModal,onShowPageNameModal:this.onShowPageNameModal,onPreviewPage:this.onPreviewPage}))),o.a.createElement(E,{onOkModal:this.onSubmitPageName,onCloseModal:this.onClosePageNameModal,visible:l}),o.a.createElement(ta,{layoutConfig:this.layoutConfig,layerConfig:this.layerConfig,onCloseModal:this.onClosePreviewModal,showModal:i}),o.a.createElement(aa,{visible:n,onCloseLoginModal:this.onCloseLoginModal}))))}}]),t}(n.Component);l.a.render(o.a.createElement(ia,null),document.getElementById("root"))},601:function(e,t){},607:function(e,t,a){e.exports=a(1316)},613:function(e,t,a){},614:function(e,t,a){},713:function(e,t,a){}},[[607,1,2]]]);
//# sourceMappingURL=main.bed941bf.chunk.js.map